<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"> 
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"> 
    <meta name="csrf-token" content=""> 
    <title>PHP 和 COM - 开发帮助文档</title> 
    <meta name="keyword" content="faq.com"> 
    <meta name="description" content="faq.com"> 
    <meta name="author" content="Moments"> 
    <link href="/favicon.ico" rel="shortcut icon"> 
    <link href="/css/blog.css" rel="stylesheet"> 
    <script src="/js/blog.js"></script> 
</head>
<body>
<header class="sticky-top">
    <nav class="navbar navbar-expand navbar-dark bg-secondary justify-content-between text-uppercase">
        <div class="navbar-nav" style="overflow:hidden;">
            <a class="navbar-brand" href="https://help.pythonschool.com">
                <span class="d-md-none">
                    <svg class="text-warning" width="24" height="24" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#emoji-sunglasses"/>
                    </svg>
                </span>
                <span class="d-none d-md-flex">开发帮助文档</span>
            </a>
            <div class="navbar-nav-scroll" style="overflow: hidden;">
                <ul class="navbar-nav text-nowrap pb-4" style="overflow:auto;">
                                            <li class="nav-item">
                            <a class="nav-link" href="/docs/laravel/index.html">laravel</a>
                        </li>
                                            <li class="nav-item">
                            <a class="nav-link active" href="/docs/php/index.html">php</a>
                        </li>
                                    </ul>
            </div>
        </div>
        <div class="d-inline-flex">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="https://github.com/liuhuashi">
                        <svg class="text-light" width="24" height="24" fill="currentColor">
                            <use xlink:href="/css/bootstrap-icons.svg#github"/>
                        </svg>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
</header>
<div class="container-fluid">
    <div id="aside-hidden" class="position-fixed" style="left:0;top: 58px;cursor:pointer;z-index: 10000;">
        <svg class="align-text-bottom text-warning" width="16" height="16" fill="currentColor" stroke="currentColor" stroke-width="1">
            <use xlink:href="/css/bootstrap-icons.svg#arrow-left-square"/>
        </svg>
    </div>
    <div class="row">
        <div class="aside col-md-3 col-lg-2 border-right shadow position-sticky" style="overflow:auto;height: calc(100vh - 58px);padding-bottom: calc(100vh/3);">
    <form class="row border-bottom p-3 bg-white sticky-top">
        <input id="search-version" class="form-control" data-version="28" type="search" placeholder="英文逗号分隔,分词搜索">
    </form>
    <ul class="nav navbar-nav nav-pills flex-column pt-2 figure-caption">
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/faq.build.html" title="编译问题">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    编译问题
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/faq.com.html" title="PHP 和 COM">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    PHP 和 COM
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/faq.databases.html" title="数据库问题">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    数据库问题
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/faq.general.html" title="一般信息">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    一般信息
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/faq.html.html" title="PHP 和 HTML">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    PHP 和 HTML
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/faq.installation.html" title="安装常见问题">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    安装常见问题
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/faq.mailinglist.html" title="邮件列表">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    邮件列表
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/faq.misc.html" title="其他问题">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    其他问题
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/faq.obtaining.html" title="获取 PHP">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    获取 PHP
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/faq.passwords.html" title="密码散列安全">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    密码散列安全
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/faq.using.html" title="使用 PHP">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    使用 PHP
                </a>
            </li>
            </ul>
</div>        <div class="aside-middle col-md-9 col-lg-10 row">
    <div class="col-md-9 col-xl-10" style="overflow: auto;height: calc(100vh - 58px);padding-bottom: calc(100vh/3);">
        <div class="container main-h4-1">
            <div class="page-content">
                <div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="faq.html.html">« PHP 和 HTML</a></li>
      <li style="float: right;"><a href="faq.misc.html">其他问题 »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="documentation.html">PHP Manual</a></li>
    <li><a href="faq.html">FAQ</a></li>
    <li>PHP 和 COM</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="faq.com" class="chapter">
  <h1>PHP 和 COM</h1>

  
  <p class="para">PHP 可以在 Win32 平台中访问 COM 和 DCOM 对象。</p>
  <div class="qandaset"><ol class="qandaset_questions"><li><a href="#faq.com.q1">
        我建立了一个 DLL 来做某种计算。有办法在 PHP 中运行这个 DLL 吗？
      </a></li><li><a href="#faq.com.q2">
        “Unsupported variant type: xxxx (0xxxxx)”是什么意思？
      </a></li><li><a href="#faq.com.q3">
        在 PHP 中有可能操纵可视对象吗？
      </a></li><li><a href="#faq.com.q4">
        可以将一个 COM 对象保存在 session 中吗？
      </a></li><li><a href="#faq.com.q5">
        怎样可以捕获 COM 的错误？
      </a></li><li><a href="#faq.com.q6">
        我能像在 Perl 中一样从 PHP 脚本生成 DLL 文件吗？
      </a></li><li><a href="#faq.com.q7">
        “Unable to obtain IDispatch interface for CLSID {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}”是什么意思？
      </a></li><li><a href="#faq.com.q8">
        怎样从远端服务器运行 COM 对象？
      </a></li><li><a href="#faq.com.q9">
        我得到一个“DCOM is disabled in C:\path...\scriptname.php on line 6”信息，应该怎么办？
      </a></li><li><a href="#faq.com.q10">
        有可能在 PHP 页面中加载／操纵 ActiveX 对象吗？
      </a></li><li><a href="#faq.com.q11">
        有可能得到一个组件在运行中的实例吗？
      </a></li><li><a href="#faq.com.q12">
        有办法处理 COM 对象中发送的事件吗？
      </a></li><li><a href="#faq.com.q13">
        我在尝试调用一个打开了多于一个接口的 COM 对象中的方法时碰到问题，应该怎么办？
      </a></li><li><a href="#faq.com.q14">
        这么说 PHP 可以和 COM 一起工作，那么 COM+ 呢？
      </a></li><li><a href="#faq.com.q15">
        如果 PHP 可以操纵 COM 对象，那么可以设想结合 PHP 用 MTS 来管理组件资源吗？
      </a></li></ol></div>
    <dl class="qandaentry" id="faq.com.q1">
      <dt><strong>
        我建立了一个 DLL 来做某种计算。有办法在 PHP 中运行这个 DLL 吗？
      </strong></dt>
      <dd class="answer">
        <p class="para">如果这是个简单的 DLL 那么还没有办法在 PHP 中运行它。如果这个 DLL 中包含有一个 COM 服务器并且它实现了 IDispatch 接口，那有可能访问它。</p>
      </dd>
    </dl>
    <dl class="qandaentry" id="faq.com.q2">
      <dt><strong>
        “Unsupported variant type: xxxx (0xxxxx)”是什么意思？
      </strong></dt>
      <dd class="answer">
        <p class="para">有几十种 VARIANT 类型以及它们的组合。大多数已经被支持了但还有几种尚未实现。数组没有完全被支持。只有一维的仅用作索引的数组可以在 PHP 和 COM 之间传递。如果你发现其它未支持的类型，请当作一个 bug 报告（如果尚未被报告的话）并提供尽可能多的信息。</p>
      </dd>
    </dl>
    <dl class="qandaentry" id="faq.com.q3">
      <dt><strong>
        在 PHP 中有可能操纵可视对象吗？
      </strong></dt>
      <dd class="answer">
        <p class="para">一般来说是可以的，但是 PHP 大都用来作为 web 脚本语言并运行在 web 服务器的上下文环境中，因此可视对象决不会在服务器的桌面上显示。如果你把 PHP 用作应用程序脚本例如结合 PHP-GTK 来使用，那么访问和通过 COM 来操纵可视对象方面没有限制。</p>
      </dd>
    </dl>
    <dl class="qandaentry" id="faq.com.q4">
      <dt><strong>
        可以将一个 COM 对象保存在 session 中吗？
      </strong></dt>
      <dd class="answer">
        <p class="para">不行。COM 的实例被看作是资源，因此只在一个脚本的上下文中有效。</p>
      </dd>
    </dl>
    <dl class="qandaentry" id="faq.com.q5">
      <dt><strong>
        怎样可以捕获 COM 的错误？
      </strong></dt>
      <dd class="answer">
        <p class="para">在 PHP 5 中，COM 扩展会发出 
        <code class="literal">com_exception</code>异常信息，可以捕获并检查 
        <code class="literal">code</code>成员来决定下一步的行为。</p>
        <p class="para">在 PHP 4 中除了用 PHP 自己提供的办法之外（@，track_errors，..）不可能捕获 COM 的错误。</p>
      </dd>
    </dl>
    <dl class="qandaentry" id="faq.com.q6">
      <dt><strong>
        我能像在 Perl 中一样从 PHP 脚本生成 DLL 文件吗？
      </strong></dt>
      <dd class="answer">
        <p class="para">不行，PHP 没有这样的工具。</p>
      </dd>
    </dl>
    <dl class="qandaentry" id="faq.com.q7">
      <dt><strong>
        “Unable to obtain IDispatch interface for CLSID {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}”是什么意思？
      </strong></dt>
      <dd class="answer">
        <p class="para">此错误可以有多种原因： 
        </p><ul class="itemizedlist">
          <li class="listitem">
            <span class="simpara">错误的 CLSID</span>
          </li>
          <li class="listitem">
            <span class="simpara">找不到所请求的 DLL</span>
          </li>
          <li class="listitem">
            <span class="simpara">所请求的组件没有实现 IDispatch 接口</span>
          </li>
        </ul>
      </dd>
    </dl>
    <dl class="qandaentry" id="faq.com.q8">
      <dt><strong>
        怎样从远端服务器运行 COM 对象？
      </strong></dt>
      <dd class="answer">
        <p class="para">完全和运行本地对象一样。只须将远端服务器的 IP 作为第二个变量传递给 COM 的构造函数即可。</p>
        <p class="para">确认在 <var class="filename">php.ini</var> 中设定了 
        <a href="com.configuration.html#ini.com.allow-dcom" class="xref"></a>
        <code class="literal">=</code>&amp;true;。</p>
      </dd>
    </dl>
    <dl class="qandaentry" id="faq.com.q9">
      <dt><strong>
        我得到一个“DCOM is disabled in C:\path...\scriptname.php on line 6”信息，应该怎么办？
      </strong></dt>
      <dd class="answer">
        <p class="para">编辑 <var class="filename">php.ini</var> 并设定 
        <a href="com.configuration.html#ini.com.allow-dcom" class="xref"></a>
        <code class="literal">=</code>&amp;true;。</p>
      </dd>
    </dl>
    <dl class="qandaentry" id="faq.com.q10">
      <dt><strong>
        有可能在 PHP 页面中加载／操纵 ActiveX 对象吗？
      </strong></dt>
      <dd class="answer">
        <p class="para">这不关 PHP 的事。如果在 HTML 文档中请求的话，ActiveX 对象被加载在客户端。这和 PHP 脚本没有关系，因此也不可能和服务器端发生直接的交互作用。</p>
      </dd>
    </dl>
    <dl class="qandaentry" id="faq.com.q11">
      <dt><strong>
        有可能得到一个组件在运行中的实例吗？
      </strong></dt>
      <dd class="answer">
        <p class="para">在绰号的帮助下这有可能。如果你想得到同一个 word 实例的多个引用你可以这样建立此实例：</p>
        <div class="example-contents">
          <div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$word </span><span style="color: #007700">= new </span><span style="color: #0000BB">COM</span><span style="color: #007700">(</span><span style="color: #DD0000">"C:\docs\word.doc"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
</div>

        <p class="para">如果没有运行中的实例这将建立一个新的实例，否则将会返回正在运行中的实例的句柄，如果可用的话。</p>
      </dd>
    </dl>
    <dl class="qandaentry" id="faq.com.q12">
      <dt><strong>
        有办法处理 COM 对象中发送的事件吗？
      </strong></dt>
      <dd class="answer">
        <p class="para">可以自定义事件收报方并且用 
        <span class="function"><a href="function.com-event-sink.html" class="function">com_event_sink()</a></span>函数绑定之。可以用 
        <span class="function"><a href="function.com-print-typeinfo.html" class="function">com_print_typeinfo()</a></span>来让 PHP 产生事件收报方类的框架。</p>
      </dd>
    </dl>
    <dl class="qandaentry" id="faq.com.q13">
      <dt><strong>
        我在尝试调用一个打开了多于一个接口的 COM 对象中的方法时碰到问题，应该怎么办？
      </strong></dt>
      <dd class="answer">
        <p class="para">我也不知道怎么办，我想这没办法。如果什么人有对此问题的明确信息请
        <a href="mailto:harald.radi@nme.at" class="link external">» 告诉我</a>。:)</p>
      </dd>
    </dl>
    <dl class="qandaentry" id="faq.com.q14">
      <dt><strong>
        这么说 PHP 可以和 COM 一起工作，那么 COM+ 呢？
      </strong></dt>
      <dd class="answer">
        <p class="para">COM+ 通过使用 MTS 和 MSMQ 来管理组件的框架扩展了 COM，但并没有什么特殊之处使 PHP 非要支持这样的组件。</p>
      </dd>
    </dl>
    <dl class="qandaentry" id="faq.com.q15">
      <dt><strong>
        如果 PHP 可以操纵 COM 对象，那么可以设想结合 PHP 用 MTS 来管理组件资源吗？
      </strong></dt>
      <dd class="answer">
        <p class="para">PHP 本身还并不处理事务。因而如果出错也不会发动撤回机制。如果你使用了支持事务处理的组件那你不得不自己实现事务管理。</p>
      </dd>
    </dl>
  
</div>
</div></div>
            </div>
        </div>
    </div>
    <div class="col-md-3 col-xl-2" id="toc-list">
        <ul></ul>
    </div>
</div>    </div>
</div>
<span id="back-top">
<svg width="20" height="20" fill="currentColor">
    <use xlink:href="/css/bootstrap-icons.svg#chevron-up"/>
</svg>
</span>
 
<script>
    // 浏览量统计
    $(function () {
        let formdata = new FormData();
        formdata.append('_token', '');
        formdata.append('id', 2272);
        $.ajax({
            url: $(".sticky-top .navbar-brand").attr('href') + "/api/doc/clicks",
            type: 'POST',
            data: formdata,
            processData: false,
            contentType: false
        });
    });
    // aside-hidden
    $(function () {
        $('#aside-hidden').on('click', function () {
            $('.aside').toggle(0, function () {
                if ($(this).is(':visible')) {
                    $('.aside-middle').removeClass('col-md-12 col-lg-12').addClass('col-md-9 col-lg-10');
                } else {
                    $('.aside-middle').removeClass('col-md-9 col-lg-10').addClass('col-md-12 col-lg-12');
                }
            });
        });
    });
</script>
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?1522d01c436f59ddc8389f25bfa9d53e";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
</body>
</html>