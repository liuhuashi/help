<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"> 
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"> 
    <meta name="csrf-token" content=""> 
    <title>PECL/mysqlnd_ms 1.6 series - 开发帮助文档</title> 
    <meta name="keyword" content="mysqlnd-ms.changes-one-six"> 
    <meta name="description" content="mysqlnd-ms.changes-one-six"> 
    <meta name="author" content="Moments"> 
    <link href="/favicon.ico" rel="shortcut icon"> 
    <link href="/css/blog.css" rel="stylesheet"> 
    <script src="/js/blog.js"></script> 
</head>
<body>
<header class="sticky-top">
    <nav class="navbar navbar-expand navbar-dark bg-secondary justify-content-between text-uppercase">
        <div class="navbar-nav" style="overflow:hidden;">
            <a class="navbar-brand" href="https://help.pythonschool.com">
                <span class="d-md-none">
                    <svg class="text-warning" width="24" height="24" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#emoji-sunglasses"/>
                    </svg>
                </span>
                <span class="d-none d-md-flex">开发帮助文档</span>
            </a>
            <div class="navbar-nav-scroll" style="overflow: hidden;">
                <ul class="navbar-nav text-nowrap pb-4" style="overflow:auto;">
                                            <li class="nav-item">
                            <a class="nav-link" href="/docs/laravel/index.html">laravel</a>
                        </li>
                                            <li class="nav-item">
                            <a class="nav-link active" href="/docs/php/index.html">php</a>
                        </li>
                                    </ul>
            </div>
        </div>
        <div class="d-inline-flex">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="https://github.com/liuhuashi">
                        <svg class="text-light" width="24" height="24" fill="currentColor">
                            <use xlink:href="/css/bootstrap-icons.svg#github"/>
                        </svg>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
</header>
<div class="container-fluid">
    <div id="aside-hidden" class="position-fixed" style="left:0;top: 58px;cursor:pointer;z-index: 10000;">
        <svg class="align-text-bottom text-warning" width="16" height="16" fill="currentColor" stroke="currentColor" stroke-width="1">
            <use xlink:href="/css/bootstrap-icons.svg#arrow-left-square"/>
        </svg>
    </div>
    <div class="row">
        <div class="aside col-md-3 col-lg-2 border-right shadow position-sticky" style="overflow:auto;height: calc(100vh - 58px);padding-bottom: calc(100vh/3);">
    <form class="row border-bottom p-3 bg-white sticky-top">
        <input id="search-version" class="form-control" data-version="842" type="search" placeholder="英文逗号分隔,分词搜索">
    </form>
    <ul class="nav navbar-nav nav-pills flex-column pt-2 figure-caption">
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/mysqlnd-ms.changes-one-five.html" title="PECL/mysqlnd_ms 1.5 series">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    PECL/mysqlnd_ms 1.5 series
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/mysqlnd-ms.changes-one-four.html" title="PECL/mysqlnd_ms 1.4 series">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    PECL/mysqlnd_ms 1.4 series
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/mysqlnd-ms.changes-one-o.html" title="PECL/mysqlnd_ms 1.0 series">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    PECL/mysqlnd_ms 1.0 series
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/mysqlnd-ms.changes-one-one.html" title="PECL/mysqlnd_ms 1.1 series">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    PECL/mysqlnd_ms 1.1 series
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/mysqlnd-ms.changes-one-six.html" title="PECL/mysqlnd_ms 1.6 series">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    PECL/mysqlnd_ms 1.6 series
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/mysqlnd-ms.changes-one-three.html" title="PECL/mysqlnd_ms 1.3 series">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    PECL/mysqlnd_ms 1.3 series
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/mysqlnd-ms.changes-one-two.html" title="PECL/mysqlnd_ms 1.2 series">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    PECL/mysqlnd_ms 1.2 series
                </a>
            </li>
            </ul>
</div>        <div class="aside-middle col-md-9 col-lg-10 row">
    <div class="col-md-9 col-xl-10" style="overflow: auto;height: calc(100vh - 58px);padding-bottom: calc(100vh/3);">
        <div class="container main-h4-1">
            <div class="page-content">
                <div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="mysqlnd-ms.changes.html">« Change History</a></li>
      <li style="float: right;"><a href="mysqlnd-ms.changes-one-five.html">PECL/mysqlnd_ms 1.5 series »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="documentation.html">PHP Manual</a></li>
    <li><a href="mysqlnd-ms.changes.html">Change History</a></li>
    <li>PECL/mysqlnd_ms 1.6 series</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="mysqlnd-ms.changes-one-six" class="section">
  <h2 class="title">PECL/mysqlnd_ms 1.6 series</h2>
  <p class="para">
   1.6.0-alpha
   </p><ul class="itemizedlist">
    <li class="listitem">
     <span class="simpara">
      Release date: TBD
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      Motto/theme: Maintenance and initial MySQL Fabric support
     </span>
    </li>
   </ul>
  
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   </p><p class="para">
     This is the current development series. All
     features are at an early stage. Changes may happen at any time without
     prior notice. Please, do not use this version in production environments.
    </p>
    <p class="para">
     The documentation may not reflect all changes yet.
    </p>
  </blockquote>
  <p class="para">
   Bug fixes
   </p><ul class="itemizedlist">
     <li class="listitem">
     <p class="para">
      Won't fix: #66616 R/W split fails: QOS with mysqlnd_get_last_gtid with built-in MySQL GTID
     </p>
     <p class="para">
      This is not a bug in the plugins implementation but a server side feature
      limitation not considered and documented before. MySQL 5.6 built-in GTIDs cannot be
      used to ensure session consistency when reading from slaves in all cases.
      In the worst case the plugin will not consider using the slaves and
      fallback to using the master. There will be no wrong results but no benefit
      from doing GTID checks either.
     </p>
    </li>
    <li class="listitem">
      <p class="para">
        Fixed #66064 - Random once load balancer ignoring weights
      </p>
      <p class="para">
        Due to a config parsing bug random load balancing has ignored node
        weights if, and only if, the sticky flag was set (random once).
      </p>
    </li>
    <li class="listitem">
      <p class="para">
        Fixed #65496 - Wrong check for slave delay
      </p>
      <p class="para">
       The quality of service filter has erroneously ignored slaves
       that lag for zero (0) seconds if a any maximum lag had been set.
       Although a slave was not lagging behind, it was excluded from the
       load balancing list if a maximum age was set by the QoS filter.
       This was due to using the wrong comparison operator in the source
       of the filter.
      </p>
    </li>
    <li class="listitem">
      <p class="para">
        Fixed #65408 - Compile failure with -Werror=format-security
      </p>
     </li>
   </ul>
  
  <p class="para">
   Feature changes
   </p><ul class="itemizedlist">
    <li class="listitem">
    <p class="para">
      Introduced an internal connection pool. When using Fabric and switching
      from shard group A to shard group B, we are replacing the entire list of
      masters and slaves. This troubles the connections state alignment logic and
      some filters. Some filters cache information on the master and slave lists.
      The new internal connection pool abstraction allows us to inform the filters
      of changes, hence they can update their caches.
     </p>
     <p class="para">
      Later on, the pool can also be used to reduce connection overhead. Assume
      you are switching from a shard group to another and back again. Whenever
      the switch is done, the pool's active server (and connection) lists are
      replaced. However, no longer used connections are not necessarily closed
      immediately but can be kept in the pool for later reuse.
     </p>
     <p class="para">
      Please note, the connection pool is internalat this point. There are some
      new statistics to monitor it. However, you cannot yet configure pool size
      of behaviour. 
     </p>
    </li>
    <li class="listitem">
    <p class="para">
      Added a basic distributed transaction abstraction.
      XA transactions can are supported ever since using standard SQL calls.
      This is inconvenient as XA participants must be managed manually.
      PECL/mysqlnd_ms introduces API calls to control XA transaction among MySQL servers.
      When using the new functions, PECL/mysqlnd_ms acts as a transaction coordinator.
      After starting a distributed transaction, the plugin tracks all servers
      involved until the transaction is ended and issues appropriate SQL statements
      on the XA participants.
     </p>
     <p class="para">
       This is useful, for example, when using Fabric and sharding. When using
       Fabric the actual shard servers involved in a business transaction may not be known
       in advance. Thus, manually controlling a transaction that spawns multiple shards becomes
       difficult.
       Please, be warned about <a href="mysqlnd-ms.concept_xa_trx.html" class="link">current limitations</a>.
     </p>
    </li>
    <li class="listitem">
    <p class="para">
      Introduced automatic retry loop for
      <a href="mysqlnd-ms.transient_errors.html" class="link">transient errors</a> and
      <a href="function.mysqlnd-ms-get-stats.html" class="link">corresponding statistic</a>
      to count the number of implicit retries. Some distributed
      database clusters use transient errors to hint a client to retry
      its operation in a bit. Most often, the client is then supposed
      to halt execution (sleep) for a short moment before retrying the
      desired operation. Immediately failing over to another node
      is not necessary in response to the error. Instead, a retry loop
      can be performed. Common situation when using MySQL Cluster.
     </p>
    </li>
    <li class="listitem">
    <p class="para">
      Introduced automatic retry loop for
      <a href="mysqlnd-ms.transient_errors.html" class="link">transient errors</a> and
      <a href="function.mysqlnd-ms-get-stats.html" class="link">corresponding statistic</a>
      to count the number of implicit retries. Some distributed
      database clusters use transient errors to hint a client to retry
      its operation in a bit. Most often, the client is then supposed
      to halt execution (sleep) for a short moment before retrying the
      desired operation. Immediately failing over to another node
      is not necessary in response to the error. Instead, a retry loop
      can be performed. Common situation when using MySQL Cluster.
     </p>
    </li>
    <li class="listitem">
    <p class="para">
      Introduced <a href="mysqlnd-ms.quickstart.mysql_fabric.html" class="link">most basic support</a>
      for the MySQL Fabric High Availability and sharding framework.
    </p>
    <p class="para">
      Please, consider this pre-alpha quality. Both the
      server side framework and the client side code is supposed to work flawless
      considering the MySQL Fabric quickstart examples only. However, testing has not been
      performed to the level of prior plugin  alpha releases.
      Either sides are moving targets, API changes may happen at any
      time without prior warning.
     </p>
     <p class="para">
      As this is work in progress, the manual may not yet reflect allow
      feature limitations and known bugs.
     </p>
    </li>
    <li class="listitem">
    <p class="para">
      New
      <a href="function.mysqlnd-ms-get-stats.html" class="link">statistics</a>
      to monitor the Fabric XML RPC call <code class="literal">sharding.lookup_servers</code>:
      <code class="literal">fabric_sharding_lookup_servers_success</code>,
      <code class="literal">fabric_sharding_lookup_servers_failure</code>,
      <code class="literal">fabric_sharding_lookup_servers_time_total</code>,
      <code class="literal">fabric_sharding_lookup_servers_bytes_total</code>,
      <code class="literal">fabric_sharding_lookup_servers_xml_failure</code>.
     </p>
    </li>
   <li class="listitem">
    <p class="para">
      New functions related to MySQL Fabric:
      <span class="function"><a href="function.mysqlnd-ms-fabric-select-shard.html" class="function">mysqlnd_ms_fabric_select_shard()</a></span>,
      <span class="function"><a href="function.mysqlnd-ms-fabric-select-global.html" class="function">mysqlnd_ms_fabric_select_global()</a></span>,
      <span class="function"><a href="function.mysqlnd-ms-dump-servers.html" class="function">mysqlnd_ms_dump_servers()</a></span>.
     </p>
    </li>
   </ul>
  
 </div></div></div>
            </div>
        </div>
    </div>
    <div class="col-md-3 col-xl-2" id="toc-list">
        <ul></ul>
    </div>
</div>    </div>
</div>
<span id="back-top">
<svg width="20" height="20" fill="currentColor">
    <use xlink:href="/css/bootstrap-icons.svg#chevron-up"/>
</svg>
</span>
 
<script>
    // 浏览量统计
    $(function () {
        let formdata = new FormData();
        formdata.append('_token', '');
        formdata.append('id', 8254);
        $.ajax({
            url: $(".sticky-top .navbar-brand").attr('href') + "/api/doc/clicks",
            type: 'POST',
            data: formdata,
            processData: false,
            contentType: false
        });
    });
    // aside-hidden
    $(function () {
        $('#aside-hidden').on('click', function () {
            $('.aside').toggle(0, function () {
                if ($(this).is(':visible')) {
                    $('.aside-middle').removeClass('col-md-12 col-lg-12').addClass('col-md-9 col-lg-10');
                } else {
                    $('.aside-middle').removeClass('col-md-9 col-lg-10').addClass('col-md-12 col-lg-12');
                }
            });
        });
    });
</script>
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?1522d01c436f59ddc8389f25bfa9d53e";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
</body>
</html>