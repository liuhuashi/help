<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"> 
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"> 
    <meta name="csrf-token" content=""> 
    <title>向后不兼容 - 开发帮助文档</title> 
    <meta name="keyword" content="migration56.incompatible"> 
    <meta name="description" content="migration56.incompatible"> 
    <meta name="author" content="Moments"> 
    <link href="/favicon.ico" rel="shortcut icon"> 
    <link href="/css/blog.css" rel="stylesheet"> 
    <script src="/js/blog.js"></script> 
</head>
<body>
<header class="sticky-top">
    <nav class="navbar navbar-expand navbar-dark bg-secondary justify-content-between text-uppercase">
        <div class="navbar-nav" style="overflow:hidden;">
            <a class="navbar-brand" href="https://help.pythonschool.com">
                <span class="d-md-none">
                    <svg class="text-warning" width="24" height="24" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#emoji-sunglasses"/>
                    </svg>
                </span>
                <span class="d-none d-md-flex">开发帮助文档</span>
            </a>
            <div class="navbar-nav-scroll" style="overflow: hidden;">
                <ul class="navbar-nav text-nowrap pb-4" style="overflow:auto;">
                                            <li class="nav-item">
                            <a class="nav-link" href="/docs/laravel/index.html">laravel</a>
                        </li>
                                            <li class="nav-item">
                            <a class="nav-link active" href="/docs/php/index.html">php</a>
                        </li>
                                    </ul>
            </div>
        </div>
        <div class="d-inline-flex">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="https://github.com/liuhuashi">
                        <svg class="text-light" width="24" height="24" fill="currentColor">
                            <use xlink:href="/css/bootstrap-icons.svg#github"/>
                        </svg>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
</header>
<div class="container-fluid">
    <div id="aside-hidden" class="position-fixed" style="left:0;top: 58px;cursor:pointer;z-index: 10000;">
        <svg class="align-text-bottom text-warning" width="16" height="16" fill="currentColor" stroke="currentColor" stroke-width="1">
            <use xlink:href="/css/bootstrap-icons.svg#arrow-left-square"/>
        </svg>
    </div>
    <div class="row">
        <div class="aside col-md-3 col-lg-2 border-right shadow position-sticky" style="overflow:auto;height: calc(100vh - 58px);padding-bottom: calc(100vh/3);">
    <form class="row border-bottom p-3 bg-white sticky-top">
        <input id="search-version" class="form-control" data-version="20" type="search" placeholder="英文逗号分隔,分词搜索">
    </form>
    <ul class="nav navbar-nav nav-pills flex-column pt-2 figure-caption">
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/migration56.changed-functions.html" title="函数的变化">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    函数的变化
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/migration56.constants.html" title="新加的全局常量">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    新加的全局常量
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/migration56.deprecated.html" title="PHP 5.6.x 中已废止的特性">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    PHP 5.6.x 中已废止的特性
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/migration56.extensions.html" title="扩展中的变动">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    扩展中的变动
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/migration56.incompatible.html" title="向后不兼容">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    向后不兼容
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/migration56.new-features.html" title="新特性">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    新特性
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/migration56.new-functions.html" title="新加函数">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    新加函数
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/migration56.openssl.html" title="OpenSSL changes in PHP 5.6.x">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    OpenSSL changes in PHP 5.6.x
                </a>
            </li>
            </ul>
</div>        <div class="aside-middle col-md-9 col-lg-10 row">
    <div class="col-md-9 col-xl-10" style="overflow: auto;height: calc(100vh - 58px);padding-bottom: calc(100vh/3);">
        <div class="container main-h4-1">
            <div class="page-content">
                <div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="migration56.html">« 从 PHP 5.5.x 移植到 PHP 5.6.x</a></li>
      <li style="float: right;"><a href="migration56.new-features.html">新特性 »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="documentation.html">PHP Manual</a></li>
    <li><a href="migration56.html">从 PHP 5.5.x 移植到 PHP 5.6.x</a></li>
    <li>向后不兼容</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="migration56.incompatible" class="sect1">
 <h2 class="title">向后不兼容</h2>
 <p class="simpara">
  虽然大部分 PHP 5 的代码无需修改即可正常运行，
  但是有部分代码是无法向后兼容的：
 </p>

 <div class="sect2" id="migration56.incompatible.array-keys">
  <h3 class="title">使用数组标识符为类定义数组类型的属性时，数组的键不会被覆盖</h3>

  <p class="para">
   在 PHP 5.6 之前的版本中，为类定义数组类型的属性时，
   如果数组中同时使用了显式数组键和隐式数组键，并且显式的键和隐式的序列键相同，
   那么数组的键将被覆盖。例如：
  </p>

  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">class </span><span style="color: #0000BB">C </span><span style="color: #007700">{<br>    const </span><span style="color: #0000BB">ONE </span><span style="color: #007700">= </span><span style="color: #0000BB">1</span><span style="color: #007700">;<br>    public </span><span style="color: #0000BB">$array </span><span style="color: #007700">= [<br>        </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">ONE </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'foo'</span><span style="color: #007700">,<br>        </span><span style="color: #DD0000">'bar'</span><span style="color: #007700">,<br>        </span><span style="color: #DD0000">'quux'</span><span style="color: #007700">,<br>    ];<br>}<br><br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">((new </span><span style="color: #0000BB">C</span><span style="color: #007700">)-&gt;</span><span style="color: #0000BB">array</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <p class="para">以上例程在 PHP 5.5 中的输出：</p>
   <div class="example-contents screen">
<div class="cdata"><pre>
array(2) {
  [0]=&gt;
  string(3) "bar"
  [1]=&gt;
  string(4) "quux"
}

</pre></div>
   </div>
   <p class="para">以上例程在 PHP 5.6 中的输出：</p>
   <div class="example-contents screen">
<div class="cdata"><pre>
array(3) {
  [1]=&gt;
  string(3) "foo"
  [2]=&gt;
  string(3) "bar"
  [3]=&gt;
  string(4) "quux"
}
</pre></div>
   </div>
  </div>
 </div>

 <div class="sect2" id="migration56.incompatible.json-decode">
  <h3 class="title">严格的 <span class="function"><a href="function.json-decode.html" class="function">json_decode()</a></span></h3>

  <p class="para">
   对于 JSON 字面量 <code class="literal">true</code>，<code class="literal">false</code> 和
   <code class="literal">null</code>，如果不采用小写格式，将会被 <span class="function"><a href="function.json-decode.html" class="function">json_decode()</a></span> 函数拒绝，
   同时相应的设置 <span class="function"><a href="function.json-last-error.html" class="function">json_last_error()</a></span>。
   在之前的版本中，<span class="function"><a href="function.json-decode.html" class="function">json_decode()</a></span> 函数可以接受这些字面量的
   全部大写或者大小写混写的格式。
  </p>

  <p class="para">
   此变更仅会影响传入到 <span class="function"><a href="function.json-decode.html" class="function">json_decode()</a></span> 
   中的 JSON 格式无效的情况，
   有效的 JSON 输入不会受到影响并且能够正确解析。
  </p>
 </div>

 <div class="sect2" id="migration56.incompatible.peer-verification">
  <h3 class="title">当使用 SSL/TLS 的时候，流封装器默认验证端点证书和主机名</h3>

  
   <p class="para">
    All encrypted client streams now enable peer verification by default. By
    default, this will use OpenSSL's default CA bundle to verify the peer
    certificate. In most cases, no changes will need to be made to communicate
    with servers with valid SSL certificates, as distributors generally
    configure OpenSSL to use known good CA bundles.
   </p>
   
   <p class="para">
    The default CA bundle may be overridden on a global basis by setting
    either the openssl.cafile or openssl.capath configuration setting, or on a
    per request basis by using the
    <a href="context.ssl.html#context.ssl.cafile" class="link"><code class="parameter">cafile</code></a> or
    <a href="context.ssl.html#context.ssl.capath" class="link"><code class="parameter">capath</code></a>
    context options.
   </p>

   <p class="para">
    While not recommended in general, it is possible to disable peer
    certificate verification for a request by setting the
    <a href="context.ssl.html#context.ssl.verify-peer" class="link"><code class="parameter">verify_peer</code></a>
    context option to <strong><code>false</code></strong>, and to disable peer name validation by setting
    the <a href="context.ssl.html#context.ssl.verify-peer-name" class="link"><code class="parameter">verify_peer_name</code></a>
    context option to <strong><code>false</code></strong>.
   </p>

 </div>

 <div class="sect2" id="migration56.incompatible.gmp">
  <h3 class="title"><a href="book.gmp.html" class="link">GMP</a> 资源现为对象</h3>

  <p class="para">
   <a href="book.gmp.html" class="link">GMP</a> 资源现为对象。
   GMP 扩展中的基于函数的 API 实现不受影响，
   只有在代码中使用 <span class="function"><a href="function.is-resource.html" class="function">is_resource()</a></span> 或类似函数
   来显示检测是否资源类型的代码才会受到影响。
  </p>
 </div>

 <div class="sect2" id="migration56.incompatible.mcrypt">
  <h3 class="title"><a href="book.mcrypt.html" class="link">Mcrypt</a> 函数需要有效长度的密钥和初始向量</h3>

  <p class="para">
   <span class="function"><a href="function.mcrypt-encrypt.html" class="function">mcrypt_encrypt()</a></span>，<span class="function"><a href="function.mcrypt-decrypt.html" class="function">mcrypt_decrypt()</a></span>，
   <span class="function"><a href="function.mcrypt-cbc.html" class="function">mcrypt_cbc()</a></span>，<span class="function"><a href="function.mcrypt-cfb.html" class="function">mcrypt_cfb()</a></span>，
   <span class="function"><a href="function.mcrypt-ecb.html" class="function">mcrypt_ecb()</a></span>，<span class="function"><a href="function.mcrypt-generic.html" class="function">mcrypt_generic()</a></span> 以及
   <span class="function"><a href="function.mcrypt-ofb.html" class="function">mcrypt_ofb()</a></span> 函数不再接受无效长度的密钥和初始向量，
   对于需要初始向量的分组加密模式，如果不提供初始向量，函数调用将会失败。
  </p>
 </div>
 
 <div class="sect2" id="migration56.incompatible.curl">
  <h3 class="title"><a href="book.curl.html" class="link">cURL</a> 文件上传</h3>

  <p class="para">
   必须先设置 CURLOPT_SAFE_UPLOAD 为 <strong><code>false</code></strong> 才能够使用 @file 语法来上传文件。
   建议使用 <a href="class.curlfile.html" class="classname">CURLFile</a> 类来上传文件。
  </p>
 </div>
</div></div></div>
            </div>
        </div>
    </div>
    <div class="col-md-3 col-xl-2" id="toc-list">
        <ul></ul>
    </div>
</div>    </div>
</div>
<span id="back-top">
<svg width="20" height="20" fill="currentColor">
    <use xlink:href="/css/bootstrap-icons.svg#chevron-up"/>
</svg>
</span>
 
<script>
    // 浏览量统计
    $(function () {
        let formdata = new FormData();
        formdata.append('_token', '');
        formdata.append('id', 7594);
        $.ajax({
            url: $(".sticky-top .navbar-brand").attr('href') + "/api/doc/clicks",
            type: 'POST',
            data: formdata,
            processData: false,
            contentType: false
        });
    });
    // aside-hidden
    $(function () {
        $('#aside-hidden').on('click', function () {
            $('.aside').toggle(0, function () {
                if ($(this).is(':visible')) {
                    $('.aside-middle').removeClass('col-md-12 col-lg-12').addClass('col-md-9 col-lg-10');
                } else {
                    $('.aside-middle').removeClass('col-md-9 col-lg-10').addClass('col-md-12 col-lg-12');
                }
            });
        });
    });
</script>
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?1522d01c436f59ddc8389f25bfa9d53e";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
</body>
</html>