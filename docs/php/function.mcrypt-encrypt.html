<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"> 
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"> 
    <meta name="csrf-token" content=""> 
    <title>mcrypt_encrypt - 开发帮助文档</title> 
    <meta name="keyword" content="function.mcrypt-encrypt"> 
    <meta name="description" content="function.mcrypt-encrypt"> 
    <meta name="author" content="Moments"> 
    <link href="/favicon.ico" rel="shortcut icon"> 
    <link href="/css/blog.css" rel="stylesheet"> 
    <script src="/js/blog.js"></script> 
</head>
<body>
<header class="sticky-top">
    <nav class="navbar navbar-expand navbar-dark bg-secondary justify-content-between text-uppercase">
        <div class="navbar-nav" style="overflow:hidden;">
            <a class="navbar-brand" href="https://help.pythonschool.com">
                <span class="d-md-none">
                    <svg class="text-warning" width="24" height="24" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#emoji-sunglasses"/>
                    </svg>
                </span>
                <span class="d-none d-md-flex">开发帮助文档</span>
            </a>
            <div class="navbar-nav-scroll" style="overflow: hidden;">
                <ul class="navbar-nav text-nowrap pb-4" style="overflow:auto;">
                                            <li class="nav-item">
                            <a class="nav-link" href="/docs/laravel/index.html">laravel</a>
                        </li>
                                            <li class="nav-item">
                            <a class="nav-link active" href="/docs/php/index.html">php</a>
                        </li>
                                    </ul>
            </div>
        </div>
        <div class="d-inline-flex">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="https://github.com/liuhuashi">
                        <svg class="text-light" width="24" height="24" fill="currentColor">
                            <use xlink:href="/css/bootstrap-icons.svg#github"/>
                        </svg>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
</header>
<div class="container-fluid">
    <div id="aside-hidden" class="position-fixed" style="left:0;top: 58px;cursor:pointer;z-index: 10000;">
        <svg class="align-text-bottom text-warning" width="16" height="16" fill="currentColor" stroke="currentColor" stroke-width="1">
            <use xlink:href="/css/bootstrap-icons.svg#arrow-left-square"/>
        </svg>
    </div>
    <div class="row">
        <div class="aside col-md-3 col-lg-2 border-right shadow position-sticky" style="overflow:auto;height: calc(100vh - 58px);padding-bottom: calc(100vh/3);">
    <form class="row border-bottom p-3 bg-white sticky-top">
        <input id="search-version" class="form-control" data-version="1008" type="search" placeholder="英文逗号分隔,分词搜索">
    </form>
    <ul class="nav navbar-nav nav-pills flex-column pt-2 figure-caption">
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-cbc.html" title="mcrypt_cbc">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_cbc
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-cfb.html" title="mcrypt_cfb">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_cfb
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-create-iv.html" title="mcrypt_create_iv">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_create_iv
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-decrypt.html" title="mcrypt_decrypt">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_decrypt
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-ecb.html" title="mcrypt_ecb">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_ecb
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-enc-get-algorithms-name.html" title="mcrypt_enc_get_algorithms_name">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_enc_get_algorithms_name
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-enc-get-block-size.html" title="mcrypt_enc_get_block_size">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_enc_get_block_size
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-enc-get-iv-size.html" title="mcrypt_enc_get_iv_size">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_enc_get_iv_size
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-enc-get-key-size.html" title="mcrypt_enc_get_key_size">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_enc_get_key_size
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-enc-get-modes-name.html" title="mcrypt_enc_get_modes_name">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_enc_get_modes_name
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-enc-get-supported-key-sizes.html" title="mcrypt_enc_get_supported_key_sizes">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_enc_get_supported_key_sizes
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-enc-is-block-algorithm-mode.html" title="mcrypt_enc_is_block_algorithm_mode">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_enc_is_block_algorithm_mode
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-enc-is-block-algorithm.html" title="mcrypt_enc_is_block_algorithm">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_enc_is_block_algorithm
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-enc-is-block-mode.html" title="mcrypt_enc_is_block_mode">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_enc_is_block_mode
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-enc-self-test.html" title="mcrypt_enc_self_test">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_enc_self_test
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-encrypt.html" title="mcrypt_encrypt">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_encrypt
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-generic-deinit.html" title="mcrypt_generic_deinit">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_generic_deinit
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-generic-end.html" title="mcrypt_generic_end">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_generic_end
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-generic-init.html" title="mcrypt_generic_init">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_generic_init
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-generic.html" title="mcrypt_generic">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_generic
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-get-block-size.html" title="mcrypt_get_block_size">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_get_block_size
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-get-cipher-name.html" title="mcrypt_get_cipher_name">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_get_cipher_name
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-get-iv-size.html" title="mcrypt_get_iv_size">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_get_iv_size
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-get-key-size.html" title="mcrypt_get_key_size">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_get_key_size
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-list-algorithms.html" title="mcrypt_list_algorithms">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_list_algorithms
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-list-modes.html" title="mcrypt_list_modes">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_list_modes
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-module-close.html" title="mcrypt_module_close">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_module_close
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-module-get-algo-block-size.html" title="mcrypt_module_get_algo_block_size">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_module_get_algo_block_size
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-module-get-algo-key-size.html" title="mcrypt_module_get_algo_key_size">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_module_get_algo_key_size
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-module-get-supported-key-sizes.html" title="mcrypt_module_get_supported_key_sizes">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_module_get_supported_key_sizes
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-module-is-block-algorithm-mode.html" title="mcrypt_module_is_block_algorithm_mode">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_module_is_block_algorithm_mode
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-module-is-block-algorithm.html" title="mcrypt_module_is_block_algorithm">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_module_is_block_algorithm
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-module-is-block-mode.html" title="mcrypt_module_is_block_mode">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_module_is_block_mode
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-module-open.html" title="mcrypt_module_open">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_module_open
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-module-self-test.html" title="mcrypt_module_self_test">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_module_self_test
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mcrypt-ofb.html" title="mcrypt_ofb">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mcrypt_ofb
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/php/function.mdecrypt-generic.html" title="mdecrypt_generic">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    mdecrypt_generic
                </a>
            </li>
            </ul>
</div>        <div class="aside-middle col-md-9 col-lg-10 row">
    <div class="col-md-9 col-xl-10" style="overflow: auto;height: calc(100vh - 58px);padding-bottom: calc(100vh/3);">
        <div class="container main-h4-1">
            <div class="page-content">
                <div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.mcrypt-enc-self-test.html">« mcrypt_enc_self_test</a></li>
      <li style="float: right;"><a href="function.mcrypt-generic-deinit.html">mcrypt_generic_deinit »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="documentation.html">PHP Manual</a></li>
    <li><a href="ref.mcrypt.html">Mcrypt 函数</a></li>
    <li>使用给定参数加密明文</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.mcrypt-encrypt" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mcrypt_encrypt</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.2, PHP 5, PHP 7 &lt; 7.2.0, PECL mcrypt &gt;= 1.0.0)</p><p class="refpurpose"><span class="refname">mcrypt_encrypt</span> — <span class="dc-title">使用给定参数加密明文</span></p>

 </div>
 
 <div id="function.mcrypt-encrypt-refsynopsisdiv">
  <div class="warning"><strong class="warning">警告</strong><p class="simpara">本函数已自 PHP 7.1.0
起<em class="emphasis">废弃</em>。强烈建议不要使用本函数。</p></div>
 </div>
 
 <div class="refsect1 description" id="refsect1-function.mcrypt-encrypt-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>mcrypt_encrypt</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$cipher</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$key</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$data</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$mode</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$iv</code><span class="initializer"> = ?</span></span>
   ) : <span class="type">string</span></div>

  <p class="para rdfs-comment">
   加密数据并返回密文。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mcrypt-encrypt-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">cipher</code></dt>

     <dd>

      <p class="para"><strong><code>MCRYPT_ciphername</code></strong> 常量中的一个，或者是字符串值的算法名称。</p>
     </dd>

    
    
     <dt>
<code class="parameter">key</code></dt>

     <dd>

      <p class="para">
       加密密钥。
       如果密钥长度不是该算法所能够支持的有效长度，则函数将会发出警告并返回 <strong><code>false</code></strong>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">data</code></dt>

     <dd>

      <p class="para">
       使用给定的 <code class="parameter">cipher</code> 和 <code class="parameter">mode</code>
       加密的数据。
       如果数据长度不是 n*分组大小，则在其后使用 '<code class="literal">\0</code>' 补齐。
      </p>
      <p class="para">
       返回的密文长度可能比 <code class="parameter">data</code> 
       更大。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">mode</code></dt>

     <dd>

      <p class="para"><strong><code>MCRYPT_MODE_modename</code></strong> 常量中的一个，或以下字符串中的一个："ecb"，"cbc"，"cfb"，"ofb"，"nofb" 和 "stream"。</p>
     </dd>

    
    
     <dt>
<code class="parameter">iv</code></dt>

     <dd>

      <p class="para">Used for the initialization in CBC, CFB, OFB modes, and in some algorithms in STREAM mode. If the provided IV size is not supported by the chaining mode or no IV was provided, but the chaining mode requires one, the function will emit a warning and return <strong><code>false</code></strong>.</p>
     </dd>

    
   </dl>

  
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mcrypt-encrypt-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   以字符串方式返回密文， 或者在失败时返回 <strong><code>false</code></strong>。
  </p>
 </div>

<div class="refsect1 changelog" id="refsect1-function.mcrypt-encrypt-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   </p><table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.6.0</td>
       <td>
        不再接受无效长度的 <code class="parameter">key</code> and <code class="parameter">iv</code> 参数。
        如果参数长度无效，则 <span class="function"><a href="function.mcrypt-decrypt.html" class="function">mcrypt_decrypt()</a></span> 函数会产生警告并且返回 <strong><code>false</code></strong>。
        之前版本中，对于长度不足的密钥和初始向量会在其后补齐 '<code class="literal">\0</code>' 
        使其达到有效长度。
       </td>
      </tr>

     </tbody>
    
   </table>

  
 </div>

 <div class="refsect1 examples" id="refsect1-function.mcrypt-encrypt-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   </p><div class="example" id="example-867">
    <p><strong>示例 #1 <span class="function"><strong>mcrypt_encrypt()</strong></span> 例程</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>    </span><span style="color: #FF8000"># --- 加密 ---<br><br>    # 密钥应该是随机的二进制数据，<br>    # 开始使用 scrypt, bcrypt 或 PBKDF2 将一个字符串转换成一个密钥<br>    # 密钥是 16 进制字符串格式<br>    </span><span style="color: #0000BB">$key </span><span style="color: #007700">= </span><span style="color: #0000BB">pack</span><span style="color: #007700">(</span><span style="color: #DD0000">'H*'</span><span style="color: #007700">, </span><span style="color: #DD0000">"bcb04b7e103a0cd8b54763051cef08bc55abe029fdebae5e1d417e2ffb2a00a3"</span><span style="color: #007700">);<br>    <br>    </span><span style="color: #FF8000"># 显示 AES-128, 192, 256 对应的密钥长度：<br>    #16，24，32 字节。<br>    </span><span style="color: #0000BB">$key_size </span><span style="color: #007700">=  </span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">);<br>    echo </span><span style="color: #DD0000">"Key size: " </span><span style="color: #007700">. </span><span style="color: #0000BB">$key_size </span><span style="color: #007700">. </span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>    <br>    </span><span style="color: #0000BB">$plaintext </span><span style="color: #007700">= </span><span style="color: #DD0000">"This string was AES-256 / CBC / ZeroBytePadding encrypted."</span><span style="color: #007700">;<br><br>    </span><span style="color: #FF8000"># 为 CBC 模式创建随机的初始向量<br>    </span><span style="color: #0000BB">$iv_size </span><span style="color: #007700">= </span><span style="color: #0000BB">mcrypt_get_iv_size</span><span style="color: #007700">(</span><span style="color: #0000BB">MCRYPT_RIJNDAEL_128</span><span style="color: #007700">, </span><span style="color: #0000BB">MCRYPT_MODE_CBC</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$iv </span><span style="color: #007700">= </span><span style="color: #0000BB">mcrypt_create_iv</span><span style="color: #007700">(</span><span style="color: #0000BB">$iv_size</span><span style="color: #007700">, </span><span style="color: #0000BB">MCRYPT_RAND</span><span style="color: #007700">);<br>    <br><br>    </span><span style="color: #FF8000"># 创建和 AES 兼容的密文（Rijndael 分组大小 = 128）<br>    # 仅适用于编码后的输入不是以 00h 结尾的<br>    # （因为默认是使用 0 来补齐数据）<br>    </span><span style="color: #0000BB">$ciphertext </span><span style="color: #007700">= </span><span style="color: #0000BB">mcrypt_encrypt</span><span style="color: #007700">(</span><span style="color: #0000BB">MCRYPT_RIJNDAEL_128</span><span style="color: #007700">, </span><span style="color: #0000BB">$key</span><span style="color: #007700">,<br>                                 </span><span style="color: #0000BB">$plaintext</span><span style="color: #007700">, </span><span style="color: #0000BB">MCRYPT_MODE_CBC</span><span style="color: #007700">, </span><span style="color: #0000BB">$iv</span><span style="color: #007700">);<br><br>    </span><span style="color: #FF8000"># 将初始向量附加在密文之后，以供解密时使用<br>    </span><span style="color: #0000BB">$ciphertext </span><span style="color: #007700">= </span><span style="color: #0000BB">$iv </span><span style="color: #007700">. </span><span style="color: #0000BB">$ciphertext</span><span style="color: #007700">;<br>    <br>    </span><span style="color: #FF8000"># 对密文进行 base64 编码<br>    </span><span style="color: #0000BB">$ciphertext_base64 </span><span style="color: #007700">= </span><span style="color: #0000BB">base64_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$ciphertext</span><span style="color: #007700">);<br><br>    echo  </span><span style="color: #0000BB">$ciphertext_base64 </span><span style="color: #007700">. </span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br><br>    </span><span style="color: #FF8000"># === 警告 ===<br><br>    # 密文并未进行完整性和可信度保护，<br>    # 所以可能遭受 Padding Oracle 攻击。<br>    <br>    # --- 解密 ---<br>    <br>    </span><span style="color: #0000BB">$ciphertext_dec </span><span style="color: #007700">= </span><span style="color: #0000BB">base64_decode</span><span style="color: #007700">(</span><span style="color: #0000BB">$ciphertext_base64</span><span style="color: #007700">);<br>    <br>    </span><span style="color: #FF8000"># 初始向量大小，可以通过 mcrypt_get_iv_size() 来获得<br>    </span><span style="color: #0000BB">$iv_dec </span><span style="color: #007700">= </span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$ciphertext_dec</span><span style="color: #007700">, </span><span style="color: #0000BB">0</span><span style="color: #007700">, </span><span style="color: #0000BB">$iv_size</span><span style="color: #007700">);<br>    <br>    </span><span style="color: #FF8000"># 获取除初始向量外的密文<br>    </span><span style="color: #0000BB">$ciphertext_dec </span><span style="color: #007700">= </span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$ciphertext_dec</span><span style="color: #007700">, </span><span style="color: #0000BB">$iv_size</span><span style="color: #007700">);<br><br>    </span><span style="color: #FF8000"># 可能需要从明文末尾移除 0<br>    </span><span style="color: #0000BB">$plaintext_dec </span><span style="color: #007700">= </span><span style="color: #0000BB">mcrypt_decrypt</span><span style="color: #007700">(</span><span style="color: #0000BB">MCRYPT_RIJNDAEL_128</span><span style="color: #007700">, </span><span style="color: #0000BB">$key</span><span style="color: #007700">,<br>                                    </span><span style="color: #0000BB">$ciphertext_dec</span><span style="color: #007700">, </span><span style="color: #0000BB">MCRYPT_MODE_CBC</span><span style="color: #007700">, </span><span style="color: #0000BB">$iv_dec</span><span style="color: #007700">);<br>    <br>    echo  </span><span style="color: #0000BB">$plaintext_dec </span><span style="color: #007700">. </span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Key size: 32
ENJW8mS2KaJoNB5E5CoSAAu0xARgsR1bdzFWpEn+poYw45q+73az5kYi4j+0haevext1dGrcW8Qi59txfCBV8BBj3bzRP3dFCp3CPQSJ8eU=
This string was AES-256 / CBC / ZeroBytePadding encrypted.
</pre></div>
    </div>
   </div>
  
 </div>

 <div class="refsect1 seealso" id="refsect1-function.mcrypt-encrypt-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mcrypt-decrypt.html" class="function" rel="rdfs-seeAlso">mcrypt_decrypt()</a> - 使用给定参数解密密文</span></li>
    <li class="member"><span class="function"><a href="function.mcrypt-module-open.html" class="function" rel="rdfs-seeAlso">mcrypt_module_open()</a> - 打开算法和模式对应的模块</span></li>
   </ul>
  
 </div>

</div></div></div>
            </div>
        </div>
    </div>
    <div class="col-md-3 col-xl-2" id="toc-list">
        <ul></ul>
    </div>
</div>    </div>
</div>
<span id="back-top">
<svg width="20" height="20" fill="currentColor">
    <use xlink:href="/css/bootstrap-icons.svg#chevron-up"/>
</svg>
</span>
 
<script>
    // 浏览量统计
    $(function () {
        let formdata = new FormData();
        formdata.append('_token', '');
        formdata.append('id', 4100);
        $.ajax({
            url: $(".sticky-top .navbar-brand").attr('href') + "/api/doc/clicks",
            type: 'POST',
            data: formdata,
            processData: false,
            contentType: false
        });
    });
    // aside-hidden
    $(function () {
        $('#aside-hidden').on('click', function () {
            $('.aside').toggle(0, function () {
                if ($(this).is(':visible')) {
                    $('.aside-middle').removeClass('col-md-12 col-lg-12').addClass('col-md-9 col-lg-10');
                } else {
                    $('.aside-middle').removeClass('col-md-9 col-lg-10').addClass('col-md-12 col-lg-12');
                }
            });
        });
    });
</script>
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?1522d01c436f59ddc8389f25bfa9d53e";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
</body>
</html>