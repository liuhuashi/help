<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"> 
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"> 
    <meta name="csrf-token" content=""> 
    <title>Eloquent: API 资源 - 开发帮助文档</title> 
    <meta name="keyword" content="eloquent-resources"> 
    <meta name="description" content="eloquent-resources"> 
    <meta name="author" content="Moments"> 
    <link href="/favicon.ico" rel="shortcut icon"> 
    <link href="/css/blog.css" rel="stylesheet"> 
    <script src="/js/blog.js"></script> 
</head>
<body>
<header class="sticky-top">
    <nav class="navbar navbar-expand navbar-dark bg-secondary justify-content-between text-uppercase">
        <div class="navbar-nav" style="overflow:hidden;">
            <a class="navbar-brand" href="https://help.pythonschool.com">
                <span class="d-md-none">
                    <svg class="text-warning" width="24" height="24" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#emoji-sunglasses"/>
                    </svg>
                </span>
                <span class="d-none d-md-flex">开发帮助文档</span>
            </a>
            <div class="navbar-nav-scroll" style="overflow: hidden;">
                <ul class="navbar-nav text-nowrap pb-4" style="overflow:auto;">
                                            <li class="nav-item">
                            <a class="nav-link active" href="/docs/laravel/index.html">laravel</a>
                        </li>
                                            <li class="nav-item">
                            <a class="nav-link" href="/docs/php/index.html">php</a>
                        </li>
                                    </ul>
            </div>
        </div>
        <div class="d-inline-flex">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="https://github.com/liuhuashi">
                        <svg class="text-light" width="24" height="24" fill="currentColor">
                            <use xlink:href="/css/bootstrap-icons.svg#github"/>
                        </svg>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
</header>
<div class="container-fluid">
    <div id="aside-hidden" class="position-fixed" style="left:0;top: 58px;cursor:pointer;z-index: 10000;">
        <svg class="align-text-bottom text-warning" width="16" height="16" fill="currentColor" stroke="currentColor" stroke-width="1">
            <use xlink:href="/css/bootstrap-icons.svg#arrow-left-square"/>
        </svg>
    </div>
    <div class="row">
        <div class="aside col-md-3 col-lg-2 border-right shadow position-sticky" style="overflow:auto;height: calc(100vh - 58px);padding-bottom: calc(100vh/3);">
    <form class="row border-bottom p-3 bg-white sticky-top">
        <input id="search-version" class="form-control" data-version="5" type="search" placeholder="英文逗号分隔,分词搜索">
    </form>
    <ul class="nav navbar-nav nav-pills flex-column pt-2 figure-caption">
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/about.html" title="Laravel 5.8 中文文档">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 5.8 中文文档
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/api-authentication.html" title="API Authentication">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    API Authentication
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/artisan.html" title="Laravel 的 Artisan 命令行工具">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 Artisan 命令行工具
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/authentication.html" title="Laravel 的用户认证系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的用户认证系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/authorization.html" title="Laravel 的用户授权系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的用户授权系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/billing.html" title="Laravel 的收费系统 Cashier">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的收费系统 Cashier
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/blade.html" title="Laravel 的 Blade 模板引擎">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 Blade 模板引擎
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/braintree.html" title="Laravel Cashier (Braintree)">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Cashier (Braintree)
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/broadcasting.html" title="Laravel 的事件广播系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的事件广播系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/cache.html" title="Laravel 的缓存系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的缓存系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/collections.html" title="Laravel 的集合 Collection">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的集合 Collection
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/configuration.html" title="Laravel 的配置信息">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的配置信息
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/console-tests.html" title="Console Tests">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Console Tests
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/container.html" title="Laravel 服务容器解析">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 服务容器解析
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/contracts.html" title="Laravel 的契约 (Contracts)">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的契约 (Contracts)
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/contributions.html" title="Laravel 源代码贡献指南">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 源代码贡献指南
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/controllers.html" title="Laravel 的 HTTP 控制器">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 HTTP 控制器
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/csrf.html" title="Laravel 下的伪造跨站请求保护 CSRF">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 下的伪造跨站请求保护 CSRF
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/database-testing.html" title="Laravel 测试之 - 数据库测试">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 测试之 - 数据库测试
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/database.html" title="数据库：入门">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    数据库：入门
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/deployment.html" title="Laravel 的部署">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的部署
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/documentation.html" title="主页(Index)">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    主页(Index)
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/dusk.html" title="Laravel 测试之 - 浏览器测试 (Laravel Dusk)">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 测试之 - 浏览器测试 (Laravel Dusk)
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/eloquent-collections.html" title="Eloquent：集合">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent：集合
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/eloquent-mutators.html" title="Eloquent： 修改器">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent： 修改器
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/eloquent-relationships.html" title="Eloquent：关联">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent：关联
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/eloquent-resources.html" title="Eloquent: API 资源">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: API 资源
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/eloquent-serialization.html" title="Eloquent: 序列化">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: 序列化
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/eloquent.html" title="Eloquent: 入门">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: 入门
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/encryption.html" title="Laravel 的加密解密机制">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的加密解密机制
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/envoy.html" title="Laravel 的远程服务器任务处理器 Envoy">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的远程服务器任务处理器 Envoy
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/errors.html" title="Laravel 的错误和日志记录">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的错误和日志记录
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/events.html" title="Laravel 的事件系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的事件系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/facades.html" title="Laravel 的 Facades">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 Facades
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/filesystem.html" title="Laravel 的文件系统和云存储功能集成">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的文件系统和云存储功能集成
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/frontend.html" title="Laravel 的前端资源处理 JavaScript＆CSS 构建">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的前端资源处理 JavaScript＆CSS 构建
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/hashing.html" title="Laravel 的哈希加密">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的哈希加密
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/helpers.html" title="Laravel 的辅助函数列表">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的辅助函数列表
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/homestead.html" title="Laravel 虚拟开发环境 Homestead">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 虚拟开发环境 Homestead
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/horizon.html" title="Laravel 队列监控面板 - Horizon">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 队列监控面板 - Horizon
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/http-tests.html" title="Laravel 测试之：HTTP 测试">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 测试之：HTTP 测试
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/installation.html" title="Laravel 安装指南">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 安装指南
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/license.html" title="license">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    license
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/lifecycle.html" title="Laravel 的请求生命周期">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的请求生命周期
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/localization.html" title="Laravel 的本地化功能">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的本地化功能
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/logging.html" title="Logging">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Logging
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/mail.html" title="Laravel 的 邮件发送功能">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 邮件发送功能
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/middleware.html" title="Laravel 的路由中间件">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的路由中间件
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/migrations.html" title="Laravel 的数据库迁移 Migrations">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的数据库迁移 Migrations
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/mix.html" title="Laravel 的资源任务编译器 Laravel Mix">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的资源任务编译器 Laravel Mix
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/mocking.html" title="Laravel 测试之：测试模拟器">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 测试之：测试模拟器
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/notifications.html" title="Laravel 的消息通知系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的消息通知系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/packages.html" title="Laravel 的扩展插件开发指南">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的扩展插件开发指南
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/pagination.html" title="Laravel 的分页功能">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的分页功能
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/passport.html" title="Laravel 的 API 认证系统 Passport">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 API 认证系统 Passport
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/passwords.html" title="Laravel 的密码重置功能">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的密码重置功能
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/providers.html" title="Laravel 的服务提供器">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的服务提供器
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/queries.html" title="Laravel 数据库之：数据库请求构建器">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 数据库之：数据库请求构建器
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/queues.html" title="Laravel 的队列系统介绍">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的队列系统介绍
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/readme.html" title="Laravel Documentation">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Documentation
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/redirects.html" title="Laravel 的 HTTP 重定向 Redirect">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 HTTP 重定向 Redirect
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/redis.html" title="Laravel 的 Redis 使用指南">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 Redis 使用指南
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/releases.html" title="发行说明">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    发行说明
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/requests.html" title="Laravel 的 HTTP 请求">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 HTTP 请求
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/responses.html" title="Laravel 的请求响应">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的请求响应
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/routing.html" title="Laravel HTTP 路由功能">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel HTTP 路由功能
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/scheduling.html" title="Laravel 的任务调度（计划任务）功能 Task Scheduling">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的任务调度（计划任务）功能 Task Scheduling
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/scout.html" title="Laravel 的搜索系统 Scout">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的搜索系统 Scout
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/seeding.html" title="Laravel 数据库之：数据填充">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 数据库之：数据填充
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/session.html" title="Laravel 的 HTTP 会话机制">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 HTTP 会话机制
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/socialite.html" title="Laravel 的 社会化登录功能">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 社会化登录功能
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/structure.html" title="Laravel 的文件夹结构">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的文件夹结构
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/telescope.html" title="Laravel Telescope">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Telescope
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/testing.html" title="Laravel 测试: 入门指南">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 测试: 入门指南
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/upgrade.html" title="Laravel 升级索引">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 升级索引
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/urls.html" title="Laravel 的 URL 生成">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 URL 生成
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/valet.html" title="Laravel 的开发环境 Valet">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的开发环境 Valet
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/validation.html" title="Laravel 的表单验证机制详解">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的表单验证机制详解
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/verification.html" title="Email Verification">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Email Verification
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/views.html" title="Laravel 的视图">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的视图
                </a>
            </li>
            </ul>
</div>        <div class="aside-middle col-md-9 col-lg-10 row">
    <div class="col-md-9 col-xl-10" style="overflow: auto;height: calc(100vh - 58px);padding-bottom: calc(100vh/3);">
        <div class="container main-h4-1">
            <div class="page-content">
                <h1>Eloquent: API 资源</h1>
<ul>
<li><a href="#introduction">简介</a></li>
<li><a href="#generating-resources">生成资源</a></li>
<li><a href="#concept-overview">概念综述</a></li>
<li><a href="#writing-resources">编写资源</a>
<ul>
<li><a href="#data-wrapping">数据包裹</a></li>
<li><a href="#pagination">分页</a></li>
<li><a href="#conditional-attributes">条件属性</a></li>
<li><a href="#conditional-relationships">条件关联</a></li>
<li><a href="#adding-meta-data">添加元数据</a></li>
</ul></li>
<li><a href="#resource-responses">资源响应</a></li>
</ul>
<p><a name="introduction"></a></p>
<h2>简介</h2>
<p>当构建 API 时，你往往需要一个转换层来联结你的 Eloquent 模型和实际返回给用户的 JSON 响应。 Laravel 的资源类能够让你以更直观简便的方式将模型和模型集合转化成 JSON 。</p>
<p><a name="generating-resources"></a></p>
<h2>生成资源</h2>
<p>你可以使用 <code>make:resource</code> Artisan 命令来生成资源类。默认情况下生成的资源都会被放置在框架 <code>app/Http/Resources</code> 文件夹下。资源继承 <code>Illuminate\Http\Resources\Json\Resource</code> 类：</p>
<pre><code>php artisan make:resource User</code></pre>
<h4>资源集合</h4>
<p>除了生成资源转换单个模型外，你还可以生成资源集合用来转换模型的集合。这允许你在响应中包含与给定资源相关的链接与其他元信息。</p>
<p>你需要在生成资源时添加 <code>--collection</code> 标志以生成一个资源集合。你也可以直接在资源的名称中包含 <code>Collection</code> 向 Laravel 表示应该生成一个资源集合。资源集合继承 <code>Illuminate\Http\Resources\Json\ResourceCollection</code> 类：</p>
<pre><code>php artisan make:resource Users --collection

php artisan make:resource UserCollection</code></pre>
<p><a name="concept-overview"></a></p>
<h2>概念综述</h2>
<blockquote>
<p>{tip} 这是对资源和资源集合的概述。强烈建议你阅读本文档的其他部分，以深入了解如何更好地自定义和使用资源。</p>
</blockquote>
<p>在深入了解如何定制化编写你的资源之前，让我们先来看看在 Laravel 中如何使用资源。一个资源类表示一个单一模型需要被转换成 JSON 格式。例如，现在我们有一个简单的 <code>User</code> 资源类：</p>
<pre><code>&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\Resources\Json\Resource;

class User extends Resource
{
    /**
     * 将资源转换成数组。
     *
     * @param  \Illuminate\Http\Request
     * @return array
     */
    public function toArray($request)
    {
        return [
            'id' =&gt; $this-&gt;id,
            'name' =&gt; $this-&gt;name,
            'email' =&gt; $this-&gt;email,
            'created_at' =&gt; $this-&gt;created_at,
            'updated_at' =&gt; $this-&gt;updated_at,
        ];
    }
}</code></pre>
<p>每一个资源类都定义了一个 <code>toArray</code> 方法，在发送响应时它会返回应该被转化成 JSON 的属性数组。注意在这里我们可以直接使用 <code>$this</code> 变量来访问模型属性。这是因为资源类将自动代理属性和方法到底层模型以方便访问。你可以在路由或控制器中返回已定义的资源：</p>
<pre><code>use App\User;
use App\Http\Resources\User as UserResource;

Route::get('/user', function () {
    return new UserResource(User::find(1));
});</code></pre>
<h3>资源集合</h3>
<p>你可以在路由或控制器中使用 <code>collection</code> 方法来创建资源实例，以返回多个资源的集合或分页响应：</p>
<pre><code>use App\User;
use App\Http\Resources\User as UserResource;

Route::get('/user', function () {
    return UserResource::collection(User::all());
});</code></pre>
<p>使用如上方法，你将不能添加任何附加的元数据和集合一起返回。如果你需要自定义资源集合响应，你需要创建一个资源集合来返回多个模型的集合：</p>
<pre><code>php artisan make:resource UserCollection</code></pre>
<p>你可以轻松的在已生成的资源集合类中定义任何你想在响应中返回的元数据：</p>
<pre><code>&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\Resources\Json\ResourceCollection;

class UserCollection extends ResourceCollection
{
    /**
     * 将资源集合转换成数组。
     *
     * @param  \Illuminate\Http\Request
     * @return array
     */
    public function toArray($request)
    {
        return [
            'data' =&gt; $this-&gt;collection,
            'links' =&gt; [
                'self' =&gt; 'link-value',
            ],
        ];
    }
}</code></pre>
<p>你可以在路由或控制器中返回已定义的资源集合：</p>
<pre><code>use App\User;
use App\Http\Resources\UserCollection;

Route::get('/users', function () {
    return new UserCollection(User::all());
});</code></pre>
<p><a name="writing-resources"></a></p>
<h2>编写资源</h2>
<blockquote>
<p>{tip} 如果你还没有阅读过 <a href="#concept-overview">概念综述</a> , 那么强烈建议你在继续使用本文档前阅读这个部分。</p>
</blockquote>
<p>从本质上来说，资源的作用很简单。它们只需要将一个给定的模型转换成一个数组。所以每一个资源都包含一个 <code>toArray</code> 方法用来将你的模型属性转换成可以返回给用户的 API 友好的数组：</p>
<pre><code>&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\Resources\Json\Resource;

class User extends Resource
{
    /**
     * 将资源转换成数组。
     *
     * @param  \Illuminate\Http\Request
     * @return array
     */
    public function toArray($request)
    {
        return [
            'id' =&gt; $this-&gt;id,
            'name' =&gt; $this-&gt;name,
            'email' =&gt; $this-&gt;email,
            'created_at' =&gt; $this-&gt;created_at,
            'updated_at' =&gt; $this-&gt;updated_at,
        ];
    }
}</code></pre>
<p>你可以在路由或控制器中返回已定义的资源：</p>
<pre><code>use App\User;
use App\Http\Resources\User as UserResource;

Route::get('/user', function () {
    return new UserResource(User::find(1));
});</code></pre>
<h4>关联</h4>
<p>如果你希望在响应中包含关联资源，你只需要简单的将它们添加到 <code>toArray</code> 方法返回的数组中。在下面这个例子里，我们将使用 <code>Post</code> 资源的 <code>collection</code> 方法将用户的文章添加到资源响应中：</p>
<pre><code>/**
 * 将资源转换成数组。
 *
 * @param  \Illuminate\Http\Request
 * @return array
 */
public function toArray($request)
{
    return [
        'id' =&gt; $this-&gt;id,
        'name' =&gt; $this-&gt;name,
        'email' =&gt; $this-&gt;email,
        'posts' =&gt; Post::collection($this-&gt;posts),
        'created_at' =&gt; $this-&gt;created_at,
        'updated_at' =&gt; $this-&gt;updated_at,
    ];
}</code></pre>
<blockquote>
<p>{tip} 如果你只想在关联已经加载时添加关联资源，请查看文档 <a href="#conditional-relationships">条件关联</a> 。</p>
</blockquote>
<h4>资源集合</h4>
<p>资源是将单个模型转换成数组，而资源集合是将多个模型的集合转换成数组。所有的资源都提供了一个 <code>collection</code> 方法来生成一个 「临时」 资源集合，所以你没有必要为每一个模型类型都编写一个资源集合类：</p>
<pre><code>use App\User;
use App\Http\Resources\User as UserResource;

Route::get('/user', function () {
    return UserResource::collection(User::all());
});</code></pre>
<p>如果你需要自定义返回集合的元数据，则需要定义一个资源集合：</p>
<pre><code>&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\Resources\Json\ResourceCollection;

class UserCollection extends ResourceCollection
{
    /**
     * 将资源集合转换成数组。
     *
     * @param  \Illuminate\Http\Request
     * @return array
     */
    public function toArray($request)
    {
        return [
            'data' =&gt; $this-&gt;collection,
            'links' =&gt; [
                'self' =&gt; 'link-value',
            ],
        ];
    }
}</code></pre>
<p>和单个资源一样，你可以在路由或控制器中直接返回资源集合：</p>
<pre><code>use App\User;
use App\Http\Resources\UserCollection;

Route::get('/users', function () {
    return new UserCollection(User::all());
});</code></pre>
<p><a name="data-wrapping"></a></p>
<h3>数据包裹</h3>
<p>默认情况下，当资源响应被转换成 JSON 时，顶层资源将会被包裹在 <code>data</code> 键中。因此一个典型的资源集合响应如下所示：</p>
<pre><code>{
    "data": [
        {
            "id": 1,
            "name": "Eladio Schroeder Sr.",
            "email": "therese28@example.com",
        },
        {
            "id": 2,
            "name": "Liliana Mayert",
            "email": "evandervort@example.com",
        }
    ]
}</code></pre>
<p>你可以使用资源基类的 <code>withoutWrapping</code> 方法来禁用顶层资源的包裹。你应该在 <code>AppServiceProvider</code> 或其他在程序每一个请求中都会被加载的 <a href="/docs/laravel_5.8_zh/providers.html">服务提供者</a> 中调用此方法：</p>
<pre><code>&lt;?php

namespace App\Providers;

use Illuminate\Support\ServiceProvider;
use Illuminate\Http\Resources\Json\Resource;

class AppServiceProvider extends ServiceProvider
{
    /**
     * 在注册后进行服务的启动。
     *
     * @return void
     */
    public function boot()
    {
        Resource::withoutWrapping();
    }

    /**
     * 在容器中注册绑定。
     *
     * @return void
     */
    public function register()
    {
        //
    }
}</code></pre>
<blockquote>
<p>{note}  <code>withoutWrapping</code> 方法只会禁用顶层资源的包裹，不会删除你手动添加到资源集合中的 <code>data</code> 键。</p>
</blockquote>
<h3>包裹嵌套资源</h3>
<p>你有绝对的自由决定你的资源关联如何被包裹。如果你希望无论怎样嵌套，都将所有资源集合包裹在 <code>data</code> 键中，那么你需要为每个资源都定义一个资源集合类，并将返回的集合包裹在 <code>data</code> 键中。</p>
<p>当然，你可能会担心这样顶层资源将会被包裹在两个 <code>data</code> 键中。请放心， Laravel 将永远不会让你的资源被双层包裹，因此你不必担心被转换的资源集合会被多重嵌套：</p>
<pre><code>&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\Resources\Json\ResourceCollection;

class CommentsCollection extends ResourceCollection
{
    /**
     * 将资源集合转换成数组。
     *
     * @param  \Illuminate\Http\Request
     * @return array
     */
    public function toArray($request)
    {
        return ['data' =&gt; $this-&gt;collection];
    }
}</code></pre>
<h3>数据包裹和分页</h3>
<p>当在资源响应中返回分页集合时，即使你调用了 <code>withoutWrapping</code> 方法， Laravel 也会将你的资源数据包裹在 <code>data</code> 键中。这是因为分页响应中总会有 <code>meta</code> 和 <code>links</code> 键包含着分页状态信息：</p>
<pre><code>{
    "data": [
        {
            "id": 1,
            "name": "Eladio Schroeder Sr.",
            "email": "therese28@example.com",
        },
        {
            "id": 2,
            "name": "Liliana Mayert",
            "email": "evandervort@example.com",
        }
    ],
    "links":{
        "first": "http://example.com/pagination?page=1",
        "last": "http://example.com/pagination?page=1",
        "prev": null,
        "next": null
    },
    "meta":{
        "current_page": 1,
        "from": 1,
        "last_page": 1,
        "path": "http://example.com/pagination",
        "per_page": 15,
        "to": 10,
        "total": 10
    }
}</code></pre>
<p><a name="pagination"></a></p>
<h3>分页</h3>
<p>你可以将分页实例传递给资源的 <code>collection</code> 方法或者自定义的资源集合：</p>
<pre><code>use App\User;
use App\Http\Resources\UserCollection;

Route::get('/users', function () {
    return new UserCollection(User::paginate());
});</code></pre>
<p>分页响应中总有 <code>meta</code> 和 <code>links</code> 键包含着分页状态信息：</p>
<pre><code>{
    "data": [
        {
            "id": 1,
            "name": "Eladio Schroeder Sr.",
            "email": "therese28@example.com",
        },
        {
            "id": 2,
            "name": "Liliana Mayert",
            "email": "evandervort@example.com",
        }
    ],
    "links":{
        "first": "http://example.com/pagination?page=1",
        "last": "http://example.com/pagination?page=1",
        "prev": null,
        "next": null
    },
    "meta":{
        "current_page": 1,
        "from": 1,
        "last_page": 1,
        "path": "http://example.com/pagination",
        "per_page": 15,
        "to": 10,
        "total": 10
    }
}</code></pre>
<p><a name="conditional-attributes"></a></p>
<h3>条件属性</h3>
<p>有些时候，你可能希望在给定条件满足时添加属性到资源响应里。例如，你可能希望如果当前用户是 「管理员」 时添加某个值到资源响应中。在这种情况下 Laravel 提供了一些辅助方法来帮助你解决问题。 <code>when</code> 方法可以被用来有条件地向资源响应添加属性：</p>
<pre><code>/**
 * 将资源转换成数组。
 *
 * @param  \Illuminate\Http\Request
 * @return array
 */
public function toArray($request)
{
    return [
        'id' =&gt; $this-&gt;id,
        'name' =&gt; $this-&gt;name,
        'email' =&gt; $this-&gt;email,
        'secret' =&gt; $this-&gt;when($this-&gt;isAdmin(), 'secret-value'),
        'created_at' =&gt; $this-&gt;created_at,
        'updated_at' =&gt; $this-&gt;updated_at,
    ];
}</code></pre>
<p>在上面这个例子中，只有当 <code>$this-&gt;isAdmin()</code> 方法返回 <code>true</code> 时， <code>secret</code> 键才会最终在资源响应中被返回。如果该方法返回 <code>false</code> ，则 <code>secret</code> 键将会在资源响应被发送给客户端之前被删除。 <code>when</code> 方法可以使你避免使用条件语句拼接数组，转而用更优雅的方式来编写你的资源。</p>
<p><code>when</code> 方法也接受闭包作为其第二个参数，只有在给定条件为 <code>true</code> 时，才从闭包中计算返回的值：</p>
<pre><code>'secret' =&gt; $this-&gt;when($this-&gt;isAdmin(), function () {
    return 'secret-value';
}),</code></pre>
<blockquote>
<p>{tip} 记住，你在资源上调用的方法将被代理到底层模型实例。所以在这种情况下，你调用的 <code>isAdmin</code> 方法实际上是调用最初传递给资源的 Eloquent 模型上的方法。</p>
</blockquote>
<h4>有条件地合并数据</h4>
<p>有些时候，你可能希望在给定条件满足时添加多个属性到资源响应里。在这种情况下，你可以使用 <code>mergeWhen</code> 方法在给定的条件为 <code>true</code> 时将多个属性添加到响应中：</p>
<pre><code>/**
 * 将资源转换成数组。
 *
 * @param  \Illuminate\Http\Request
 * @return array
 */
public function toArray($request)
{
    return [
        'id' =&gt; $this-&gt;id,
        'name' =&gt; $this-&gt;name,
        'email' =&gt; $this-&gt;email,
        $this-&gt;mergeWhen($this-&gt;isAdmin(), [
            'first-secret' =&gt; 'value',
            'second-secret' =&gt; 'value',
        ]),
        'created_at' =&gt; $this-&gt;created_at,
        'updated_at' =&gt; $this-&gt;updated_at,
    ];
}</code></pre>
<p>同理，如果给定的条件为 <code>false</code> 时，则这些属性将会在资源响应被发送给客户端之前被删除。</p>
<blockquote>
<p>{note} 在混合字符串和数字键的数组中你不应该使用 <code>mergeWhen</code> 方法。此外，它不应该在不按顺序排列的数字键的数组中被使用。</p>
</blockquote>
<p><a name="conditional-relationships"></a></p>
<h3>条件关联</h3>
<p>除了有条件地添加属性之外，你还可以根据模型关联是否已加载来有条件的在你的资源响应中包含关联。这允许你在控制器中决定加载哪些模型关联，这样你的资源可以在模型关联被加载后才添加它们。</p>
<p>这样做可以避免在你的资源中出现 「N+1」 查询问题。你应该使用 <code>whenLoaded</code> 方法来有条件的加载关联。为了避免加载不必要的关联，此方法接受关联的名称而不是关联本身作为其参数：</p>
<pre><code>/**
 * 将资源转换成数组。
 *
 * @param  \Illuminate\Http\Request
 * @return array
 */
public function toArray($request)
{
    return [
        'id' =&gt; $this-&gt;id,
        'name' =&gt; $this-&gt;name,
        'email' =&gt; $this-&gt;email,
        'posts' =&gt; Post::collection($this-&gt;whenLoaded('posts')),
        'created_at' =&gt; $this-&gt;created_at,
        'updated_at' =&gt; $this-&gt;updated_at,
    ];
}</code></pre>
<p>在上面这个例子中，如果关联没有被加载，则 <code>posts</code> 键将会在资源响应被发送给客户端之前被删除。</p>
<h4>条件中间表信息</h4>
<p>除了在你的资源响应中有条件地包含关联外，你还可以使用 <code>whenPivotLoaded</code> 方法有条件地从多对多关联的中间表中添加数据。 <code>whenPivotLoaded</code> 方法第一个参数为中间表的名称。第二个参数应为当模型中间表信息可用时返回要添加数据的闭包：</p>
<pre><code>/**
 * 将资源转换成数组。
 *
 * @param  \Illuminate\Http\Request
 * @return array
 */
public function toArray($request)
{
    return [
        'id' =&gt; $this-&gt;id,
        'name' =&gt; $this-&gt;name,
        'expires_at' =&gt; $this-&gt;whenPivotLoaded('role_users', function () {
            return $this-&gt;pivot-&gt;expires_at;
        }),
    ];
}</code></pre>
<p><a name="adding-meta-data"></a></p>
<h3>添加元数据</h3>
<p>一些 JSON API 标准需要你在资源和资源集合响应中添加元数据。这通常包括资源或相关资源的 <code>links</code> ，或一些关于资源本身的元数据。如果你需要返回有关资源的其他元数据，只需要将它们包含在 <code>toArray</code> 方法中即可。例如在转换资源集合时你可能需要添加 <code>links</code> 信息：</p>
<pre><code>/**
 * 将资源转换成数组。
 *
 * @param  \Illuminate\Http\Request
 * @return array
 */
public function toArray($request)
{
    return [
        'data' =&gt; $this-&gt;collection,
        'links' =&gt; [
            'self' =&gt; 'link-value',
        ],
    ];
}</code></pre>
<p>当添加额外元数据到你的资源中时，你不必担心会覆盖 Laravel 在返回分页响应时自动添加的 <code>links</code> 或 <code>meta</code> 键。你添加的任何其他 <code>links</code> 会与分页响应添加的 <code>links</code> 相合并。</p>
<h4>顶层元数据</h4>
<p>有时候你可能希望当资源被作为顶层资源返回时添加某些元数据到资源响应中。这通常包括整个响应的元信息。你可以在资源类中添加 <code>with</code> 方法来定义元数据。此方法应返回一个元数据数组，当资源被作为顶层资源渲染时，这个数组将会被包含在资源响应中：</p>
<pre><code>&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\Resources\Json\ResourceCollection;

class UserCollection extends ResourceCollection
{
    /**
     * 将资源集合转换成数组。
     *
     * @param  \Illuminate\Http\Request
     * @return array
     */
    public function toArray($request)
    {
        return parent::toArray($request);
    }

    /**
     * 返回应该和资源一起返回的其他数据数组。
     *
     * @param \Illuminate\Http\Request  $request
     * @return array
     */
    public function with($request)
    {
        return [
            'meta' =&gt; [
                'key' =&gt; 'value',
            ],
        ];
    }
}</code></pre>
<h4>构造资源时添加元数据</h4>
<p>你还可以在路由或控制器中构造资源实例时添加顶层数据。所有资源都可以使用 <code>additional</code> 方法来接受应该被添加到资源响应中的数据数组：</p>
<pre><code>return (new UserCollection(User::all()-&gt;load('roles')))
                -&gt;additional(['meta' =&gt; [
                    'key' =&gt; 'value',
                ]]);</code></pre>
<p><a name="resource-responses"></a></p>
<h2>资源响应</h2>
<p>就像你已经知道那样，资源可以直接在路由和控制器中被返回：</p>
<pre><code>use App\User;
use App\Http\Resources\User as UserResource;

Route::get('/user', function () {
    return new UserResource(User::find(1));
});</code></pre>
<p>但是有些时候你可能需要自定义发送给客户端的 HTTP 响应。你有两种选择。第一，你可以在资源上链式调用 <code>response</code> 方法。此方法将返回 <code>Illuminate\Http\Response</code> 实例，允许你自定义响应头信息：</p>
<pre><code>use App\User;
use App\Http\Resources\User as UserResource;

Route::get('/user', function () {
    return (new UserResource(User::find(1)))
                -&gt;response()
                -&gt;header('X-Value', 'True');
});</code></pre>
<p>或者你也可以在资源中定义一个 <code>withResponse</code> 方法。此方法将会在资源被作为顶层资源在响应中返回时被调用：</p>
<pre><code>&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\Resources\Json\Resource;

class User extends Resource
{
    /**
     * 将资源转换成数组。
     *
     * @param  \Illuminate\Http\Request
     * @return array
     */
    public function toArray($request)
    {
        return [
            'id' =&gt; $this-&gt;id,
        ];
    }

    /**
     * 自定义资源响应。
     *
     * @param  \Illuminate\Http\Request
     * @param  \Illuminate\Http\Response
     * @return void
     */
    public function withResponse($request, $response)
    {
        $response-&gt;header('X-Value', 'True');
    }
}</code></pre>
            </div>
        </div>
    </div>
    <div class="col-md-3 col-xl-2" id="toc-list">
        <ul></ul>
    </div>
</div>    </div>
</div>
<span id="back-top">
<svg width="20" height="20" fill="currentColor">
    <use xlink:href="/css/bootstrap-icons.svg#chevron-up"/>
</svg>
</span>
 
<script>
    // 浏览量统计
    $(function () {
        let formdata = new FormData();
        formdata.append('_token', '');
        formdata.append('id', 169);
        $.ajax({
            url: $(".sticky-top .navbar-brand").attr('href') + "/api/doc/clicks",
            type: 'POST',
            data: formdata,
            processData: false,
            contentType: false
        });
    });
    // aside-hidden
    $(function () {
        $('#aside-hidden').on('click', function () {
            $('.aside').toggle(0, function () {
                if ($(this).is(':visible')) {
                    $('.aside-middle').removeClass('col-md-12 col-lg-12').addClass('col-md-9 col-lg-10');
                } else {
                    $('.aside-middle').removeClass('col-md-9 col-lg-10').addClass('col-md-12 col-lg-12');
                }
            });
        });
    });
</script>
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?1522d01c436f59ddc8389f25bfa9d53e";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
</body>
</html>