<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"> 
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"> 
    <meta name="csrf-token" content=""> 
    <title>Laravel Cashier (Braintree) - 开发帮助文档</title> 
    <meta name="keyword" content="braintree"> 
    <meta name="description" content="braintree"> 
    <meta name="author" content="Moments"> 
    <link href="/favicon.ico" rel="shortcut icon"> 
    <link href="/css/blog.css" rel="stylesheet"> 
    <script src="/js/blog.js"></script> 
</head>
<body>
<header class="sticky-top">
    <nav class="navbar navbar-expand navbar-dark bg-secondary justify-content-between text-uppercase">
        <div class="navbar-nav" style="overflow:hidden;">
            <a class="navbar-brand" href="https://help.pythonschool.com">
                <span class="d-md-none">
                    <svg class="text-warning" width="24" height="24" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#emoji-sunglasses"/>
                    </svg>
                </span>
                <span class="d-none d-md-flex">开发帮助文档</span>
            </a>
            <div class="navbar-nav-scroll" style="overflow: hidden;">
                <ul class="navbar-nav text-nowrap pb-4" style="overflow:auto;">
                                            <li class="nav-item">
                            <a class="nav-link active" href="/docs/laravel/index.html">laravel</a>
                        </li>
                                            <li class="nav-item">
                            <a class="nav-link" href="/docs/php/index.html">php</a>
                        </li>
                                    </ul>
            </div>
        </div>
        <div class="d-inline-flex">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="https://github.com/liuhuashi">
                        <svg class="text-light" width="24" height="24" fill="currentColor">
                            <use xlink:href="/css/bootstrap-icons.svg#github"/>
                        </svg>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
</header>
<div class="container-fluid">
    <div id="aside-hidden" class="position-fixed" style="left:0;top: 58px;cursor:pointer;z-index: 10000;">
        <svg class="align-text-bottom text-warning" width="16" height="16" fill="currentColor" stroke="currentColor" stroke-width="1">
            <use xlink:href="/css/bootstrap-icons.svg#arrow-left-square"/>
        </svg>
    </div>
    <div class="row">
        <div class="aside col-md-3 col-lg-2 border-right shadow position-sticky" style="overflow:auto;height: calc(100vh - 58px);padding-bottom: calc(100vh/3);">
    <form class="row border-bottom p-3 bg-white sticky-top">
        <input id="search-version" class="form-control" data-version="5" type="search" placeholder="英文逗号分隔,分词搜索">
    </form>
    <ul class="nav navbar-nav nav-pills flex-column pt-2 figure-caption">
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/about.html" title="Laravel 5.8 中文文档">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 5.8 中文文档
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/api-authentication.html" title="API Authentication">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    API Authentication
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/artisan.html" title="Laravel 的 Artisan 命令行工具">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 Artisan 命令行工具
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/authentication.html" title="Laravel 的用户认证系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的用户认证系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/authorization.html" title="Laravel 的用户授权系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的用户授权系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/billing.html" title="Laravel 的收费系统 Cashier">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的收费系统 Cashier
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/blade.html" title="Laravel 的 Blade 模板引擎">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 Blade 模板引擎
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/braintree.html" title="Laravel Cashier (Braintree)">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Cashier (Braintree)
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/broadcasting.html" title="Laravel 的事件广播系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的事件广播系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/cache.html" title="Laravel 的缓存系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的缓存系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/collections.html" title="Laravel 的集合 Collection">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的集合 Collection
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/configuration.html" title="Laravel 的配置信息">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的配置信息
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/console-tests.html" title="Console Tests">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Console Tests
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/container.html" title="Laravel 服务容器解析">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 服务容器解析
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/contracts.html" title="Laravel 的契约 (Contracts)">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的契约 (Contracts)
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/contributions.html" title="Laravel 源代码贡献指南">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 源代码贡献指南
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/controllers.html" title="Laravel 的 HTTP 控制器">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 HTTP 控制器
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/csrf.html" title="Laravel 下的伪造跨站请求保护 CSRF">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 下的伪造跨站请求保护 CSRF
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/database-testing.html" title="Laravel 测试之 - 数据库测试">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 测试之 - 数据库测试
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/database.html" title="数据库：入门">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    数据库：入门
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/deployment.html" title="Laravel 的部署">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的部署
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/documentation.html" title="主页(Index)">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    主页(Index)
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/dusk.html" title="Laravel 测试之 - 浏览器测试 (Laravel Dusk)">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 测试之 - 浏览器测试 (Laravel Dusk)
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/eloquent-collections.html" title="Eloquent：集合">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent：集合
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/eloquent-mutators.html" title="Eloquent： 修改器">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent： 修改器
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/eloquent-relationships.html" title="Eloquent：关联">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent：关联
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/eloquent-resources.html" title="Eloquent: API 资源">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: API 资源
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/eloquent-serialization.html" title="Eloquent: 序列化">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: 序列化
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/eloquent.html" title="Eloquent: 入门">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: 入门
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/encryption.html" title="Laravel 的加密解密机制">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的加密解密机制
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/envoy.html" title="Laravel 的远程服务器任务处理器 Envoy">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的远程服务器任务处理器 Envoy
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/errors.html" title="Laravel 的错误和日志记录">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的错误和日志记录
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/events.html" title="Laravel 的事件系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的事件系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/facades.html" title="Laravel 的 Facades">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 Facades
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/filesystem.html" title="Laravel 的文件系统和云存储功能集成">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的文件系统和云存储功能集成
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/frontend.html" title="Laravel 的前端资源处理 JavaScript＆CSS 构建">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的前端资源处理 JavaScript＆CSS 构建
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/hashing.html" title="Laravel 的哈希加密">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的哈希加密
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/helpers.html" title="Laravel 的辅助函数列表">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的辅助函数列表
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/homestead.html" title="Laravel 虚拟开发环境 Homestead">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 虚拟开发环境 Homestead
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/horizon.html" title="Laravel 队列监控面板 - Horizon">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 队列监控面板 - Horizon
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/http-tests.html" title="Laravel 测试之：HTTP 测试">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 测试之：HTTP 测试
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/installation.html" title="Laravel 安装指南">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 安装指南
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/license.html" title="license">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    license
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/lifecycle.html" title="Laravel 的请求生命周期">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的请求生命周期
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/localization.html" title="Laravel 的本地化功能">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的本地化功能
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/logging.html" title="Logging">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Logging
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/mail.html" title="Laravel 的 邮件发送功能">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 邮件发送功能
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/middleware.html" title="Laravel 的路由中间件">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的路由中间件
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/migrations.html" title="Laravel 的数据库迁移 Migrations">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的数据库迁移 Migrations
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/mix.html" title="Laravel 的资源任务编译器 Laravel Mix">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的资源任务编译器 Laravel Mix
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/mocking.html" title="Laravel 测试之：测试模拟器">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 测试之：测试模拟器
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/notifications.html" title="Laravel 的消息通知系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的消息通知系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/packages.html" title="Laravel 的扩展插件开发指南">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的扩展插件开发指南
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/pagination.html" title="Laravel 的分页功能">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的分页功能
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/passport.html" title="Laravel 的 API 认证系统 Passport">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 API 认证系统 Passport
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/passwords.html" title="Laravel 的密码重置功能">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的密码重置功能
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/providers.html" title="Laravel 的服务提供器">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的服务提供器
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/queries.html" title="Laravel 数据库之：数据库请求构建器">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 数据库之：数据库请求构建器
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/queues.html" title="Laravel 的队列系统介绍">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的队列系统介绍
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/readme.html" title="Laravel Documentation">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Documentation
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/redirects.html" title="Laravel 的 HTTP 重定向 Redirect">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 HTTP 重定向 Redirect
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/redis.html" title="Laravel 的 Redis 使用指南">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 Redis 使用指南
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/releases.html" title="发行说明">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    发行说明
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/requests.html" title="Laravel 的 HTTP 请求">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 HTTP 请求
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/responses.html" title="Laravel 的请求响应">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的请求响应
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/routing.html" title="Laravel HTTP 路由功能">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel HTTP 路由功能
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/scheduling.html" title="Laravel 的任务调度（计划任务）功能 Task Scheduling">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的任务调度（计划任务）功能 Task Scheduling
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/scout.html" title="Laravel 的搜索系统 Scout">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的搜索系统 Scout
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/seeding.html" title="Laravel 数据库之：数据填充">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 数据库之：数据填充
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/session.html" title="Laravel 的 HTTP 会话机制">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 HTTP 会话机制
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/socialite.html" title="Laravel 的 社会化登录功能">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 社会化登录功能
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/structure.html" title="Laravel 的文件夹结构">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的文件夹结构
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/telescope.html" title="Laravel Telescope">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Telescope
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/testing.html" title="Laravel 测试: 入门指南">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 测试: 入门指南
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/upgrade.html" title="Laravel 升级索引">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 升级索引
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/urls.html" title="Laravel 的 URL 生成">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的 URL 生成
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/valet.html" title="Laravel 的开发环境 Valet">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的开发环境 Valet
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/validation.html" title="Laravel 的表单验证机制详解">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的表单验证机制详解
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/verification.html" title="Email Verification">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Email Verification
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_5.8_zh/views.html" title="Laravel 的视图">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 的视图
                </a>
            </li>
            </ul>
</div>        <div class="aside-middle col-md-9 col-lg-10 row">
    <div class="col-md-9 col-xl-10" style="overflow: auto;height: calc(100vh - 58px);padding-bottom: calc(100vh/3);">
        <div class="container main-h4-1">
            <div class="page-content">
                <h1>Laravel Cashier (Braintree)</h1>
<ul>
<li><a href="#introduction">Introduction</a>
<ul>
<li><a href="#caveats">Caveats</a></li>
</ul></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#configuration">Configuration</a>
<ul>
<li><a href="#plan-credit-coupon">Plan Credit Coupon</a></li>
<li><a href="#database-migrations">Database Migrations</a></li>
<li><a href="#billable-model">Billable Model</a></li>
<li><a href="#api-keys">API Keys</a></li>
<li><a href="#currency-configuration">Currency Configuration</a></li>
</ul></li>
<li><a href="#subscriptions">Subscriptions</a>
<ul>
<li><a href="#creating-subscriptions">Creating Subscriptions</a></li>
<li><a href="#checking-subscription-status">Checking Subscription Status</a></li>
<li><a href="#changing-plans">Changing Plans</a></li>
<li><a href="#subscription-taxes">Subscription Taxes</a></li>
<li><a href="#cancelling-subscriptions">Cancelling Subscriptions</a></li>
<li><a href="#resuming-subscriptions">Resuming Subscriptions</a></li>
</ul></li>
<li><a href="#subscription-trials">Subscription Trials</a>
<ul>
<li><a href="#with-credit-card-up-front">With Credit Card Up Front</a></li>
<li><a href="#without-credit-card-up-front">Without Credit Card Up Front</a></li>
</ul></li>
<li><a href="#customers">Customers</a>
<ul>
<li><a href="#creating-customers">Creating Customers</a></li>
</ul></li>
<li><a href="#cards">Cards</a>
<ul>
<li><a href="#updating-credit-cards">Updating Credit Cards</a></li>
</ul></li>
<li><a href="#handling-webhooks">Handling Webhooks</a>
<ul>
<li><a href="#defining-webhook-event-handlers">Defining Webhook Event Handlers</a></li>
<li><a href="#handling-failed-subscriptions">Failed Subscriptions</a></li>
</ul></li>
<li><a href="#single-charges">Single Charges</a>
<ul>
<li><a href="#simple-charge">Simple Charge</a></li>
<li><a href="#charge-with-invoice">Charge With Invoice</a></li>
</ul></li>
<li><a href="#invoices">Invoices</a>
<ul>
<li><a href="#generating-invoice-pdfs">Generating Invoice PDFs</a></li>
</ul></li>
</ul>
<p><a name="introduction"></a></p>
<h2>Introduction</h2>
<p>Laravel Cashier Braintree provides an expressive, fluent interface to <a href="https://www.braintreepayments.com">Braintree's</a> subscription billing services. It handles almost all of the boilerplate subscription billing code you are dreading writing. In addition to basic subscription management, Cashier can handle coupons, swapping subscription, subscription &quot;quantities&quot;, cancellation grace periods, and even generate invoice PDFs.</p>
<blockquote>
<p>{note} These are the docs for the Cashier integration with Braintree. You may find the Stripe integration docs <a href="/docs/laravel_5.8_zh/billing.html">here</a>.</p>
<p>{note} If you're only performing &quot;one-off&quot; charges and do not offer subscriptions, you should not use Cashier. Instead, use the Braintree SDK directly.</p>
</blockquote>
<p><a name="caveats"></a></p>
<h3>Caveats</h3>
<p>For many operations, the Stripe and Braintree implementations of Cashier function the same. Both services provide subscription billing with credit cards but Braintree also supports payments via PayPal. However, Braintree also lacks some features that are supported by Stripe. You should keep the following in mind when deciding to use Stripe or Braintree:</p>
<div class="content-list">
<ul>
<li>Braintree supports PayPal while Stripe does not.</li>
<li>Braintree does not support the <code>increment</code> and <code>decrement</code> methods on subscriptions. This is a Braintree limitation, not a Cashier limitation.</li>
<li>Braintree does not support percentage based discounts. This is a Braintree limitation, not a Cashier limitation.</li>
</ul>
</div>
<p><a name="installation"></a></p>
<h2>Installation</h2>
<p>First, require the Cashier package for Braintree with Composer:</p>
<pre><code>composer require laravel/cashier-braintree</code></pre>
<p><a name="configuration"></a></p>
<h2>Configuration</h2>
<p><a name="plan-credit-coupon"></a></p>
<h3>Plan Credit Coupon</h3>
<p>Before using Cashier with Braintree, you will need to define a <code>plan-credit</code> discount in your Braintree control panel. This discount will be used to properly prorate subscriptions that change from yearly to monthly billing, or from monthly to yearly billing.</p>
<p>The discount amount configured in the Braintree control panel can be any value you wish, as Cashier will override the defined amount with our own custom amount each time we apply the coupon. This coupon is needed since Braintree does not natively support prorating subscriptions across subscription frequencies.</p>
<p><a name="database-migrations"></a></p>
<h3>Database Migrations</h3>
<p>Before using Cashier, we'll need to <a href="/docs/laravel_5.8_zh/migrations.html">prepare the database</a>. We need to add several columns to your <code>users</code> table and create a new <code>subscriptions</code> table to hold all of our customer's subscriptions:</p>
<pre><code>Schema::table('users', function ($table) {
    $table-&gt;string('braintree_id')-&gt;nullable();
    $table-&gt;string('paypal_email')-&gt;nullable();
    $table-&gt;string('card_brand')-&gt;nullable();
    $table-&gt;string('card_last_four')-&gt;nullable();
    $table-&gt;timestamp('trial_ends_at')-&gt;nullable();
});

Schema::create('subscriptions', function ($table) {
    $table-&gt;increments('id');
    $table-&gt;unsignedInteger('user_id');
    $table-&gt;string('name');
    $table-&gt;string('braintree_id');
    $table-&gt;string('braintree_plan');
    $table-&gt;integer('quantity');
    $table-&gt;timestamp('trial_ends_at')-&gt;nullable();
    $table-&gt;timestamp('ends_at')-&gt;nullable();
    $table-&gt;timestamps();
});</code></pre>
<p>Once the migrations have been created, run the <code>migrate</code> Artisan command.</p>
<p><a name="billable-model"></a></p>
<h3>Billable Model</h3>
<p>Next, add the <code>Billable</code> trait to your model definition:</p>
<pre><code>use Laravel\Cashier\Billable;

class User extends Authenticatable
{
    use Billable;
}</code></pre>
<p><a name="api-keys"></a></p>
<h3>API Keys</h3>
<p>Next, you should configure the following options in your <code>services.php</code> file:</p>
<pre><code>'braintree' =&gt; [
    'model'  =&gt; App\User::class,
    'environment' =&gt; env('BRAINTREE_ENV'),
    'merchant_id' =&gt; env('BRAINTREE_MERCHANT_ID'),
    'public_key' =&gt; env('BRAINTREE_PUBLIC_KEY'),
    'private_key' =&gt; env('BRAINTREE_PRIVATE_KEY'),
],</code></pre>
<p>Then you should add the following Braintree SDK calls to your <code>AppServiceProvider</code> service provider's <code>boot</code> method:</p>
<pre><code>\Braintree_Configuration::environment(config('services.braintree.environment'));
\Braintree_Configuration::merchantId(config('services.braintree.merchant_id'));
\Braintree_Configuration::publicKey(config('services.braintree.public_key'));
\Braintree_Configuration::privateKey(config('services.braintree.private_key'));</code></pre>
<p><a name="currency-configuration"></a></p>
<h3>Currency Configuration</h3>
<p>The default Cashier currency is United States Dollars (USD). You can change the default currency by calling the <code>Cashier::useCurrency</code> method from within the <code>boot</code> method of one of your service providers. The <code>useCurrency</code> method accepts two string parameters: the currency and the currency's symbol:</p>
<pre><code>use Laravel\Cashier\Cashier;

Cashier::useCurrency('eur', '€');</code></pre>
<p><a name="subscriptions"></a></p>
<h2>Subscriptions</h2>
<p><a name="creating-subscriptions"></a></p>
<h3>Creating Subscriptions</h3>
<p>To create a subscription, first retrieve an instance of your billable model, which typically will be an instance of <code>App\User</code>. Once you have retrieved the model instance, you may use the <code>newSubscription</code> method to create the model's subscription:</p>
<pre><code>$user = User::find(1);

$user-&gt;newSubscription('main', 'premium')-&gt;create($token);</code></pre>
<p>The first argument passed to the <code>newSubscription</code> method should be the name of the subscription. If your application only offers a single subscription, you might call this <code>main</code> or <code>primary</code>. The second argument is the specific plan the user is subscribing to. This value should correspond to the plan's identifier in Braintree.</p>
<p>The <code>create</code> method, which accepts a credit card / source token, will begin the subscription as well as update your database with the customer ID and other relevant billing information.</p>
<h4>Additional User Details</h4>
<p>If you would like to specify additional customer details, you may do so by passing them as the second argument to the <code>create</code> method:</p>
<pre><code>$user-&gt;newSubscription('main', 'monthly')-&gt;create($token, [
    'email' =&gt; $email,
]);</code></pre>
<p>To learn more about the additional fields supported by Braintree, check out the corresponding <a href="https://developers.braintreepayments.com/reference/request/customer/create/php">Braintree documentation</a>.</p>
<h4>Coupons</h4>
<p>If you would like to apply a coupon when creating the subscription, you may use the <code>withCoupon</code> method:</p>
<pre><code>$user-&gt;newSubscription('main', 'monthly')
     -&gt;withCoupon('code')
     -&gt;create($token);</code></pre>
<p><a name="checking-subscription-status"></a></p>
<h3>Checking Subscription Status</h3>
<p>Once a user is subscribed to your application, you may easily check their subscription status using a variety of convenient methods. First, the <code>subscribed</code> method returns <code>true</code> if the user has an active subscription, even if the subscription is currently within its trial period:</p>
<pre><code>if ($user-&gt;subscribed('main')) {
    //
}</code></pre>
<p>The <code>subscribed</code> method also makes a great candidate for a <a href="/docs/laravel_5.8_zh/middleware.html">route middleware</a>, allowing you to filter access to routes and controllers based on the user's subscription status:</p>
<pre><code>public function handle($request, Closure $next)
{
    if ($request-&gt;user() &amp;&amp; ! $request-&gt;user()-&gt;subscribed('main')) {
        // This user is not a paying customer...
        return redirect('billing');
    }

    return $next($request);
}</code></pre>
<p>If you would like to determine if a user is still within their trial period, you may use the <code>onTrial</code> method. This method can be useful for displaying a warning to the user that they are still on their trial period:</p>
<pre><code>if ($user-&gt;subscription('main')-&gt;onTrial()) {
    //
}</code></pre>
<p>The <code>subscribedToPlan</code> method may be used to determine if the user is subscribed to a given plan based on a given plan ID. In this example, we will determine if the user's <code>main</code> subscription is actively subscribed to the <code>monthly</code> plan:</p>
<pre><code>if ($user-&gt;subscribedToPlan('monthly', 'main')) {
    //
}</code></pre>
<p>The <code>recurring</code> method may be used to determine if the user is currently subscribed and is no longer within their trail period:</p>
<pre><code>if ($user-&gt;subscription('main')-&gt;recurring()) {
    //
}</code></pre>
<h4>Cancelled Subscription Status</h4>
<p>To determine if the user was once an active subscriber, but has cancelled their subscription, you may use the <code>cancelled</code> method:</p>
<pre><code>if ($user-&gt;subscription('main')-&gt;cancelled()) {
    //
}</code></pre>
<p>You may also determine if a user has cancelled their subscription, but are still on their &quot;grace period&quot; until the subscription fully expires. For example, if a user cancels a subscription on March 5th that was originally scheduled to expire on March 10th, the user is on their &quot;grace period&quot; until March 10th. Note that the <code>subscribed</code> method still returns <code>true</code> during this time:</p>
<pre><code>if ($user-&gt;subscription('main')-&gt;onGracePeriod()) {
    //
}</code></pre>
<p>To determine if the user has cancelled their subscription is no longer within their &quot;grace period&quot;, you may use the <code>ended</code> method:</p>
<pre><code>if ($user-&gt;subscription('main')-&gt;ended()) {
    //
}</code></pre>
<p><a name="changing-plans"></a></p>
<h3>Changing Plans</h3>
<p>After a user is subscribed to your application, they may occasionally want to change to a new subscription plan. To swap a user to a new subscription, pass the plan's identifier to the <code>swap</code> method:</p>
<pre><code>$user = App\User::find(1);

$user-&gt;subscription('main')-&gt;swap('provider-plan-id');</code></pre>
<p>If the user is on trial, the trial period will be maintained. Also, if a &quot;quantity&quot; exists for the subscription, that quantity will also be maintained.</p>
<p>If you would like to swap plans and cancel any trial period the user is currently on, you may use the <code>skipTrial</code> method:</p>
<pre><code>$user-&gt;subscription('main')
        -&gt;skipTrial()
        -&gt;swap('provider-plan-id');</code></pre>
<p><a name="subscription-taxes"></a></p>
<h3>Subscription Taxes</h3>
<p>To specify the tax percentage a user pays on a subscription, implement the <code>taxPercentage</code> method on your billable model, and return a numeric value between 0 and 100, with no more than 2 decimal places.</p>
<pre><code>public function taxPercentage()
{
    return 20;
}</code></pre>
<p>The <code>taxPercentage</code> method enables you to apply a tax rate on a model-by-model basis, which may be helpful for a user base that spans multiple countries and tax rates.</p>
<blockquote>
<p>{note} The <code>taxPercentage</code> method only applies to subscription charges. If you use Cashier to make &quot;one off&quot; charges, you will need to manually specify the tax rate at that time.</p>
</blockquote>
<p><a name="cancelling-subscriptions"></a></p>
<h3>Cancelling Subscriptions</h3>
<p>To cancel a subscription, call the <code>cancel</code> method on the user's subscription:</p>
<pre><code>$user-&gt;subscription('main')-&gt;cancel();</code></pre>
<p>When a subscription is cancelled, Cashier will automatically set the <code>ends_at</code> column in your database. This column is used to know when the <code>subscribed</code> method should begin returning <code>false</code>. For example, if a customer cancels a subscription on March 1st, but the subscription was not scheduled to end until March 5th, the <code>subscribed</code> method will continue to return <code>true</code> until March 5th.</p>
<p>You may determine if a user has cancelled their subscription but are still on their &quot;grace period&quot; using the <code>onGracePeriod</code> method:</p>
<pre><code>if ($user-&gt;subscription('main')-&gt;onGracePeriod()) {
    //
}</code></pre>
<p>If you wish to cancel a subscription immediately, call the <code>cancelNow</code> method on the user's subscription:</p>
<pre><code>$user-&gt;subscription('main')-&gt;cancelNow();</code></pre>
<p><a name="resuming-subscriptions"></a></p>
<h3>Resuming Subscriptions</h3>
<p>If a user has cancelled their subscription and you wish to resume it, use the <code>resume</code> method. The user <strong>must</strong> still be on their grace period in order to resume a subscription:</p>
<pre><code>$user-&gt;subscription('main')-&gt;resume();</code></pre>
<p>If the user cancels a subscription and then resumes that subscription before the subscription has fully expired, they will not be billed immediately. Instead, their subscription will be re-activated, and they will be billed on the original billing cycle.</p>
<p><a name="subscription-trials"></a></p>
<h2>Subscription Trials</h2>
<p><a name="with-credit-card-up-front"></a></p>
<h3>With Credit Card Up Front</h3>
<p>If you would like to offer trial periods to your customers while still collecting payment method information up front, you should use the <code>trialDays</code> method when creating your subscriptions:</p>
<pre><code>$user = User::find(1);

$user-&gt;newSubscription('main', 'monthly')
            -&gt;trialDays(10)
            -&gt;create($token);</code></pre>
<p>This method will set the trial period ending date on the subscription record within the database, as well as instruct Braintree to not begin billing the customer until after this date.</p>
<blockquote>
<p>{note} If the customer's subscription is not cancelled before the trial ending date they will be charged as soon as the trial expires, so you should be sure to notify your users of their trial ending date.</p>
</blockquote>
<p>You may determine if the user is within their trial period using either the <code>onTrial</code> method of the user instance, or the <code>onTrial</code> method of the subscription instance. The two examples below are identical:</p>
<pre><code>if ($user-&gt;onTrial('main')) {
    //
}

if ($user-&gt;subscription('main')-&gt;onTrial()) {
    //
}</code></pre>
<p><a name="without-credit-card-up-front"></a></p>
<h3>Without Credit Card Up Front</h3>
<p>If you would like to offer trial periods without collecting the user's payment method information up front, you may set the <code>trial_ends_at</code> column on the user record to your desired trial ending date. This is typically done during user registration:</p>
<pre><code>$user = User::create([
    // Populate other user properties...
    'trial_ends_at' =&gt; now()-&gt;addDays(10),
]);</code></pre>
<blockquote>
<p>{note}  Be sure to add a <a href="/docs/laravel_5.8_zh/eloquent-mutators.html#date-mutators">date mutator</a> for <code>trial_ends_at</code> to your model definition.</p>
</blockquote>
<p>Cashier refers to this type of trial as a &quot;generic trial&quot;, since it is not attached to any existing subscription. The <code>onTrial</code> method on the <code>User</code> instance will return <code>true</code> if the current date is not past the value of <code>trial_ends_at</code>:</p>
<pre><code>if ($user-&gt;onTrial()) {
    // User is within their trial period...
}</code></pre>
<p>You may also use the <code>onGenericTrial</code> method if you wish to know specifically that the user is within their &quot;generic&quot; trial period and has not created an actual subscription yet:</p>
<pre><code>if ($user-&gt;onGenericTrial()) {
    // User is within their "generic" trial period...
}</code></pre>
<p>Once you are ready to create an actual subscription for the user, you may use the <code>newSubscription</code> method as usual:</p>
<pre><code>$user = User::find(1);

$user-&gt;newSubscription('main', 'monthly')-&gt;create($token);</code></pre>
<p><a name="customers"></a></p>
<h2>Customers</h2>
<p><a name="creating-customers"></a></p>
<h3>Creating Customers</h3>
<p>Occasionally, you may wish to create a Braintree customer without beginning a subscription. You may accomplish this using the <code>createAsBraintreeCustomer</code> method:</p>
<pre><code>$user-&gt;createAsBraintreeCustomer();</code></pre>
<p>Once the customer has been created in Braintree, you may begin a subscription at a later date.</p>
<p><a name="cards"></a></p>
<h2>Cards</h2>
<p><a name="updating-credit-cards"></a></p>
<h3>Updating Credit Cards</h3>
<p>The <code>updateCard</code> method may be used to update a customer's credit card information. This method accepts a Braintree token and will assign the new credit card as the default billing source:</p>
<pre><code>$user-&gt;updateCard($token);</code></pre>
<p><a name="handling-webhooks"></a></p>
<h2>Handling Webhooks</h2>
<p>Braintree can notify your application of a variety of events via webhooks. To handle webhooks, define a route that points to Cashier's webhook controller. This controller will handle all incoming webhook requests and dispatch them to the proper controller method:</p>
<pre><code>Route::post(
    'braintree/webhook',
    '\Laravel\Cashier\Http\Controllers\WebhookController@handleWebhook'
);</code></pre>
<blockquote>
<p>{note} Once you have registered your route, be sure to configure the webhook URL in your Braintree control panel settings.</p>
</blockquote>
<p>By default, this controller will automatically handle cancelling subscriptions that have too many failed charges (as defined by your Braintree settings); however, as we'll soon discover, you can extend this controller to handle any webhook event you like.</p>
<h4>Webhooks &amp; CSRF Protection</h4>
<p>Since webhooks need to bypass Laravel's <a href="/docs/laravel_5.8_zh/csrf.html">CSRF protection</a>, be sure to list the URI as an exception in your <code>VerifyCsrfToken</code> middleware or list the route outside of the <code>web</code> middleware group:</p>
<pre><code>protected $except = [
    'braintree/*',
];</code></pre>
<p><a name="defining-webhook-event-handlers"></a></p>
<h3>Defining Webhook Event Handlers</h3>
<p>Cashier automatically handles subscription cancellation on failed charges, but if you have additional webhook events you would like to handle, extend the Webhook controller. Your method names should correspond to Cashier's expected convention, specifically, methods should be prefixed with <code>handle</code> and the &quot;camel case&quot; name of the webhook you wish to handle. For example, if you wish to handle the <code>dispute_opened</code> webhook, you should add a <code>handleDisputeOpened</code> method to the controller:</p>
<pre><code>&lt;?php

namespace App\Http\Controllers;

use Braintree\WebhookNotification;
use Laravel\Cashier\Http\Controllers\WebhookController as CashierController;

class WebhookController extends CashierController
{
    /**
     * Handle a new dispute.
     *
     * @param  \Braintree\WebhookNotification  $webhook
     * @return \Symfony\Component\HttpFoundation\Responses
     */
    public function handleDisputeOpened(WebhookNotification $webhook)
    {
        // Handle The Webhook...
    }
}</code></pre>
<p><a name="handling-failed-subscriptions"></a></p>
<h3>Failed Subscriptions</h3>
<p>What if a customer's credit card expires? No worries - Cashier includes a Webhook controller that can easily cancel the customer's subscription for you. Just point a route to the controller:</p>
<pre><code>Route::post(
    'braintree/webhook',
    '\Laravel\Cashier\Http\Controllers\WebhookController@handleWebhook'
);</code></pre>
<p>That's it! Failed payments will be captured and handled by the controller. The controller will cancel the customer's subscription when Braintree determines the subscription has failed (normally after three failed payment attempts). Don't forget: you will need to configure the webhook URI in your Braintree control panel settings.</p>
<p><a name="single-charges"></a></p>
<h2>Single Charges</h2>
<p><a name="simple-charge"></a></p>
<h3>Simple Charge</h3>
<blockquote>
<p>{note} You should pass the full dollar amount to the <code>charge</code> method:</p>
</blockquote>
<p>If you would like to make a &quot;one off&quot; charge against a subscribed customer's credit card, you may use the <code>charge</code> method on a billable model instance.</p>
<pre><code>$user-&gt;charge(1);</code></pre>
<p>The <code>charge</code> method accepts an array as its second argument, allowing you to pass any options you wish to the underlying charge creation. Consult the Braintree documentation regarding the options available to you when creating charges:</p>
<pre><code>$user-&gt;charge(1, [
    'custom_option' =&gt; $value,
]);</code></pre>
<p>The <code>charge</code> method will throw an exception if the charge fails. If the charge is successful, the full Braintree response will be returned from the method:</p>
<pre><code>try {
    $response = $user-&gt;charge(1);
} catch (Exception $e) {
    //
}</code></pre>
<p><a name="charge-with-invoice"></a></p>
<h3>Charge With Invoice</h3>
<p>Sometimes you may need to make a one-time charge but also generate an invoice for the charge so that you may offer a PDF receipt to your customer. The <code>invoiceFor</code> method lets you do just that. For example, let's invoice the customer $5.00 for a &quot;One Time Fee&quot;:</p>
<pre><code>$user-&gt;invoiceFor('One Time Fee', 5);</code></pre>
<p>The invoice will be charged immediately against the user's credit card. The <code>invoiceFor</code> method also accepts an array as its third argument. This array contains the billing options for the invoice item. You must include a <code>description</code> option when calling the <code>invoiceFor</code> method:</p>
<pre><code>$user-&gt;invoiceFor('One Time Fee', 5, [
    'description' =&gt; 'your invoice description here',
]);</code></pre>
<p><a name="invoices"></a></p>
<h2>Invoices</h2>
<p>You may easily retrieve an array of a billable model's invoices using the <code>invoices</code> method:</p>
<pre><code>$invoices = $user-&gt;invoices();

// Include pending invoices in the results...
$invoices = $user-&gt;invoicesIncludingPending();</code></pre>
<p>When listing the invoices for the customer, you may use the invoice's helper methods to display the relevant invoice information. For example, you may wish to list every invoice in a table, allowing the user to easily download any of them:</p>
<pre><code>&lt;table&gt;
    @foreach ($invoices as $invoice)
        &lt;tr&gt;
            &lt;td&gt;{{ $invoice-&gt;date()-&gt;toFormattedDateString() }}&lt;/td&gt;
            &lt;td&gt;{{ $invoice-&gt;total() }}&lt;/td&gt;
            &lt;td&gt;&lt;a href="/user/invoice/{{ $invoice-&gt;id }}"&gt;Download&lt;/a&gt;&lt;/td&gt;
        &lt;/tr&gt;
    @endforeach
&lt;/table&gt;</code></pre>
<p><a name="generating-invoice-pdfs"></a></p>
<h3>Generating Invoice PDFs</h3>
<p>From within a route or controller, use the <code>downloadInvoice</code> method to generate a PDF download of the invoice. This method will automatically generate the proper HTTP response to send the download to the browser:</p>
<pre><code>use Illuminate\Http\Request;

Route::get('user/invoice/{invoice}', function (Request $request, $invoiceId) {
    return $request-&gt;user()-&gt;downloadInvoice($invoiceId, [
        'vendor'  =&gt; 'Your Company',
        'product' =&gt; 'Your Product',
    ]);
});</code></pre>
            </div>
        </div>
    </div>
    <div class="col-md-3 col-xl-2" id="toc-list">
        <ul></ul>
    </div>
</div>    </div>
</div>
<span id="back-top">
<svg width="20" height="20" fill="currentColor">
    <use xlink:href="/css/bootstrap-icons.svg#chevron-up"/>
</svg>
</span>
 
<script>
    // 浏览量统计
    $(function () {
        let formdata = new FormData();
        formdata.append('_token', '');
        formdata.append('id', 150);
        $.ajax({
            url: $(".sticky-top .navbar-brand").attr('href') + "/api/doc/clicks",
            type: 'POST',
            data: formdata,
            processData: false,
            contentType: false
        });
    });
    // aside-hidden
    $(function () {
        $('#aside-hidden').on('click', function () {
            $('.aside').toggle(0, function () {
                if ($(this).is(':visible')) {
                    $('.aside-middle').removeClass('col-md-12 col-lg-12').addClass('col-md-9 col-lg-10');
                } else {
                    $('.aside-middle').removeClass('col-md-9 col-lg-10').addClass('col-md-12 col-lg-12');
                }
            });
        });
    });
</script>
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?1522d01c436f59ddc8389f25bfa9d53e";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
</body>
</html>