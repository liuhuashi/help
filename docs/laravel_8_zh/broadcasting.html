<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"> 
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"> 
    <meta name="csrf-token" content=""> 
    <title>广播系统 - 开发帮助文档</title> 
    <meta name="keyword" content="broadcasting"> 
    <meta name="description" content="broadcasting"> 
    <meta name="author" content="Moments"> 
    <link href="/favicon.ico" rel="shortcut icon"> 
    <link href="/css/blog.css" rel="stylesheet"> 
    <script src="/js/blog.js"></script> 
</head>
<body>
<header class="sticky-top">
    <nav class="navbar navbar-expand navbar-dark bg-secondary justify-content-between text-uppercase">
        <div class="navbar-nav" style="overflow:hidden;">
            <a class="navbar-brand" href="https://help.pythonschool.com">
                <span class="d-md-none">
                    <svg class="text-warning" width="24" height="24" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#emoji-sunglasses"/>
                    </svg>
                </span>
                <span class="d-none d-md-flex">开发帮助文档</span>
            </a>
            <div class="navbar-nav-scroll" style="overflow: hidden;">
                <ul class="navbar-nav text-nowrap pb-4" style="overflow:auto;">
                                            <li class="nav-item">
                            <a class="nav-link active" href="/docs/laravel/index.html">laravel</a>
                        </li>
                                            <li class="nav-item">
                            <a class="nav-link" href="/docs/php/index.html">php</a>
                        </li>
                                    </ul>
            </div>
        </div>
        <div class="d-inline-flex">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="https://github.com/liuhuashi">
                        <svg class="text-light" width="24" height="24" fill="currentColor">
                            <use xlink:href="/css/bootstrap-icons.svg#github"/>
                        </svg>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
</header>
<div class="container-fluid">
    <div id="aside-hidden" class="position-fixed" style="left:0;top: 58px;cursor:pointer;z-index: 10000;">
        <svg class="align-text-bottom text-warning" width="16" height="16" fill="currentColor" stroke="currentColor" stroke-width="1">
            <use xlink:href="/css/bootstrap-icons.svg#arrow-left-square"/>
        </svg>
    </div>
    <div class="row">
        <div class="aside col-md-3 col-lg-2 border-right shadow position-sticky" style="overflow:auto;height: calc(100vh - 58px);padding-bottom: calc(100vh/3);">
    <form class="row border-bottom p-3 bg-white sticky-top">
        <input id="search-version" class="form-control" data-version="7" type="search" placeholder="英文逗号分隔,分词搜索">
    </form>
    <ul class="nav navbar-nav nav-pills flex-column pt-2 figure-caption">
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/artisan.html" title="Artisan 命令行">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Artisan 命令行
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/authentication.html" title="用户认证">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    用户认证
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/authorization.html" title="用户授权">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    用户授权
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/blade.html" title="Blade 模板">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Blade 模板
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/broadcasting.html" title="广播系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    广播系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/cache.html" title="缓存系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    缓存系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/collections.html" title="集合">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    集合
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/configuration.html" title="Configuration">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Configuration
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/console-tests.html" title="控制台测试">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    控制台测试
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/container.html" title="服务容器">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    服务容器
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/contracts.html" title="契约">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    契约
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/contributions.html" title="贡献导引">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    贡献导引
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/controllers.html" title="Controllers">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Controllers
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/csrf.html" title="CSRF 保护">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    CSRF 保护
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/database-testing.html" title="数据库测试">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    数据库测试
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/database.html" title="数据库: 入门">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    数据库: 入门
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/deployment.html" title="部署">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    部署
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/documentation.html" title="前言">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    前言
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/dusk.html" title="Laravel Dusk">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Dusk
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/eloquent-collections.html" title="Eloquent: 集合">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: 集合
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/eloquent-mutators.html" title="Eloquent: 修改器">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: 修改器
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/eloquent-relationships.html" title="Eloquent: 关联">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: 关联
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/eloquent-resources.html" title="Eloquent: API 资源">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: API 资源
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/eloquent-serialization.html" title="Eloquent: 序列化">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: 序列化
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/eloquent.html" title="Eloquent: 入门">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: 入门
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/encryption.html" title="加密解密">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    加密解密
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/envoy.html" title="Laravel Envoy">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Envoy
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/errors.html" title="错误处理">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    错误处理
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/events.html" title="事件系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    事件系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/facades.html" title="Facades">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Facades
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/filesystem.html" title="File Storage">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    File Storage
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/frontend.html" title="JavaScript &amp; CSS 脚手架">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    JavaScript &amp; CSS 脚手架
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/hashing.html" title="哈希加密">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    哈希加密
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/helpers.html" title="辅助函数">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    辅助函数
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/homestead.html" title="Laravel Homestead">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Homestead
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/horizon.html" title="Laravel Horizon">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Horizon
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/http-client.html" title="HTTP 客户端">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    HTTP 客户端
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/http-tests.html" title="HTTP Tests">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    HTTP Tests
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/installation.html" title="安装">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    安装
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/lifecycle.html" title="请求生命周期">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    请求生命周期
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/localization.html" title="本地化">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    本地化
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/logging.html" title="日志">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    日志
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/mail.html" title="邮件发送">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    邮件发送
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/middleware.html" title="中间件">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    中间件
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/migrations.html" title="数据库：迁移">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    数据库：迁移
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/mix.html" title="编辑资源 (Mix)">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    编辑资源 (Mix)
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/mocking.html" title="Mocking">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Mocking
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/notifications.html" title="消息通知">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    消息通知
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/packages.html" title="Package Development">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Package Development
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/pagination.html" title="数据库: 分页">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    数据库: 分页
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/passport.html" title="Laravel Passport">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Passport
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/passwords.html" title="重置密码">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    重置密码
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/providers.html" title="服务提供者">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    服务提供者
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/queries.html" title="数据库：查询构造器">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    数据库：查询构造器
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/queues.html" title="队列">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    队列
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/redis.html" title="Redis">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Redis
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/releases.html" title="发行说明">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    发行说明
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/requests.html" title="HTTP 请求">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    HTTP 请求
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/responses.html" title="HTTP Responses">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    HTTP Responses
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/routing.html" title="路由">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    路由
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/sail.html" title="Laravel Sail">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Sail
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/sanctum.html" title="Laravel Sanctum">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Sanctum
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/scheduling.html" title="任务调度">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    任务调度
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/scout.html" title="Laravel Scout">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Scout
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/seeding.html" title="数据库：填充">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    数据库：填充
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/session.html" title="HTTP 会话机制">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    HTTP 会话机制
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/socialite.html" title="Laravel 社会化登录">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 社会化登录
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/structure.html" title="目录结构">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    目录结构
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/telescope.html" title="Laravel Telescope">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Telescope
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/testing.html" title="测试：入门指南">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    测试：入门指南
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/upgrade.html" title="升级指南">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    升级指南
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/urls.html" title="生成 URL">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    生成 URL
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/valet.html" title="Laravel Valet">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Valet
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/validation.html" title="表单验证">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    表单验证
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/verification.html" title="Email 认证">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Email 认证
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/views.html" title="视图">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    视图
                </a>
            </li>
            </ul>
</div>        <div class="aside-middle col-md-9 col-lg-10 row">
    <div class="col-md-9 col-xl-10" style="overflow: auto;height: calc(100vh - 58px);padding-bottom: calc(100vh/3);">
        <div class="container main-h4-1">
            <div class="page-content">
                <h1>广播系统</h1>
<ul>
<li><a href="#introduction">简介</a>
<ul>
<li><a href="#configuration">配置</a></li>
<li><a href="#driver-prerequisites">对驱动的要求</a></li>
</ul></li>
<li><a href="#concept-overview">概念综述</a>
<ul>
<li><a href="#using-example-application">使用示例程序</a></li>
</ul></li>
<li><a href="#defining-broadcast-events">定义广播事件</a>
<ul>
<li><a href="#broadcast-name">广播名称</a></li>
<li><a href="#broadcast-data">广播数据</a></li>
<li><a href="#broadcast-queue">广播队列</a></li>
<li><a href="#broadcast-conditions">广播条件</a></li>
</ul></li>
<li><a href="#authorizing-channels">授权频道</a>
<ul>
<li><a href="#defining-authorization-routes">定义授权路由</a></li>
<li><a href="#defining-authorization-callbacks">定义授权回调</a></li>
<li><a href="#defining-channel-classes">定义频道类</a></li>
</ul></li>
<li><a href="#broadcasting-events">广播事件</a>
<ul>
<li><a href="#only-to-others">只广播给他人</a></li>
</ul></li>
<li><a href="#receiving-broadcasts">接收广播</a>
<ul>
<li><a href="#installing-laravel-echo">安装 Laravel Echo</a></li>
<li><a href="#listening-for-events">对事件进行监听</a></li>
<li><a href="#leaving-a-channel">退出频道</a></li>
<li><a href="#namespaces">命名空间</a></li>
</ul></li>
<li><a href="#presence-channels">Presence 频道</a>
<ul>
<li><a href="#authorizing-presence-channels">授权 Presence 频道</a></li>
<li><a href="#joining-presence-channels">加入 Presence 频道</a></li>
<li><a href="#broadcasting-to-presence-channels">广播到 Presence 频道</a></li>
</ul></li>
<li><a href="#client-events">客户端事件</a></li>
<li><a href="#notifications">消息通知</a></li>
</ul>
<p><a name="introduction"></a></p>
<h2>简介</h2>
<p>在现代的 web 应用程序中， WebSockets 被用来实现实时、即时更新的用户接口。当服务器上的数据更新后，更新信息会通过 WebSocket 连接发送到客户端等待处理。相比于不停地轮询应用程序，这是一种更加可靠和高效的选择。</p>
<p>为了帮助你构建这类应用， Laravel 将通过 WebSocket 连接来使广播事件变得更加轻松。 广播 Laravel 事件允许你在服务端和客户端 JavaScript 应用程序间共享相同的事件名。</p>
<blockquote>
<p>{注} 在深入了解事件广播之前，请确认你已阅读所有关于 Laravel <a href="/docs/laravel_8_zh/events.html">事件和监听器</a> 的文档。</p>
</blockquote>
<p><a name="configuration"></a></p>
<h3>配置</h3>
<p>所有关于事件广播的配置都保存在 <code>config/broadcasting.php</code> 所有关于事件广播的配置都保存在 config/broadcasting.php 配置文件中。 Laravel 自带了几个广播驱动： <a href="https://pusher.com/channels">Pusher Channels</a>, <a href="/docs/laravel_8_zh/redis.html">Redis</a>， 和一个用于本地开发与调试的 <code>log</code> 驱动。另外，还有一个 <code>null</code> 驱动允许你完全关闭广播系统。每一个驱动的示例配置都可以在 <code>config/broadcasting.php</code> 配置文件中找到。</p>
<h4>对驱动的要求</h4>
<p>在对事件进行广播之前，你必须先注册 <code>App\Providers\BroadcastServiceProvider</code> 。对于一个新建的 Laravel 应用程序，你只需要在 <code>config/app.php</code> 配置文件的 <code>providers</code> 数组中取消对该提供者的注释即可。 该提供者将允许你注册广播授权路由和回调。</p>
<h4>CSRF 令牌</h4>
<p><a href="#installing-laravel-echo">Laravel Echo</a> 需要访问当前会话的 CSRF 令牌。你应当验证你的应用程序的 <code>head</code> HTML 元素是否定义了包含 CSRF 令牌的 <code>meta</code> 标签：</p>
<pre><code>&lt;meta name="csrf-token" content="{{ csrf_token() }}"&gt;</code></pre>
<p><a name="driver-prerequisites"></a></p>
<h3>对驱动的要求</h3>
<h4>Pusher</h4>
<p>如果你使用 <a href="https://pusher.com/channels">Pusher</a>来对事件进行广播，请用 Composer 包管理器来安装 Pusher Channels PHP SDK ：</p>
<pre><code>composer require pusher/pusher-php-server "~4.0"</code></pre>
<p>然后，你需要在 <code>config/broadcasting.php</code> 配置文件中配置你的 Pusher 证书。该文件中已经包含了一个 Pusher 示例配置，你可以快速地指定你的 <code>Pusher key</code> ,  <code>secret</code> ，和 <code>application ID</code>。  <code>config/broadcasting.php</code> 文件的 <code>pusher</code> 配置项同时也允许你指定 Pusher 支持的额外 <code>options</code> ，例如 <code>cluster</code> ：</p>
<pre><code>'options' =&gt; [
    'cluster' =&gt; 'eu',
    'useTLS' =&gt; true
],</code></pre>
<p>当 <code>Channels</code> 和 <a href="#installing-laravel-echo"><code>Laravel Echo</code></a> 一起使用时，你应该在 <code>resources/js/bootstrap.js</code> 文件中实例化 Echo 对象时指定 <code>pusher</code> 作为所需要的 <code>broadcaster</code> ：</p>
<pre><code>import Echo from "laravel-echo";

window.Pusher = require('pusher-js');

window.Echo = new Echo({
    broadcaster: 'pusher',
    key: 'your-pusher-channels-key'
});</code></pre>
<p>最后，你需要在 <code>.env</code> 文件中将广播驱动更改为 <code>pusher</code> ：</p>
<pre><code>BROADCAST_DRIVER=pusher</code></pre>
<h4>与Pusher兼容的 Laravel Websockets</h4>
<p><a href="https://github.com/beyondcode/laravel-websockets">laravel-websockets</a> 是适用于Laravel的纯PHP，与Pusher兼容的websocket软件包。 该软件包使您无需外部Websocket提供商或Node即可充分利用Laravel广播的全部功能。 有关安装和使用此软件包的更多信息，请查阅其<a href="https://beyondco.de/docs/laravel-websockets">官方文档</a>。</p>
<h4>Redis</h4>
<p>如果你使用 Redis 广播器，请通过PECL安装 redis 扩展和安装 Predis 库：</p>
<pre><code>composer require predis/predis</code></pre>
<p>然后，你应该在你的 <code>.env</code> 文件中将广播驱动更改为 <code>redis</code> ：</p>
<pre><code>BROADCAST_DRIVER=redis</code></pre>
<p>Redis 广播器会使用 Redis 的 发布 / 订阅 特性来广播消息；尽管如此，你仍需将它与能够从 Redis 接收消息的 WebSocket 服务器配对使用以便将消息广播到你的 WebSocket 频道上去。</p>
<p>当 Redis 广播器发布一个事件的时候，该事件会被发布到它指定的频道上去，传输的数据是一个采用 JSON 编码的字符串。该字符串包含了事件名、 <code>data</code> 数据和生成该事件 socket ID 的用户（如果可用的话）。</p>
<h4>Socket.IO</h4>
<p>如果你想将 Redis 广播器 和 Socket.IO 服务器进行配对，你需要在你的应用程序中引入 Socket.IO JavaScript 客户端库。你可以通过 NPM 包管理器进行安装：</p>
<pre><code>npm install --save socket.io-client</code></pre>
<p>然后，你需要在实例化 Echo 时指定 <code>socket.io</code> 连接器和 <code>host</code>  。</p>
<pre><code>import Echo from "laravel-echo"

window.io = require('socket.io-client');

window.Echo = new Echo({
    broadcaster: 'socket.io',
    host: window.location.hostname + ':6001'
});</code></pre>
<p>最后，你需要运行一个与 Laravel 兼容的 Socket.IO 服务器。 Laravel 官方并没有内置 Socket.IO 服务器实现；不过，可以选择一个由社区驱动维护的项目 <a href="https://github.com/tlaverdure/laravel-echo-server">tlaverdure/laravel-echo-server</a>  ，目前托管在 GitHub 。</p>
<h4>对队列的要求</h4>
<p>在开始广播事件之前，你还需要配置和运行 <a href="/docs/laravel_8_zh/queues.html">队列监听器</a> 。所有的事件广播都是通过队列任务来完成的，因此应用程序的响应时间不会受到明显影响。</p>
<p><a name="concept-overview"></a></p>
<h2>概念综述</h2>
<p>Laravel 的事件广播允许你使用基于驱动的 WebSockets 将服务端的 Laravel 事件广播到客户端的 JavaScript 应用程序。当前的 Laravel 自带了 <a href="https://pusher.com/channels">Pusher</a> 和 Redis 驱动。通过使用 <a href="#installing-laravel-echo">Laravel Echo</a> 的 Javascript 包，我们可以很方便地在客户端消费事件。</p>
<p>事件通过「频道」来广播，这些频道可以被指定为公开或私有的。任何访客都可以不经授权或认证订阅一个公开频道；然而，如果想要订阅一个私有频道，那么该用户必须通过认证，并获得该频道的授权。</p>
<blockquote>
<p>提示：如果你想使用开源的Pusher替代品，请查看<a href="https://github.com/beyondcode/laravel-websockets">laravel-websockets</a>软件包。</p>
</blockquote>
<p><a name="using-example-application"></a></p>
<h3>使用示例程序</h3>
<p>深入了解事件广播的每个组件之前，让我们先用一个电子商务网站作为例子来概览一下。我们不会讨论配置 <a href="https://pusher.com/channels">Pusher</a> 或者 <a href="#installing-laravel-echo">Laravel Echo</a> 的细节，这些会在本文档的其它章节里详细讨论。</p>
<p>在我们的应用程序中，我们假设有一个允许用户查看订单配送状态的页面。有一个 <code>ShippingStatusUpdated</code> 事件会在配送状态更新时被触发：</p>
<pre><code>event(new ShippingStatusUpdated($update));</code></pre>
<h4><code>ShouldBroadcast</code> 接口</h4>
<p>当用户在查看自己的订单时，我们不希望他们必须通过刷新页面才能看到状态更新。我们希望一旦有更新时就主动将更新信息广播到客户端。所以，我们必须标记 <code>ShippingStatusUpdated</code> 事件实现 <code>ShouldBroadcast</code> 接口。这会让 Laravel 在事件被触发时广播该事件：</p>
<pre><code>&lt;?php

namespace App\Events;

use Illuminate\Broadcasting\Channel;
use Illuminate\Broadcasting\InteractsWithSockets;
use Illuminate\Broadcasting\PresenceChannel;
use Illuminate\Broadcasting\PrivateChannel;
use Illuminate\Contracts\Broadcasting\ShouldBroadcast;
use Illuminate\Queue\SerializesModels;

class ShippingStatusUpdated implements ShouldBroadcast
{
    /**
     * 配送状态更新消息。
     *
     * @var string
     */
    public $update;
}</code></pre>
<p><code>ShouldBroadcast</code> 接口要求事件定义一个 <code>broadcastOn</code> 方法。该方法负责指定事件被广播到哪些频道。在（通过 Artisan 命令）生成的事件类中，一个空的 <code>broadcastOn</code> 方法已经被预定义好了，所以我们只需要完成其细节即可。我们希望只有订单的创建者能够看到状态的更新，所以我们要把该事件广播到与这个订单绑定的私有频道上去：</p>
<pre><code>/**
 * 获取事件应广播的频道。
 *
 * @return \Illuminate\Broadcasting\PrivateChannel
 */
public function broadcastOn()
{
    return new PrivateChannel('order.'.$this-&gt;update-&gt;order_id);
}</code></pre>
<h4>授权频道</h4>
<p>请记住，只有授权过的用户才可以收听私有频道。我们可以在 <code>routes/channels.php</code> 文件中，定义我们频道的授权规则。 在这个例子中，我们需要去验证任何试图收听 <code>order.1</code> 私有频道的用户，是否是订单实际上的创建者：</p>
<pre><code>Broadcast::channel('order.{orderId}', function ($user, $orderId) {
    return $user-&gt;id === Order::findOrNew($orderId)-&gt;user_id;
});</code></pre>
<p><code>channel</code> 方法接收两个参数： 频道的名称和一个通过返回 <code>true</code> 或 <code>false</code> ，来表示用户是否有权收听该频道的回调函数 。</p>
<p>所有授权回调都将当前经过身份验证的用户作为其第一个参数，并将任何其他通配符参数作为其后续参数。 在这个例子中，我们用 <code>{orderId}</code> 占位符来通配表示频道名称 “ID” 的部分。</p>
<h4>监听事件广播</h4>
<p>接下来， 剩余的工作就是在我们的 JavaScript 应用程序中监听事件。 我们可以使用 Laravel Echo 来做到这一点。首先，我们将使用 <code>private</code> 方法订阅私有频道。 然后，我们可以使用 <code>listen</code> 方法来监听 <code>ShippingStatusUpdated</code> 事件。 默认情况下，所有事件的公共属性都将包含在广播事件中：</p>
<pre><code>Echo.private(`order.${orderId}`)
    .listen('ShippingStatusUpdated', (e) =&gt; {
        console.log(e.update);
    });</code></pre>
<p><a name="defining-broadcast-events"></a></p>
<h2>定义广播事件</h2>
<p>要通知 Laravel 应该广播给定事件，并在该事件上实现 <code>Illuminate\Contracts\Broadcasting\ShouldBroadcast</code>  接口。此接口已导入到框架生成的所有事件类中，因此你可以轻松地将其添加到任何事件中。</p>
<p><code>ShouldBroadcast</code> 接口要求你实现一个方法： <code>broadcastOn</code> 。 <code>broadcastOn</code> 方法应该返回事件应该广播的频道或频道数组。 该频道应该是 <code>Channel</code>， <code>PrivateChannel</code> ，或者 <code>PresenceChannel</code> 的实例。<code>Channel</code> 的实例 代表任何用户可以订阅的公共频道， <code>PrivateChannels</code> 和 <code>PresenceChannels</code> 实例代表需要<a href="#authorizing-channels">频道授权</a>的私有频道：</p>
<pre><code>&lt;?php

namespace App\Events;

use App\Models\User;
use Illuminate\Broadcasting\Channel;
use Illuminate\Broadcasting\InteractsWithSockets;
use Illuminate\Broadcasting\PresenceChannel;
use Illuminate\Broadcasting\PrivateChannel;
use Illuminate\Contracts\Broadcasting\ShouldBroadcast;
use Illuminate\Queue\SerializesModels;

class ServerCreated implements ShouldBroadcast
{
    use SerializesModels;

    public $user;

    /**
     * 新建一个新的事件实例。
     *
     * @return void
     */
    public function __construct(User $user)
    {
        $this-&gt;user = $user;
    }

    /**
     * 获取事件应广播的频道。
     *
     * @return Channel|array
     */
    public function broadcastOn()
    {
        return new PrivateChannel('user.'.$this-&gt;user-&gt;id);
    }
}</code></pre>
<p>那么， 你仅仅需要像平常那样 <a href="/docs/laravel_8_zh/events">触发事件</a> 。事件一旦触发， 一个 <a href="/docs/laravel_8_zh/queues.html">队列任务</a> 将通过你指定的广播驱动程序广播该事件。</p>
<p><a name="broadcast-name"></a></p>
<h3>广播名称</h3>
<p>通常，Laravel 将通过事件类的名称广播该事件，但是， 你也可以通过在事件中定义一个 <code>broadcastAs</code> 方法，来自定义事件名称：</p>
<pre><code>/**
 * 广播事件名称
 *
 * @return string
 */
public function broadcastAs()
{
    return 'server.created';
}</code></pre>
<p>如果你通过 <code>broadcastAs</code> 方法自定义广播名称， 你应该确保使用了一个前导的 <code>.</code> 字符，注册了你的监听器。 这将指示 Echo 不要将应用程序的命名空间添加到事件中：</p>
<pre><code>.listen('.server.created', function (e) {
    ....
});</code></pre>
<p><a name="broadcast-data"></a></p>
<h3>广播数据</h3>
<p>当一个事件被广播时， 它的所有 <code>public</code> 属性都会被自动序列化并作为事件的有效负载进行广播，这允许你从 JavaScript 应用程序访问它的任何公共数据。所以，例如，如果你的事件有一个包含 Eloquent 模型的公共 <code>$user</code> 属性， 该事件广播载入内容将如下所示：</p>
<pre><code>{
    "user": {
        "id": 1,
        "name": "Patrick Stewart"
        ...
    }
}</code></pre>
<p>但是，如果你希望对广播载入的内容进行更细粒度的控制，可以在事件中添加 <code>broadcastWith</code> 方法。 此方法将返回一个数据数组作为你希望广播事件所载入的内容：</p>
<pre><code>/**
 * 获取广播数据
 *
 * @return array
 */
public function broadcastWith()
{
    return ['id' =&gt; $this-&gt;user-&gt;id];
}</code></pre>
<p><a name="broadcast-queue"></a></p>
<h3>广播队列</h3>
<p>通常， 在你的 <code>queue.php</code> 配置文件中， 每个广播事件都放在指定默认队列连接的默认队列中。你可以在事件类中定义一个 <code>broadcastQueue</code> 属性来自定义广播的队列。此属性应指定广播时你要使用队列的名称：</p>
<pre><code>/**
 * 要放置事件的队列的名称。
 *
 * @var string
 */
public $broadcastQueue = 'your-queue-name';</code></pre>
<p>假如你要使用 <code>sync</code> 队列驱动代替默认的队列驱动来广播事件，你可以通过继承 <code>ShouldBroadcastNow</code> 接口来替代 <code>ShouldBroadcast</code> 接口：</p>
<pre><code>&lt;?php

use Illuminate\Contracts\Broadcasting\ShouldBroadcastNow;

class ShippingStatusUpdated implements ShouldBroadcastNow
{
    //
}</code></pre>
<p><a name="broadcast-conditions"></a></p>
<h3>广播条件</h3>
<p>有时候你需要在给定条件为 true 的时候才广播事件，你可以在事件类中增加一个 <code>broadcastWhen</code> 方法去定义这些条件：</p>
<pre><code>/**
 * 确定事件是否要被广播
 *
 * @return bool
 */
public function broadcastWhen()
{
    return $this-&gt;value &gt; 100;
}</code></pre>
<p><a name="authorizing-channels"></a></p>
<h2>授权频道</h2>
<p>私人频道往往需要授权验证过的用户才可以实际收听该频道。这是通过使用频道名称向你的 Laravel 应用程序发出 HTTP 请求，并允许你的应用程序确定用户是否可以收听该频道来实现的。使用 <a href="#installing-laravel-echo">Laravel Echo</a> 时， 将自动进行授权订阅私人频道的 HTTP 请求；但是，你需要定义响应这些请求的正确路由。</p>
<p><a name="defining-authorization-routes"></a></p>
<h3>定义授权路由</h3>
<p>庆幸的是，Laravel 可以轻松定义响应频道授权请求的路由。在 Laravel 应用程序附带的 <code>BroadcastServiceProvider</code> 中，你将看到对 <code>Broadcast::routes</code> 方法的调用。 此方法将注册 <code>/broadcasting/auth</code> 路由去处理授权请求：</p>
<pre><code>Broadcast::routes();</code></pre>
<p><code>Broadcast::routes</code> 方法将自动将其路由放在 <code>web</code> 中间件组中； 但是，如果要自定义指定的属性，可以将路径属性数组传递给方法：</p>
<pre><code>Broadcast::routes($attributes);</code></pre>
<h4>自定义授权端点</h4>
<p>通常， Echo 会使用 <code>/broadcasting/auth</code> 端点来授权频道访问。 但是，你可以通过将 <code>authEndpoint</code> 配置选项传递给 Echo 实例来指定自己的授权端点：</p>
<pre><code>window.Echo = new Echo({
    broadcaster: 'pusher',
    key: 'your-pusher-channels-key',
    authEndpoint: '/custom/endpoint/auth'
});</code></pre>
<p><a name="defining-authorization-callbacks"></a></p>
<h3>定义授权回调</h3>
<p>接下来，我们需要定义实际执行频道授权的逻辑。这是在你的应用程序附带的 <code>routes/channels.php</code> 文件中完成的 。 在这个文件中，你可以使用 <code>Broadcast::channel</code> 方法注册频道授权回调：</p>
<pre><code>Broadcast::channel('order.{orderId}', function ($user, $orderId) {
    return $user-&gt;id === Order::findOrNew($orderId)-&gt;user_id;
});</code></pre>
<p><code>channel</code> 方法接受两个参数：频道的名称和返回 <code>true</code> 或 <code>false</code> 来指示用户是否有权在频道上进行侦听的回调。</p>
<p>所有授权回调都将当前经过身份验证的用户作为其第一个参数，并将任何其他通配符参数作为其后续参数。 在这个例子中，我们用 <code>{orderId}</code> 占位符来通配表示频道名称 “ID” 的部分。</p>
<h4>授权回调模型绑定</h4>
<p>就像 HTTP 路由一样， 频道路由可以利用隐式和显式 <a href="/docs/laravel_8_zh/routing.html#route-model-binding">路由模型绑定</a>。例如，你可以请求一个实际的 <code>Order</code> 模型实列来替代接收一个字符串或者订单 ID 数字：</p>
<pre><code>use App\Models\Order;

Broadcast::channel('order.{order}', function ($user, Order $order) {
    return $user-&gt;id === $order-&gt;user_id;
});</code></pre>
<h4>授权回调验证</h4>
<p>私有和在线广播频道，通过应用程序默认的认证防护器来认证当前用户。如果用户未经过认证，则会自动拒绝频道授权，并且永远不会执行授权回调。 但是，你可以分配多个自定义防护器，以便在必要时对传入请求进行身份验证：</p>
<pre><code>Broadcast::channel('channel', function () {
    // ...
}, ['guards' =&gt; ['web', 'admin']]);</code></pre>
<p><a name="defining-channel-classes"></a></p>
<h3>定义频道类</h3>
<p>如果你的应用程序使用了很多不同的频道， 那么 <code>routes/channels.php</code> 文件将会变得很臃肿。 所以，你可以使用频道类，而不是使用闭包来授权频道。要生成频道类，使用 <code>make:channel</code> Artisan 命令。 此命令将在 <code>App/Broadcasting</code> 目录，生成一个新的频道类。</p>
<pre><code>php artisan make:channel OrderChannel</code></pre>
<p>接下来，在 <code>routes/channels.php</code> 文件中注册你的频道：</p>
<pre><code>use App\Broadcasting\OrderChannel;

Broadcast::channel('order.{order}', OrderChannel::class);</code></pre>
<p>最后，你可以把频道的授权逻辑，放在频道类的 <code>join</code> 方法中。<code>join</code> 方法将保留在频道授权闭包中的逻辑。 你还可以利用频道模型绑定：</p>
<pre><code>&lt;?php

namespace App\Broadcasting;

use App\Models\Order;
use App\Models\User;

class OrderChannel
{
    /**
     * 新建一个新的频道实例
     *
     * @return void
     */
    public function __construct()
    {
        //
    }

    /**
     * 验证用户对频道的访问权限。
     *
     * @param  \App\Models\User  $user
     * @param  \App\Models\Order  $order
     * @return array|bool
     */
    public function join(User $user, Order $order)
    {
        return $user-&gt;id === $order-&gt;user_id;
    }
}</code></pre>
<blockquote>
<p>提示：和很多 Laravel 中其他类一样，频道类会被 <a href="/docs/laravel_8_zh/container.html">服务容器</a> 自动解析。 所以，你可以在构造函数中键入频道所需的任何依赖。</p>
</blockquote>
<p><a name="broadcasting-events"></a></p>
<h2>广播事件</h2>
<p>一旦你定义了一个事件并用 <code>ShouldBroadcast</code> 接口标记它，你只需要使用 <code>event</code> 函数来触发事件。 事件调度程序将注意到事件标记为 <code>ShouldBroadcast</code> 接口，并将事件排队以进行广播：</p>
<pre><code>event(new ShippingStatusUpdated($update));</code></pre>
<p><a name="only-to-others"></a></p>
<h3>只广播给他人</h3>
<p>在构建利用事件广播的应用程序时，你可以使用 <code>broadcast</code> 函数替换 <code>event</code> 函数。 与 <code>event</code> 函数一样，<code>broadcast</code> 函数将事件调度到服务器端侦听器：</p>
<pre><code>broadcast(new ShippingStatusUpdated($update));</code></pre>
<p>但是，<code>broadcast</code> 函数还开放了 <code>toOthers</code> 方法，该方法允许你从广播的收件人中排除当前用户：</p>
<pre><code>broadcast(new ShippingStatusUpdated($update))-&gt;toOthers();</code></pre>
<p>为了更好地理解何时可能需要使用 <code>toOthers</code> 方法，让我们设想一个任务列表应用程序，用户可以通过输入任务名称来创建新任务。 要创建任务，你的应用程序可能会向 <code>/task</code> 端点发出请求，该端点广播任务的创建并返回 JSON 格式的新任务。 当你的 JavaScript 应用程序从端点收到响应时，它可能会直接将新任务插入其任务列表中，如下所示：</p>
<pre><code>axios.post('/task', task)
    .then((response) =&gt; {
        this.tasks.push(response.data);
    });</code></pre>
<p>但是，请记住，我们还广播任务的创建。 如果你的 JavaScript 应用程序正在收听此事件以便将任务添加到任务列表，则列表中将出现重复的任务：一个来自端点，另一个来自广播。 你可以使用 <code>toOthers</code> 方法来指示广播器不向当前用户广播事件。</p>
<blockquote>
<p>注意：你的事件必须使用 <code>Illuminate\Broadcasting\InteractsWithSockets</code> trait 才能调用 <code>toOthers</code> 方法。</p>
</blockquote>
<h4>配置</h4>
<p>初始化 Laravel Echo 实例时，会为连接分配套接字 ID 。 如果你使用 <a href="https://vuejs.org">Vue</a> 和 <a href="https://github.com/mzabriskie/axios">Axios</a> ，套接字 ID 将自动作为 <code>X-Socket-ID</code> 标题 附加到每个传出请求。 然后，当你调用 <code>toOthers</code> 方法时，Laravel 将从标头中提取套接字 ID，并指示广播器不要广播到具有该套接字 ID 的任何连接。</p>
<p>如果你不使用 Vue 和 Axios ，则需要手动配置 JavaScript 应用程序以发送 <code>X-Socket-ID</code> 头。 你可以使用 <code>Echo.socketId</code> 方法检索套接字 ID：</p>
<pre><code>var socketId = Echo.socketId();</code></pre>
<p><a name="receiving-broadcasts"></a></p>
<h2>接收广播</h2>
<p><a name="installing-laravel-echo"></a></p>
<h3>安装 Laravel Echo</h3>
<p>Laravel Echo 是一个 JavaScript 库，可以轻松订阅频道并收听 Laravel 广播的事件。 你可以通过 NPM 包管理器安装 Echo。 在这个例子中，我们还将安装 <code>pusher-js</code> 包，因为我们将使用 Pusher Channels 广播器：</p>
<pre><code>npm install --save laravel-echo pusher-js</code></pre>
<p>安装 Echo 后，你就可以在应用程序的 JavaScript 中创建一个全新的 Echo 实例。 一个好的实现方式是将它放在 Laravel 框架附带的 <code>resources/js/bootstrap.js</code> 文件的底部：</p>
<pre><code>import Echo from "laravel-echo"

window.Echo = new Echo({
    broadcaster: 'pusher',
    key: 'your-pusher-channels-key'
});</code></pre>
<p>在创建使用 <code>pusher</code> 连接器的 Echo 实例时，你还可以指定 <code>cluster</code> 是否必须通过 TLS 进行连接（默认情况下，当 <code>forceTLS</code> 为 <code>false</code> 时，如果页面是通过 HTTP 加载的，则会生成非 TLS 连接或者作为 TLS 连接失败时的回调）：</p>
<pre><code>window.Echo = new Echo({
    broadcaster: 'pusher',
    key: 'your-pusher-channels-key',
    cluster: 'eu',
    forceTLS: true
});</code></pre>
<h4>使用现有客户端实例</h4>
<p>如果你已经有 Echo 使用的 Pusher Channels 或 Socket.io 客户端实例，你可以通过 <code>client</code> 配置选项将它传递给 Echo：</p>
<pre><code>const client = require('pusher-js');

window.Echo = new Echo({
    broadcaster: 'pusher',
    key: 'your-pusher-channels-key',
    client: client
});</code></pre>
<p><a name="listening-for-events"></a></p>
<h3>对事件进行监听</h3>
<p>一旦安装并实例化了 Echo，就可以开始监听事件广播了。 首先，使用 <code>channel</code> 方法检索频道的实例，然后调用 <code>listen</code> 方法来监听指定的事件：</p>
<pre><code>Echo.channel('orders')
    .listen('OrderShipped', (e) =&gt; {
        console.log(e.order.name);
    });</code></pre>
<p>如果想在私有频道上收听事件，请使用 <code>private</code> 方法。 可以通过链式调用 <code>listen</code> 方法，在单个频道上侦听多个事件：</p>
<pre><code>Echo.private('orders')
    .listen(...)
    .listen(...)
    .listen(...);</code></pre>
<p><a name="leaving-a-channel"></a></p>
<h3>退出频道</h3>
<p>要退出频道，你可以在 Echo 实例上调用 <code>leaveChannel</code> 方法：</p>
<pre><code>Echo.leaveChannel('orders');</code></pre>
<p>如果你想退出一个频道以及相关的私有和在线频道，你可以调用 <code>leave</code> 方法：</p>
<pre><code>Echo.leave('orders');</code></pre>
<p><a name="namespaces"></a></p>
<h3>命名空间</h3>
<p>你可能已经在上面的示例中，注意到我们没有为事件类指定完整的命名空间。 这是因为 Echo 会自动假设事件位于 <code>App\Events</code> 命名空间中。 但是，你可以通过传递 <code>namespace</code> 配置选项来实例化 Echo 时配置根命名空间：</p>
<pre><code>window.Echo = new Echo({
    broadcaster: 'pusher',
    key: 'your-pusher-channels-key',
    namespace: 'App.Other.Namespace'
});</code></pre>
<p>或者，你可以在使用 Echo 订阅事件类时使用 <code>.</code> 作为前缀。 这将允许你始终指定完全限定的类名：</p>
<pre><code>Echo.channel('orders')
    .listen('.Namespace\\Event\\Class', (e) =&gt; {
        //
    });</code></pre>
<p><a name="presence-channels"></a></p>
<h2>Presence 频道</h2>
<p>Presence 频道建立在私有频道安全性的基础上，同时暴露了谁订阅频道的附加特征。 这样可以轻松构建功能强大的协作应用程序功能，例如在其他用户查看同一页面时通知用户。</p>
<p><a name="authorizing-presence-channels"></a></p>
<h3>授权 Presence 频道</h3>
<p>所有在线频道也是私有频道；因此，用户必须 <a href="#authorizing-channels">被授权才能访问</a>。但是，在为 Presence 频道定义授权回调时，如果用户有权加入该频道，则不会返回 <code>true</code> 。 相反，你应该返回有关用户的数据数组。</p>
<p>授权回调返回的数据将可供 JavaScript 应用程序中的 Presence 频道事件侦听器使用。 如果用户未被授权加入 Presence 频道，则应返回 <code>false</code> 或 <code>null</code>：</p>
<pre><code>Broadcast::channel('chat.{roomId}', function ($user, $roomId) {
    if ($user-&gt;canJoinRoom($roomId)) {
        return ['id' =&gt; $user-&gt;id, 'name' =&gt; $user-&gt;name];
    }
});</code></pre>
<p><a name="joining-presence-channels"></a></p>
<h3>加入 Presence 频道</h3>
<p>加入 Presence 频道，你可以使用 Echo 的 <code>join</code> 方法。 <code>join</code> 方法将返回一个 <code>PresenceChannel</code> 实现，它与 <code>listen</code> 方法一起展示，允许你订阅 <code>here</code> ，<code>joining</code> 和 <code>leaving</code> 事件。</p>
<pre><code>Echo.join(`chat.${roomId}`)
    .here((users) =&gt; {
        //
    })
    .joining((user) =&gt; {
        console.log(user.name);
    })
    .leaving((user) =&gt; {
        console.log(user.name);
    });</code></pre>
<p>一旦成功加入频道，将立即执行 <code>here</code> 回调，并且将接收包含当前订阅该频道的所有其他用户的用户信息的数组。 当新用户加入频道时，将执行 <code>joining</code> 方法，而当用户离开频道时，将执行 <code>leaving</code> 方法。</p>
<p><a name="broadcasting-to-presence-channels"></a></p>
<h3>广播到 Presence 频道</h3>
<p>Presence 频道可以像公共或私私有频道一样接收事件。 使用聊天室的示例，我们可能希望将 <code>NewMessage</code> 事件广播到房间的 Presence 频道。 为此，我们将从事件的 <code>broadcastOn</code> 方法返回一个 <code>PresenceChannel</code> 实例：</p>
<pre><code>/**
 * Get the channels the event should broadcast on.
 *
 * @return Channel|array
 */
public function broadcastOn()
{
    return new PresenceChannel('room.'.$this-&gt;message-&gt;room_id);
}</code></pre>
<p>与公共或私有事件一样，可以使用 <code>broadcast</code> 功能来广播 Presence 频道事件。 与其他事件一样，你可以使用 <code>toOthers</code> 方法排除当前用户接收广播：</p>
<pre><code>broadcast(new NewMessage($message));

broadcast(new NewMessage($message))-&gt;toOthers();</code></pre>
<p>你可以通过 Echo 的 <code>listen</code> 方法监听 join 事件：</p>
<pre><code>Echo.join(`chat.${roomId}`)
    .here(...)
    .joining(...)
    .leaving(...)
    .listen('NewMessage', (e) =&gt; {
        //
    });</code></pre>
<p><a name="client-events"></a></p>
<h2>客户端事件</h2>
<blockquote>
<p>提示：使用 <a href="https://pusher.com/channels">Pusher 频道</a>时， 必须在<a href="https://dashboard.pusher.com/">应用程序仪表板</a>的<code>应用程序设置</code>部分启用<code>客户端事件</code>选项以便发送客户端事件。</p>
</blockquote>
<p>有时，你可能希望将事件广播到其他连接的客户端，而根本不需要使用 Laravel 应用程序。 这对于诸如 <code>typing</code> 通知之类的内容特别有用，在这种情况下，你希望提醒应用程序的用户另一个用户正在给定屏幕上键入消息。</p>
<p>要广播客户端事件，可以使用 Echo 的 <code>whisper</code> 方法：</p>
<pre><code>Echo.private('chat')
    .whisper('typing', {
        name: this.user.name
    });</code></pre>
<p>要监听客户端事件，可以使用 <code>listenForWhisper</code> 方法：</p>
<pre><code>Echo.private('chat')
    .listenForWhisper('typing', (e) =&gt; {
        console.log(e.name);
    });</code></pre>
<p><a name="notifications"></a></p>
<h2>消息通知</h2>
<p>通过将事件广播与<a href="/docs/laravel_8_zh/notifications">通知</a>配对，你的 JavaScript 应用程序可以在发生时收到新通知，而无需刷新页面。 首先，请务必阅读有关使用<a href="/docs/laravel_8_zh/notifications.html#broadcast-notifications">广播通知频道</a>的文档。</p>
<p>配置通知以使用广播频道后，你可以使用 Echo 的 <code>notification</code> 方法监听广播事件。 请记住，频道名称应与接收通知的实体的类名相匹配：</p>
<pre><code>Echo.private(`App.User.${userId}`)
    .notification((notification) =&gt; {
        console.log(notification.type);
    });</code></pre>
<p>在此示例中，回调将接收通过 <code>广播</code> 频道发送到 <code>App\Models\User</code> 实例的所有通知。 <code>App.User.{id}</code> 频道的频道授权回调包含在 Laravel 框架附带的默认 <code>BroadcastServiceProvider</code> 中。</p>
            </div>
        </div>
    </div>
    <div class="col-md-3 col-xl-2" id="toc-list">
        <ul></ul>
    </div>
</div>    </div>
</div>
<span id="back-top">
<svg width="20" height="20" fill="currentColor">
    <use xlink:href="/css/bootstrap-icons.svg#chevron-up"/>
</svg>
</span>
 
<script>
    // 浏览量统计
    $(function () {
        let formdata = new FormData();
        formdata.append('_token', '');
        formdata.append('id', 309);
        $.ajax({
            url: $(".sticky-top .navbar-brand").attr('href') + "/api/doc/clicks",
            type: 'POST',
            data: formdata,
            processData: false,
            contentType: false
        });
    });
    // aside-hidden
    $(function () {
        $('#aside-hidden').on('click', function () {
            $('.aside').toggle(0, function () {
                if ($(this).is(':visible')) {
                    $('.aside-middle').removeClass('col-md-12 col-lg-12').addClass('col-md-9 col-lg-10');
                } else {
                    $('.aside-middle').removeClass('col-md-9 col-lg-10').addClass('col-md-12 col-lg-12');
                }
            });
        });
    });
</script>
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?1522d01c436f59ddc8389f25bfa9d53e";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
</body>
</html>