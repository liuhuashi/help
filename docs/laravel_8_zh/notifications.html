<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"> 
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"> 
    <meta name="csrf-token" content=""> 
    <title>消息通知 - 开发帮助文档</title> 
    <meta name="keyword" content="notifications"> 
    <meta name="description" content="notifications"> 
    <meta name="author" content="Moments"> 
    <link href="/favicon.ico" rel="shortcut icon"> 
    <link href="/css/blog.css" rel="stylesheet"> 
    <script src="/js/blog.js"></script> 
</head>
<body>
<header class="sticky-top">
    <nav class="navbar navbar-expand navbar-dark bg-secondary justify-content-between text-uppercase">
        <div class="navbar-nav" style="overflow:hidden;">
            <a class="navbar-brand" href="https://help.pythonschool.com">
                <span class="d-md-none">
                    <svg class="text-warning" width="24" height="24" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#emoji-sunglasses"/>
                    </svg>
                </span>
                <span class="d-none d-md-flex">开发帮助文档</span>
            </a>
            <div class="navbar-nav-scroll" style="overflow: hidden;">
                <ul class="navbar-nav text-nowrap pb-4" style="overflow:auto;">
                                            <li class="nav-item">
                            <a class="nav-link active" href="/docs/laravel/index.html">laravel</a>
                        </li>
                                            <li class="nav-item">
                            <a class="nav-link" href="/docs/php/index.html">php</a>
                        </li>
                                    </ul>
            </div>
        </div>
        <div class="d-inline-flex">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="https://github.com/liuhuashi">
                        <svg class="text-light" width="24" height="24" fill="currentColor">
                            <use xlink:href="/css/bootstrap-icons.svg#github"/>
                        </svg>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
</header>
<div class="container-fluid">
    <div id="aside-hidden" class="position-fixed" style="left:0;top: 58px;cursor:pointer;z-index: 10000;">
        <svg class="align-text-bottom text-warning" width="16" height="16" fill="currentColor" stroke="currentColor" stroke-width="1">
            <use xlink:href="/css/bootstrap-icons.svg#arrow-left-square"/>
        </svg>
    </div>
    <div class="row">
        <div class="aside col-md-3 col-lg-2 border-right shadow position-sticky" style="overflow:auto;height: calc(100vh - 58px);padding-bottom: calc(100vh/3);">
    <form class="row border-bottom p-3 bg-white sticky-top">
        <input id="search-version" class="form-control" data-version="7" type="search" placeholder="英文逗号分隔,分词搜索">
    </form>
    <ul class="nav navbar-nav nav-pills flex-column pt-2 figure-caption">
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/artisan.html" title="Artisan 命令行">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Artisan 命令行
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/authentication.html" title="用户认证">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    用户认证
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/authorization.html" title="用户授权">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    用户授权
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/blade.html" title="Blade 模板">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Blade 模板
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/broadcasting.html" title="广播系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    广播系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/cache.html" title="缓存系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    缓存系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/collections.html" title="集合">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    集合
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/configuration.html" title="Configuration">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Configuration
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/console-tests.html" title="控制台测试">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    控制台测试
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/container.html" title="服务容器">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    服务容器
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/contracts.html" title="契约">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    契约
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/contributions.html" title="贡献导引">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    贡献导引
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/controllers.html" title="Controllers">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Controllers
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/csrf.html" title="CSRF 保护">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    CSRF 保护
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/database-testing.html" title="数据库测试">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    数据库测试
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/database.html" title="数据库: 入门">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    数据库: 入门
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/deployment.html" title="部署">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    部署
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/documentation.html" title="前言">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    前言
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/dusk.html" title="Laravel Dusk">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Dusk
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/eloquent-collections.html" title="Eloquent: 集合">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: 集合
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/eloquent-mutators.html" title="Eloquent: 修改器">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: 修改器
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/eloquent-relationships.html" title="Eloquent: 关联">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: 关联
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/eloquent-resources.html" title="Eloquent: API 资源">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: API 资源
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/eloquent-serialization.html" title="Eloquent: 序列化">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: 序列化
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/eloquent.html" title="Eloquent: 入门">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Eloquent: 入门
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/encryption.html" title="加密解密">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    加密解密
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/envoy.html" title="Laravel Envoy">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Envoy
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/errors.html" title="错误处理">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    错误处理
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/events.html" title="事件系统">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    事件系统
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/facades.html" title="Facades">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Facades
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/filesystem.html" title="File Storage">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    File Storage
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/frontend.html" title="JavaScript &amp; CSS 脚手架">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    JavaScript &amp; CSS 脚手架
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/hashing.html" title="哈希加密">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    哈希加密
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/helpers.html" title="辅助函数">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    辅助函数
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/homestead.html" title="Laravel Homestead">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Homestead
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/horizon.html" title="Laravel Horizon">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Horizon
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/http-client.html" title="HTTP 客户端">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    HTTP 客户端
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/http-tests.html" title="HTTP Tests">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    HTTP Tests
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/installation.html" title="安装">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    安装
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/lifecycle.html" title="请求生命周期">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    请求生命周期
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/localization.html" title="本地化">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    本地化
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/logging.html" title="日志">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    日志
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/mail.html" title="邮件发送">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    邮件发送
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/middleware.html" title="中间件">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    中间件
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/migrations.html" title="数据库：迁移">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    数据库：迁移
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/mix.html" title="编辑资源 (Mix)">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    编辑资源 (Mix)
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/mocking.html" title="Mocking">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Mocking
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/notifications.html" title="消息通知">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    消息通知
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/packages.html" title="Package Development">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Package Development
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/pagination.html" title="数据库: 分页">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    数据库: 分页
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/passport.html" title="Laravel Passport">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Passport
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/passwords.html" title="重置密码">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    重置密码
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/providers.html" title="服务提供者">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    服务提供者
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/queries.html" title="数据库：查询构造器">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    数据库：查询构造器
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/queues.html" title="队列">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    队列
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/redis.html" title="Redis">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Redis
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/releases.html" title="发行说明">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    发行说明
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/requests.html" title="HTTP 请求">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    HTTP 请求
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/responses.html" title="HTTP Responses">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    HTTP Responses
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/routing.html" title="路由">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    路由
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/sail.html" title="Laravel Sail">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Sail
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/sanctum.html" title="Laravel Sanctum">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Sanctum
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/scheduling.html" title="任务调度">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    任务调度
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/scout.html" title="Laravel Scout">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Scout
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/seeding.html" title="数据库：填充">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    数据库：填充
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/session.html" title="HTTP 会话机制">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    HTTP 会话机制
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/socialite.html" title="Laravel 社会化登录">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel 社会化登录
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/structure.html" title="目录结构">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    目录结构
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/telescope.html" title="Laravel Telescope">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Telescope
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/testing.html" title="测试：入门指南">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    测试：入门指南
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/upgrade.html" title="升级指南">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    升级指南
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/urls.html" title="生成 URL">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    生成 URL
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/valet.html" title="Laravel Valet">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Laravel Valet
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/validation.html" title="表单验证">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    表单验证
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/verification.html" title="Email 认证">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    Email 认证
                </a>
            </li>
                    <li class="nav-item">
                <a class="nav-link" href="/docs/laravel_8_zh/views.html" title="视图">
                    <svg class="align-text-bottom text-dark" width="16" height="16" fill="currentColor">
                        <use xlink:href="/css/bootstrap-icons.svg#eyeglasses"/>
                    </svg>
                    视图
                </a>
            </li>
            </ul>
</div>        <div class="aside-middle col-md-9 col-lg-10 row">
    <div class="col-md-9 col-xl-10" style="overflow: auto;height: calc(100vh - 58px);padding-bottom: calc(100vh/3);">
        <div class="container main-h4-1">
            <div class="page-content">
                <h1>消息通知</h1>
<ul>
<li><a href="#introduction">简介</a></li>
<li><a href="#creating-notifications">创建通知</a></li>
<li><a href="#sending-notifications">发送通知</a>
<ul>
<li><a href="#using-the-notifiable-trait">使用 Notifiable Trait</a></li>
<li><a href="#using-the-notification-facade">使用 Notification Facade</a></li>
<li><a href="#specifying-delivery-channels">指定发送频道</a></li>
<li><a href="#queueing-notifications">通知队列化</a></li>
<li><a href="#on-demand-notifications">按需通知</a></li>
</ul></li>
<li><a href="#mail-notifications">邮件通知</a>
<ul>
<li><a href="#formatting-mail-messages">格式化邮件信息</a></li>
<li><a href="#customizing-the-sender">自定义发送者</a></li>
<li><a href="#customizing-the-recipient">自定义接收者</a></li>
<li><a href="#customizing-the-subject">自定义主题</a></li>
<li><a href="#customizing-the-mailer">自定义邮件驱动</a></li>
<li><a href="#customizing-the-templates">自定义模板</a></li>
<li><a href="#previewing-mail-notifications">邮件通知预览</a></li>
</ul></li>
<li><a href="#markdown-mail-notifications">Markdown 邮件通知</a>
<ul>
<li><a href="#generating-the-message">生成消息</a></li>
<li><a href="#writing-the-message">写消息</a></li>
<li><a href="#customizing-the-components">自定义组件</a></li>
</ul></li>
<li><a href="#database-notifications">数据库通知</a>
<ul>
<li><a href="#database-prerequisites">先决条件</a></li>
<li><a href="#formatting-database-notifications">格式化数据库通知</a></li>
<li><a href="#accessing-the-notifications">访问通知</a></li>
<li><a href="#marking-notifications-as-read">标记已读通知</a></li>
</ul></li>
<li><a href="#broadcast-notifications">广播通知</a>
<ul>
<li><a href="#broadcast-prerequisites">先决条件</a></li>
<li><a href="#formatting-broadcast-notifications">格式化广播通知</a></li>
<li><a href="#listening-for-notifications">监听通知</a></li>
</ul></li>
<li><a href="#sms-notifications">短信通知</a>
<ul>
<li><a href="#sms-prerequisites">先决条件</a></li>
<li><a href="#formatting-sms-notifications">格式化短信通知</a></li>
<li><a href="#formatting-shortcode-notifications">格式化简码通知</a></li>
<li><a href="#customizing-the-from-number">自定义「From」电话号码</a></li>
<li><a href="#routing-sms-notifications">短信通知路由</a></li>
</ul></li>
<li><a href="#slack-notifications">Slack 通知</a>
<ul>
<li><a href="#slack-prerequisites">先决条件</a></li>
<li><a href="#formatting-slack-notifications">格式化 Slack 通知</a></li>
<li><a href="#slack-attachments">Slack 附件</a></li>
<li><a href="#routing-slack-notifications">Slack 通知路由</a></li>
</ul></li>
<li><a href="#localizing-notifications">本地化通知</a></li>
<li><a href="#notification-events">通知事件</a></li>
<li><a href="#custom-channels">自定义频道</a></li>
</ul>
<p><a name="introduction"></a></p>
<h2>简介</h2>
<p>除了支持 <a href="/docs/laravel_8_zh/mail">发送邮件</a> 之外，Laravel 还支持通过多种频道发送通知，包括邮件、短信 (通过 <a href="https://www.html.vonage.com/communications-apis/">Vonage</a>，原来叫 Nexmo)，以及 <a href="https://slack.com">Slack</a>。通知还能存储到数据库以便后续在 Web 页面中显示。</p>
<p>通常, 通知应该是简短的信息性消息，用于通知用户应用中发生的事情。例如，如果你正在编写一个账单应用，则可以通过邮件和短信频道向用户发送一个 「支付凭证」 通知。</p>
<p><a name="creating-notifications"></a></p>
<h2>创建通知</h2>
<p>Laravel 中，每个通知由一个类表示 (通常存放在 <code>app/Notifications</code> 文件夹下)。如果在你的应用中没有看到这个目录，不要担心，当运行 <code>make:notification</code> 命令时它就会被创建：</p>
<pre><code>php artisan make:notification InvoicePaid</code></pre>
<p>这个命令会在 <code>app/Notifications</code> 目录下生成一个新的通知类。每个通知类都包含一个 <code>via</code> 方法以及一个或多个消息构建的方法（比如 <code>toMail</code> 或者 <code>toDatabase</code>)，它们会针对特定的渠道把通知转换为对应的消息。</p>
<p><a name="sending-notifications"></a></p>
<h2>发送通知</h2>
<p><a name="using-the-notifiable-trait"></a></p>
<h3>使用 Notifiable Trait</h3>
<p>通知可以通过两种方法发送: <code>Notifiable</code> trait 的 <code>notify</code> 方法或 <code>Notification</code> <a href="/docs/laravel_8_zh/facades.html">facade</a>。首先，让我们来探索下使用 trait：</p>
<pre><code>&lt;?php

namespace App\Models;

use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;

class User extends Authenticatable
{
    use Notifiable;
}</code></pre>
<p>这个 trait 由预设的 <code>App\Models\User</code> 模型使用，它含有一个可以用来发送通知的方法： <code>notify</code>。<code>notify</code> 方法需要接收一个通知实例参数：</p>
<pre><code>use App\Notifications\InvoicePaid;

$user-&gt;notify(new InvoicePaid($invoice));</code></pre>
<blockquote>
<p>提示： 请记住，你可以在任何模型中使用 <code>Illuminate\Notifications\Notifiable</code> trait。而不仅仅是在 <code>User</code> 模型中。</p>
</blockquote>
<p><a name="using-the-notification-facade"></a></p>
<h3>使用 Notification Facade</h3>
<p>另外，你可以通过 <code>Notification</code> <a href="/docs/laravel_8_zh/facades.html">facade</a> 来发送通知，它主要用在当你需要给多个可接收通知的实体发送的时候，比如给用户集合发送通知。使用 Facade 发送通知的话，要把可接收通知实例和通知实例传递给 <code>send</code> 方法：</p>
<pre><code>Notification::send($users, new InvoicePaid($invoice));</code></pre>
<p><a name="specifying-delivery-channels"></a></p>
<h3>发送指定频道</h3>
<p>每个通知类都会有个 <code>via</code> 方法，它决定了通知会在哪个频道上发送。开箱即用的频道有 <code>mail</code>，<code>database</code>，<code>broadcast</code>，<code>nexmo</code>，和 <code>slack</code>。</p>
<blockquote>
<p>提示：如果你想使用其他的频道，比如 Telegram 或者 Pusher，你可以去看下社区驱动的 <a href="http://laravel-notification-channels.com">Laravel 通知频道网站</a>。</p>
</blockquote>
<p><code>via</code> 方法接收一个 <code>$notifiable</code> 实例，这个实例将是通知实际发送到的类的实例。你可以用 <code>$notifiable</code> 来决定这个通知用哪些频道来发送：</p>
<pre><code>/**
 * 获取通知发送频道
 *
 * @param  mixed  $notifiable
 * @return array
 */
public function via($notifiable)
{
    return $notifiable-&gt;prefers_sms ? ['nexmo'] : ['mail', 'database'];
}</code></pre>
<p><a name="queueing-notifications"></a></p>
<h3>通知队列化</h3>
<blockquote>
<p>注：使用通知队列前需要配置队列并 <a href="/docs/laravel_8_zh/queues.html">开启一个队列任务</a>。</p>
</blockquote>
<p>发送通知可能是耗时的，尤其是通道需要调用额外的 API 来传输通知。为了加速应用的响应时间，可以将通知推送到队列中异步发送，而要实现推送通知到队列，可以让对应通知类实现 <code>ShouldQueue</code> 接口并使用 <code>Queueable</code> trait。如果通知类是通过 <code>make:notification</code> 命令生成的，那么该接口和 trait 已经默认导入，你可以快速将它们添加到通知类：</p>
<pre><code>&lt;?php

namespace App\Notifications;

use Illuminate\Bus\Queueable;
use Illuminate\Contracts\Queue\ShouldQueue;
use Illuminate\Notifications\Notification;

class InvoicePaid extends Notification implements ShouldQueue
{
    use Queueable;

    // ...
}</code></pre>
<p><code>ShouldQueue</code> 接口被添加到通知类以后，你可以像之前一样正常发送通知，Laravel 检测到 <code>ShouldQueue</code> 接口后会自动将通知的发送添加到队列：</p>
<pre><code>$user-&gt;notify(new InvoicePaid($invoice));</code></pre>
<p>如果你想要延迟通知的发送，可以在通知实例后加上 <code>delay</code> 方法：</p>
<pre><code>$when = now()-&gt;addMinutes(10);

$user-&gt;notify((new InvoicePaid($invoice))-&gt;delay($when));</code></pre>
<p><a name="customizing-notification-channel-queues"></a></p>
<h4>自定义通知频道队列</h4>
<p>如果你想针对通知支持的每一个频道指定应使用的特定队列，则可以在通知类中定义一个 <code>viaQueues</code> 方法。</p>
<pre><code>/**
* 确定哪些队列应该被通知频道使用。
*
* @return array
*/
public function viaQueues()
{
    return [
        'mail' =&gt; 'mail-queue',
        'slack' =&gt; 'slack-queue',
    ];
}</code></pre>
<p><a name="on-demand-notifications"></a></p>
<h3>按需通知</h3>
<p>有时候你可能需要发送通知给某个用户，但是该用户不存在于应用的用户系统中，要实现这一目的，我们使用 <code>Notification::route</code> 方法， 在发送通知之前可以指定特定的通知路由：</p>
<pre><code>Notification::route('mail', 'taylor@example.com')
            -&gt;route('nexmo', '5555555555')
            -&gt;route('slack', 'https://hooks.slack.com/services/...')
            -&gt;notify(new InvoicePaid($invoice));</code></pre>
<p><a name="mail-notifications"></a></p>
<h2>邮件通知</h2>
<p><a name="formatting-mail-messages"></a></p>
<h3>格式化邮件消息</h3>
<p>如果通知支持以邮件方式发送，你需要在通知类上定义一个 <code>toMail</code> 方法。该方法会接收一个 <code>$notifiable</code> 实体并返回 <code>Illuminate\Notifications\Messages\MailMessage</code> 实例。邮件消息可以包含多行文本以及对「动作的调用」。 让我们来看一个 <code>toMail</code> 方法的示例:</p>
<pre><code>/**
 * 获取通知对应的邮件.
 *
 * @param  mixed  $notifiable
 * @return \Illuminate\Notifications\Messages\MailMessage
 */
public function toMail($notifiable)
{
    $url = url('/invoice/'.$this-&gt;invoice-&gt;id);

    return (new MailMessage)
                -&gt;greeting('Hello!')
                -&gt;line('One of your invoices has been paid!')
                -&gt;action('View Invoice', $url)
                -&gt;line('Thank you for using our application!');
}</code></pre>
<blockquote>
<p>提示：请注意我们在 <code>toMail</code> 方法中使用了 <code>$this-&gt;invoice-&gt;id</code>。你可以传递任何通知生成消息所需要的数据到通知的构造器。</p>
</blockquote>
<p>在这个例子中，我们邮寄一个问候语，一行文本，一个操作请求，然后是另一行文本。<code>MailMessage</code> 对象提供的这些方法让格式化短小的事务邮件变得简单快捷。<code>mail</code> 通道会将消息组件转化为带有纯文本副本的漂亮的响应式 HTML 邮件模板。下面是一个通过 <code>mail</code> 通道生成的邮件示例：</p>
<p><img src="img/notification-example.png" alt="" /></p>
<blockquote>
<p>提示： 发送邮件通知时，确保在配置文件 <code>config/app.php</code> 中设置了 <code>name</code>  的值。这个值将会用在邮件通知消息的头部和底部。</p>
</blockquote>
<h4>其他通知格式化选项</h4>
<p>除了在通知类中定义多行文本之外，你还可以使用 <code>view</code> 方法来指定一个用于渲染通知邮件的自定义模板：</p>
<pre><code> /**
  * 获取通知的邮件内容
  *
  * @param  mixed  $notifiable
  * @return \Illuminate\Notifications\Messages\MailMessage
  */
 public function toMail($notifiable)
 {
     return (new MailMessage)-&gt;view(
         'emails.name', ['invoice' =&gt; $this-&gt;invoice]
     );
 }</code></pre>
<p>你可以通过将视图名称作为数组第二个元素传给 <code>MailMessage</code> 的 <code>view</code> 方法，以此为邮件消息指定纯文本视图：</p>
<pre><code> /**
  * 获取通知的邮件内容
  *
  * @param  mixed  $notifiable
  * @return \Illuminate\Notifications\Messages\MailMessage
  */
 public function toMail($notifiable)
 {
     return (new MailMessage)-&gt;view(
         ['emails.name.html', 'emails.name.plain'],
         ['invoice' =&gt; $this-&gt;invoice]
     );
 }</code></pre>
<p>此外，你可以从 <code>toMail</code> 方法中返回一个完整的 <a href="/docs/laravel_8_zh/mail.html">可邮寄对象</a> ：</p>
<pre><code>use App\Mail\InvoicePaid as Mailable;

/**
 * 获取通知的邮件内容
 *
 * @param  mixed  $notifiable
 * @return Mailable
 */
public function toMail($notifiable)
{
    return (new Mailable($this-&gt;invoice))-&gt;to($notifiable-&gt;email);
}</code></pre>
<p><a name="error-messages"></a></p>
<h4>错误消息</h4>
<p>一些通知会告知用户错误信息，例如失败的订单支付。你可以在构建消息的时候调用 <code>error</code> 方法来指明这是一个关于错误的邮件消息。在邮件消息中使用 <code>error</code> 方法时，操作按钮将会变成红色，而不再是蓝色：</p>
<pre><code>/**
 * 获取通知邮件内容
 *
 * @param  mixed  $notifiable
 * @return \Illuminate\Notifications\Message
 */
public function toMail($notifiable)
{
    return (new MailMessage)
                -&gt;error()
                -&gt;subject('Notification Subject')
                -&gt;line('...');
}</code></pre>
<p><a name="customizing-the-sender"></a></p>
<h3>自定义发送者</h3>
<p>默认情况下，电子邮件的发件人 / 发件人地址 定义在 <code>config/mail.php</code> 配置文件中。 但是，你可以使用 <code>from</code> 方法指定特定通知的发件人地址：</p>
<pre><code>/**
 * Get the mail representation of the notification.
 *
 * @param  mixed  $notifiable
 * @return \Illuminate\Notifications\Messages\MailMessage
 */
public function toMail($notifiable)
{
    return (new MailMessage)
                -&gt;from('test@example.com', 'Example')
                -&gt;line('...');
}</code></pre>
<p><a name="customizing-the-recipient"></a></p>
<h3>自定义接收者</h3>
<p>通过 <code>mail</code> 通道发送通知时，通知系统会自动在被通知实体上查找 <code>email</code> 属性，你可以通过在该实体上定义一个  <code>routeNotificationForMail</code> 来自定义使用哪个邮箱地址发送通知：</p>
<pre><code>&lt;?php

namespace App\Models;

use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;

class User extends Authenticatable
{
    use Notifiable;

    /**
     * 邮件通道通知的路由。
     *
     * @param  \Illuminate\Notifications\Notification  $notification
     * @return array|string
     */
    public function routeNotificationForMail($notification)
    {
        // 只返回邮件地址...
        return $this-&gt;email_address;

        // 返回名字和邮件地址...
        return [$this-&gt;email_address =&gt; $this-&gt;name];
    }
}</code></pre>
<p><a name="customizing-the-subject"></a></p>
<h3>自定义主题</h3>
<p>默认情况下，邮件的主题就是格式为 「标题风格」 的通知类名，因此，如果通知类被命名为 <code>InvoicePaid</code>，邮件的主题就是 <code>Invoice Paid</code>，如果你想要为消息指定明确的主题，可以在构建消息的时候调用 <code>subject</code> 方法：</p>
<pre><code>/**
 * Get the mail representation of the notification.
 *
 * @param  mixed  $notifiable
 * @return \Illuminate\Notifications\Messages\MailMessage
 */
public function toMail($notifiable)
{
    return (new MailMessage)
                -&gt;subject('Notification Subject')
                -&gt;line('...');
}</code></pre>
<p><a name="customizing-the-mailer"></a></p>
<h3>自定义邮件发送驱动</h3>
<p>默认情况下，邮件通知将使用 <code>config/mail.php</code> 配置文件中定义的默认驱动程序发送。但是，你可以在运行时通过在生成消息时调用 <code>mailer</code> 方法指定一个其他的邮件发送驱动：</p>
<pre><code>/**
 * Get the mail representation of the notification.
 *
 * @param  mixed  $notifiable
 * @return \Illuminate\Notifications\Messages\MailMessage
 */
public function toMail($notifiable)
{
    return (new MailMessage)
                -&gt;mailer('postmark')
                -&gt;line('...');
}</code></pre>
<p><a name="customizing-the-templates"></a></p>
<h3>自定义模板</h3>
<p>你可以通过发布通知扩展包的资源来修改邮件通知所使用的 HTML 和纯文本模板。运行完下面这个命令之后，邮件通知模板将会存放到 <code>resources/views/vendor/notifications</code> 目录：</p>
<pre><code>php artisan vendor:publish --tag=laravel-notifications</code></pre>
<p><a name="previewing-mail-notifications"></a></p>
<h3>邮件通知预览</h3>
<p>设计邮件通知模板时，可以像典型的 Blade 模板一样在浏览器中快速预览渲染的邮件。 因此，Laravel 允许您直接从路由闭包或控制器返回由邮件通知生成的任何邮件。 当一个 <code>MailMessage</code> 返回时，它将被渲染并显示在浏览器中，使您可以快速预览其设计，而无需将其发送到实际的邮箱地址：</p>
<pre><code>Route::get('mail', function () {
    $invoice = App\Invoice::find(1);

    return (new App\Notifications\InvoicePaid($invoice))
                -&gt;toMail($invoice-&gt;user);
});</code></pre>
<p><a name="markdown-mail-notifications"></a></p>
<h2>Markdown 邮件通知</h2>
<p>Markdown 邮件通知允许您使用邮件内置的通知模板，从而让您可以自由地编写更长更具有个性化的消息。如果消息以 Markdown 的形式进行书写，Laravel 还可以为其渲染出颜值很高的、响应式的 HTML 模板，同时也会为其生成一份纯文本的副本。</p>
<p><a name="generating-the-message"></a></p>
<h3>生成消息</h3>
<p>您可以在 <code>make:notification</code> Artisan 命令中添加 <code>--markdown</code> 选项来生成符合 Markdown 规范的通知模板：</p>
<pre><code>php artisan make:notification InvoicePaid --markdown=mail.invoice.paid</code></pre>
<p>如同其他邮件通知一样，使用 Markdown 模板的通知也在其通知类中定义了 <code>toMail</code> 方法。但是，不要使用 <code>line</code> 和 <code>action</code> 方法来构造通知，您应该使用 <code>markdown</code> 方法来指定应该使用的 markdown 模板的名称：</p>
<pre><code>/**
 * 获取通知的邮件表示。
 *
 * @param  mixed  $notifiable
 * @return \Illuminate\Notifications\Messages\MailMessage
 */
public function toMail($notifiable)
{
    $url = url('/invoice/'.$this-&gt;invoice-&gt;id);

    return (new MailMessage)
                -&gt;subject('Invoice Paid')
                -&gt;markdown('mail.invoice.paid', ['url' =&gt; $url]);
}</code></pre>
<p><a name="writing-the-message"></a></p>
<h3>编写消息</h3>
<p>Markdown 邮件通知整合了 Blade 组件和 Markdown 语法，它允许您利用 Laravel 内置的通知组件的优点来轻松构建通知：</p>
<pre><code>@component('mail::message')
# Invoice Paid

Your invoice has been paid!

@component('mail::button', ['url' =&gt; $url])
View Invoice
@endcomponent

Thanks,&lt;br&gt;
{{ config('app.name') }}
@endcomponent</code></pre>
<h4>按钮组件</h4>
<p>按钮组件渲染了一个居中的按钮链接。该组件接受两个参数，分别是 <code>url</code> 和可选的 <code>颜色</code> 。可用的颜色有 <code>blue</code> ， <code>green</code> 和 <code>red</code> 。您可以按需添加任意数量的按钮组件到通知中：</p>
<pre><code>@component('mail::button', ['url' =&gt; $url, 'color' =&gt; 'green'])
View Invoice
@endcomponent</code></pre>
<h4>面板组件</h4>
<p>面板组件在面板内渲染指定的文字块，其背景色与其他通知略有不同。能让你绘制一个警示文字块：</p>
<pre><code>@component('mail::panel')
This is the panel content.
@endcomponent</code></pre>
<h4>表格组件</h4>
<p>表格组件允许您将 Markdown 表格转换为 HTML 表格。该组件接受 Markdown 表格作为其内容。表格列的对齐方式支持使用默认的 Markdown 表格对齐语法：</p>
<pre><code>@component('mail::table')
| Laravel       | Table         | Example  |
| ------------- |:-------------:| --------:|
| Col 2 is      | Centered      | $10      |
| Col 3 is      | Right-Aligned | $20      |
@endcomponent</code></pre>
<p><a name="customizing-the-components"></a></p>
<h3>自定义组件</h3>
<p>您可以导出所有的 Markdown 通知组件到您自己的应用中以实现自定义。要导出组件，请使用 <code>vendor:publish</code> Artisan 命令来发布 <code>laravel-mail</code> 资产标签：</p>
<pre><code>php artisan vendor:publish --tag=laravel-mail</code></pre>
<p>该命令将会发布 Markdown 邮件组件到 <code>resources/views/vendor/mail</code> 目录中。<code>mail</code> 目录将包含 <code>html</code> 和 <code>text</code> 两个子目录，每个子目录又包含各自支持的所有组件。您可以按照您的喜好来随意自定义它们。</p>
<h4>自定义 CSS</h4>
<p>在导出组件之后， <code>resources/views/vendor/mail/html/themes</code> 目录将会包含一个 <code>default.css</code> 文件。您可以在该文件中自定义您的样式，它将会自动应用于您的 Markdown 通知的 HTML 表现上。</p>
<p>如果您想要构建一个全新的 Laravel Markdown 组件的主题，您可以将 CSS 文件置于 <code>html/themes</code> 目录中。在命名和保存了您的 CSS 文件后，请更新 <code>mail</code> 配置文件中的 <code>theme</code> 选项以匹配新主题的名称。</p>
<p>您可以在构建通知邮件消息时调用 <code>theme</code> 方法来为单独一个通知自定义样式。<code>theme</code> 方法接受一个发送通知时要使用的主题的名称：</p>
<pre><code>/**
 * 获取通知的邮件表现。
 *
 * @param  mixed  $notifiable
 * @return \Illuminate\Notifications\Messages\MailMessage
 */
public function toMail($notifiable)
{
    return (new MailMessage)
                -&gt;theme('invoice')
                -&gt;subject('Invoice Paid')
                -&gt;markdown('mail.invoice.paid', ['url' =&gt; $url]);
}</code></pre>
<p><a name="database-notifications"></a></p>
<h2>数据库通知</h2>
<p><a name="database-prerequisites"></a></p>
<h3>先决条件</h3>
<p><code>database</code> 通知频道会在数据库中存储通知信息。该表包含通知的类型和描述通知的自定义 JSON 数据之类的信息。</p>
<p>您可以将其从数据表中查询出来，并显示在用户界面中。不过，在此之前，您需要创建一个数据库来维持您的通知。您可以使用 <code>notifications:table</code> 命令来生成一个包含相应的数据表的迁移：</p>
<pre><code>php artisan notifications:table

php artisan migrate</code></pre>
<p><a name="formatting-database-notifications"></a></p>
<h3>格式化数据通知</h3>
<p>如果要将通知存储到数据库中，您应该在通知类中定义 <code>toDatabase</code> 或 <code>toArray</code> 方法。该方法应该接受一个 <code>$notifiable</code> 实体并返回一个原生的 PHP 数组。返回的数组将会被编码成为 JSON 并存储到您的 <code>notifications</code> 表的 <code>data</code> 字段中。让我们来看一个 <code>toArray</code> 方法的例子：</p>
<pre><code>/**
 * 获取通知的数组表现。
 *
 * @param  mixed  $notifiable
 * @return array
 */
public function toArray($notifiable)
{
    return [
        'invoice_id' =&gt; $this-&gt;invoice-&gt;id,
        'amount' =&gt; $this-&gt;invoice-&gt;amount,
    ];
}</code></pre>
<h4>比较 <code>toDatabase</code> 和 <code>toArray</code></h4>
<p><code>toArray</code> 还用于 <code>broadcast</code> 频道来确定要向 JavaScript 客户端广播哪些数据。如果希望为  <code>database</code> 和 <code>broadcast</code> 频道使用两种不同的数组表示形式，则应定义 <code>toDatabase</code> 方法而不是 <code>toArray</code> 方法。</p>
<p><a name="accessing-the-notifications"></a></p>
<h3>访问通知</h3>
<p>一旦通知存入数据库，就需要适当的方法自通知实体访问它们。 包含在 Lareval 的默认 <code>App\User</code> 模型带有 <code>Illuminate\Notifications\Notifiable</code> trait，它的 notifications Eloquent 关联方法能返回实体通知。要获取通知，可以像其它 Eloquent 关联方法一样访问此方法。默认情况下，通知按照 <code>created_at</code> 时间戳排序:</p>
<pre><code>$user = App\Models\User::find(1);

foreach ($user-&gt;notifications as $notification) {
    echo $notification-&gt;type;
}</code></pre>
<p>若要只获取 「未读」通知，可以使用 <code>unreadNotifications</code> 关联方法。同样这些通知按照 <code>created_at</code> 时间戳排序：:</p>
<pre><code>$user = App\Models\User::find(1);

foreach ($user-&gt;unreadNotifications as $notification) {
    echo $notification-&gt;type;
}</code></pre>
<blockquote>
<p>技巧：若要从 JavaScript 客户端访问通知，需要为应用定义一个通知控制器，它返回可通知实体的通知，比如当前用户。可以从 JavaScript 客户端向该控制器 URI 发送 HTTP 请求。</p>
</blockquote>
<p><a name="marking-notifications-as-read"></a></p>
<h3>标记通知已读</h3>
<p>通常，在用户阅览一条通知之后，你会想将其标识为「已读」。 <code>Illuminate\Notifications\Notifiable</code> trait 提供了 <code>markAsRead</code> 方法，它更新数据库中通知记录的 <code>read_at</code> 列:</p>
<pre><code>$user = App\Models\User::find(1);

foreach ($user-&gt;unreadNotifications as $notification) {
    $notification-&gt;markAsRead();
}</code></pre>
<p>当然，您亦可在通知集合上使用 <code>markAsRead</code> 方法来代替遍历通知：</p>
<pre><code>$user-&gt;unreadNotifications-&gt;markAsRead();</code></pre>
<p>您亦可通过大规模更新查询（不指定 where 条件的更新）来将所有通知标记为已读，而不必将其从数据库检索出来：</p>
<pre><code>$user = App\Models\User::find(1);

$user-&gt;unreadNotifications()-&gt;update(['read_at' =&gt; now()]);</code></pre>
<p>您也可以使用 <code>delete</code> 方法来将其从数据库实体中删除：</p>
<pre><code>$user-&gt;notifications()-&gt;delete();</code></pre>
<p><a name="broadcast-notifications"></a></p>
<h2>广播通知</h2>
<p><a name="broadcast-prerequisites"></a></p>
<h3>先决条件</h3>
<p>在广播通知前，您应该配置与精通 Laravel 的 <a href="/docs/laravel_8_zh/broadcasting.html">事件广播</a> 服务。事件广播提供了在 JavaScript 客户端响应服务端发出的 Laravel 事件的方法。</p>
<p><a name="formatting-broadcast-notifications"></a></p>
<h3>格式化广播通知</h3>
<p><code>broadcast</code> 频道广播通知使用 Laravel 的 <a href="/docs/laravel_8_zh/broadcasting.html">事件广播</a> 服务，它允许您的 JavaScript 实时捕获通知。您可以在通知类中定义一个 <code>toBroadcast</code> 方法来让通知支持被广播。该方法接收一个  <code>$notifiable</code> 实体并返回一个 <code>BroadcastMessage</code> 实例。如果 <code>toBroadcast</code> 方法不存在，<code>toArray</code> 方法将用来收集广播数据。返回的数据将被编码为 JSON 并广播给您的 JavaScript 客户端。让我们来看一个 <code>toBroadcast</code> 方法的例子：</p>
<pre><code>use Illuminate\Notifications\Messages\BroadcastMessage;

/**
 * 获取通知的广播表现。
 *
 * @param  mixed  $notifiable
 * @return BroadcastMessage
 */
public function toBroadcast($notifiable)
{
    return new BroadcastMessage([
        'invoice_id' =&gt; $this-&gt;invoice-&gt;id,
        'amount' =&gt; $this-&gt;invoice-&gt;amount,
    ]);
}</code></pre>
<h4>广播队列配置</h4>
<p>所有的广播通知都被放入广播队列。您可以使用 <code>BroadcastMessage</code> 的 <code>onConnection</code> 和 <code>onQueue</code> 方法来配置在进行广播操作时使用的队列的队列名称和连接：</p>
<pre><code>return (new BroadcastMessage($data))
                -&gt;onConnection('sqs')
                -&gt;onQueue('broadcasts');</code></pre>
<h4>自定义通知类型</h4>
<p>除了您指定的数据以外，所有的广播通知还拥有一个包含了完整的通知类名的 <code>type</code> 域。如果您想要自定义提供给 JavaScript 的通知的 <code>type</code> 域，您可以在通知类中定义一个 <code>broadcastType</code> 方法：</p>
<pre><code>use Illuminate\Notifications\Messages\BroadcastMessage;

/**
 * 获取将要广播的通知的类型。
 *
 * @return string
 */
public function broadcastType()
{
    return 'broadcast.message';
}</code></pre>
<p><a name="listening-for-notifications"></a></p>
<h3>监听通知</h3>
<p>通知将在使用 <code>{notifiable}.{id}</code> 形式格式化的私有频道上进行广播。因此，如果您要发送通知到 ID 为 <code>1</code> 的 <code>App\Models\User</code> 实例上，通知将在 <code>App.User.1</code> 私有频道上广播。当使用 <a href="/docs/laravel_8_zh/broadcasting.html">Laravel Echo</a> 时，您可以使用 <code>notification</code> 辅助函数来方便的监听通知：</p>
<pre><code>Echo.private('App.User.' + userId)
    .notification((notification) =&gt; {
        console.log(notification.type);
    });</code></pre>
<h4>自定义通知频道</h4>
<p>如果您想要自定义被通知实体在某个通道上接收广播通知，可以在被通知实体上定义一个 <code>receivesBroadcastNotificationsOn</code> 方法：</p>
<pre><code>&lt;?php

namespace App\Models;

use Illuminate\Broadcasting\PrivateChannel;
use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;

class User extends Authenticatable
{
    use Notifiable;

    /**
     * 用户接收广播通知的通道。
     *
     * @return string
     */
    public function receivesBroadcastNotificationsOn()
    {
        return 'users.'.$this-&gt;id;
    }
}</code></pre>
<p><a name="sms-notifications"></a></p>
<h2>短信（SMS）通知</h2>
<p><a name="sms-prerequisites"></a></p>
<h3>先决条件</h3>
<p>Laravel 基于 <a href="https://www.nexmo.com/">Nexmo</a> 发送短信通知，在使用Nexmo 发送通知前，需要安装 <code>laravel/nexmo-notification-channel</code> Composer 扩展包：</p>
<pre><code>composer require laravel/nexmo-notification-channel</code></pre>
<p>这也会安装 <a href="https://github.com/Nexmo/nexmo-laravel"><code>nexmo/laravel</code></a> 扩展包. 该扩展包包括 <a href="https://github.com/Nexmo/nexmo-laravel/blob/master/config/nexmo.php">它自己的配置文件</a>。你可以使用 <code>NEXMO_KEY</code> 和 <code>NEXMO_SECRET</code> 环境变量来设置 Nexmo 公钥和私钥。</p>
<p>接下来，你需要在配置文件 <code>config/services.php</code> 中添加一个配置选项，可以参考以下示例配置：</p>
<pre><code>'nexmo' =&gt; [
    'sms_from' =&gt; '15556666666',
],</code></pre>
<p><code>sms_from</code>  配置项就是用于发送短信消息的手机号码，你需要在 Nexmo 控制面板中为应用生成一个手机号码。</p>
<p><a name="formatting-sms-notifications"></a></p>
<h3>格式化短信通知</h3>
<p>如果通知支持以短信方式发送，那么你需要在通知类上定义一个 <code>toNexmo</code> 方法，该方法接收一个 <code>$notifiable</code> 实体并返回  <code>Illuminate\Notifications\Messages\NexmoMessage</code> 实例：</p>
<pre><code>/**
 * 获取通知的 Nexmo / SMS 表示形式。
 *
 * @param  mixed  $notifiable
 * @return NexmoMessage
 */
public function toNexmo($notifiable)
{
    return (new NexmoMessage)
                -&gt;content('Your SMS message content');
}</code></pre>
<p><a name="formatting-shortcode-notifications"></a></p>
<h3>格式化简码通知</h3>
<p>Laravel 还支持发送简码通知，这是你 Nexmo 帐户中的预定义消息模板。 你可以指定通知的类型（<code>alert</code>, <code>2fa</code>, or <code>marketing</code>）以及将填充模板的自定义值：</p>
<pre><code>/**
 * Get the Nexmo / Shortcode representation of the notification.
 *
 * @param  mixed  $notifiable
 * @return array
 */
public function toShortcode($notifiable)
{
    return [
        'type' =&gt; 'alert',
        'custom' =&gt; [
            'code' =&gt; 'ABC123',
        ];
    ];
}</code></pre>
<blockquote>
<p>{tip} 类似于 <a href="#routing-sms-notifications">短信通知路由</a>, 你应该在可通知模型上实现 <code>routeNotificationForShortcode</code> 方法。</p>
</blockquote>
<h4>Unicode 内容</h4>
<p>如果你的短信消息包含 Unicode 字符，需要在构造 <code>NexmoMessage</code> 实例时调用 <code>unicode</code> 方法：</p>
<pre><code>/**
 * Get the Nexmo / SMS representation of the notification.
 *
 * @param  mixed  $notifiable
 * @return NexmoMessage
 */
public function toNexmo($notifiable)
{
    return (new NexmoMessage)
                -&gt;content('Your unicode message')
                -&gt;unicode();
}</code></pre>
<p><a name="customizing-the-from-number"></a></p>
<h3>自定义发送者 &quot;From&quot; 号码</h3>
<p>如果你要通过与配置文件 <code>config/services.php</code> 中指定的手机号不同的其他号码发送通知，可以使用  <code>NexmoMessage</code> 实例上的 <code>from</code> 方法：</p>
<pre><code>/**
 * Get the Nexmo / SMS representation of the notification.
 *
 * @param  mixed  $notifiable
 * @return NexmoMessage
 */
public function toNexmo($notifiable)
{
    return (new NexmoMessage)
                -&gt;content('Your SMS message content')
                -&gt;from('15554443333');
}</code></pre>
<p><a name="routing-sms-notifications"></a></p>
<h3>短信通知路由</h3>
<p>要将 Nexmo 通知路由到正确的电话号码，请在可通知实体上定义一个<code>routeNotificationForNexmo</code> 方法：</p>
<pre><code>&lt;?php

namespace App;

use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;

class User extends Authenticatable
{
    use Notifiable;

    /**
     * Route notifications for the Nexmo channel.
     *
     * @param  \Illuminate\Notifications\Notification  $notification
     * @return string
     */
    public function routeNotificationForNexmo($notification)
    {
        return $this-&gt;phone_number;
    }
}</code></pre>
<p><a name="slack-notifications"></a></p>
<h2>Slack 通知</h2>
<p><a name="slack-prerequisites"></a></p>
<h3>先决条件</h3>
<p>在通过 Slack 发送通知前，必须通过 Composer 安装 Slack 通知通道：</p>
<pre><code>composer require laravel/slack-notification-channel</code></pre>
<p>你还需要为 Slack 组配置一个 <a href="https://api.slack.com/incoming-webhooks">&quot;Incoming Webhook&quot;</a> 集成。该集成会提供一个URL，可以在 <a href="#routing-slack-notifications">路由 Slack 通知</a>  时使用。</p>
<p><a name="formatting-slack-notifications"></a></p>
<h3>格式化 Slack 通知</h3>
<p>如果通知支持通过 Slack 消息发送，则需要在通知类上定义一个 <code>toSlack</code> 方法，该方法接收一个 <code>$notifiable</code> 实体并返回 <code>Illuminate\Notifications\Messages\SlackMessage</code> 实例，Slack 消息可以包含文本内容以及格式化附加文本或数组字段的“附件”。让我们来看一个基本的 <code>toSlack</code> 使用示例：</p>
<pre><code>/**
 * Get the Slack representation of the notification.
 *
 * @param  mixed  $notifiable
 * @return SlackMessage
 */
public function toSlack($notifiable)
{
    return (new SlackMessage)
                -&gt;content('One of your invoices has been paid!');
}</code></pre>
<p>在此示例中，我们仅向 Slack 发送一行文本，这将创建一条如下所示的消息：</p>
<p><img src="img/basic-slack-notification.png" alt="" /></p>
<h4>自定义发送者和接收者</h4>
<p>你可以使用 <code>from</code> 和 <code>to</code> 方法自定义发送者和接收者， <code>from</code> 方法接收一个用户名和 emoji 标识，而 <code>to</code> 方法接收通道或用户名：</p>
<pre><code>/**
 * Get the Slack representation of the notification.
 *
 * @param  mixed  $notifiable
 * @return SlackMessage
 */
public function toSlack($notifiable)
{
    return (new SlackMessage)
                -&gt;from('Ghost', ':ghost:')
                -&gt;to('#other')
                -&gt;content('This will be sent to #other');
}</code></pre>
<p>还可以使用图片作为 logo 用以取代 emoji：</p>
<pre><code>/**
 * Get the Slack representation of the notification.
 *
 * @param  mixed  $notifiable
 * @return SlackMessage
 */
public function toSlack($notifiable)
{
    return (new SlackMessage)
                -&gt;from('Laravel')
                -&gt;image('https://laravel.com/img/favicon/favicon.ico')
                -&gt;content('This will display the Laravel logo next to the message');
}</code></pre>
<p><a name="slack-attachments"></a></p>
<h3>Slack 附件</h3>
<p>你还可以添加“附件”到 Slack 消息。相对简单文本消息，附件可以提供更加丰富的格式选项。在这个例子中，我们会发送一个在应用程序中出现的异常错误通知，包含查看更多异常细节的链接：</p>
<pre><code>/**
 * Get the Slack representation of the notification.
 *
 * @param  mixed  $notifiable
 * @return SlackMessage
 */
public function toSlack($notifiable)
{
    $url = url('/exceptions/'.$this-&gt;exception-&gt;id);

    return (new SlackMessage)
                -&gt;error()
                -&gt;content('Whoops! Something went wrong.')
                -&gt;attachment(function ($attachment) use ($url) {
                    $attachment-&gt;title('Exception: File Not Found', $url)
                               -&gt;content('File [background.jpg] was not found.');
                });
}</code></pre>
<p>上面的示例会生成一个如下所示的 Slack 消息:</p>
<p><img src="img/basic-slack-attachment.png" alt="" /></p>
<p>附件还允许你指定要呈献给用户的数组数据。为了提高可读性，给定的数组会以表格形式展示：</p>
<pre><code>/**
 * 获取 Slack 形式的通知。
 *
 * @param  mixed  $notifiable
 * @return SlackMessage
 */
public function toSlack($notifiable)
{
    $url = url('/invoices/'.$this-&gt;invoice-&gt;id);

    return (new SlackMessage)
                -&gt;success()
                -&gt;content('One of your invoices has been paid!')
                -&gt;attachment(function ($attachment) use ($url) {
                    $attachment-&gt;title('Invoice 1322', $url)
                               -&gt;fields([
                                    'Title' =&gt; 'Server Expenses',
                                    'Amount' =&gt; '$1,234',
                                    'Via' =&gt; 'American Express',
                                    'Was Overdue' =&gt; ':-1:',
                                ]);
                });
}</code></pre>
<p>上面的示例会生成一个如下所示的 Slack 消息：</p>
<p><img src="img/slack-fields-attachment.png" alt="" /></p>
<h4>Markdown 附件内容</h4>
<p>如果一些附件字段包含 Markdown，可以使用 <code>markdown</code> 方法来构建 Slack 用以解析并显示以 Markdown 格式编写的附件字段，此方法接受的值有： <code>pretext</code>、 <code>text</code> 或 <code>fields</code>。想要了解更多关于 Slack 格式化的信息，查看 <a href="https://api.slack.com/docs/message-formatting#message_formatting">Slack API 文档</a>：</p>
<pre><code>/**
 * 获取 Slack 形式的通知。
 *
 * @param  mixed  $notifiable
 * @return SlackMessage
 */
public function toSlack($notifiable)
{
    $url = url('/exceptions/'.$this-&gt;exception-&gt;id);

    return (new SlackMessage)
                -&gt;error()
                -&gt;content('Whoops! Something went wrong.')
                -&gt;attachment(function ($attachment) use ($url) {
                    $attachment-&gt;title('Exception: File Not Found', $url)
                               -&gt;content('File [background.jpg] was *not found*.')
                               -&gt;markdown(['text']);
                });
}</code></pre>
<p><a name="routing-slack-notifications"></a></p>
<h3>Slack 通知路由</h3>
<p>要路由 Slack 通知到适当的位置，需要在可通知的实体上定义一个 <code>routeNotificationForSlack</code> 方法，这将会返回通知被发送到的 Webhook URL。Webhook URL 可通过在 Slack 组上添加一个 &quot;Incoming Webhook&quot; 服务来生成：</p>
<pre><code>&lt;?php

namespace App;

use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;

class User extends Authenticatable
{
    use Notifiable;

    /**
     * Route notifications for the Slack channel.
     *
     * @param  \Illuminate\Notifications\Notification  $notification
     * @return string
     */
    public function routeNotificationForSlack($notification)
    {
        return 'https://hooks.slack.com/services/...';
    }
}</code></pre>
<p><a name="localizing-notifications"></a></p>
<h2>本地化通知</h2>
<p>Laravel 允许您以当前语言环境之外的其他语言发送通知，并且会在通知队列时记住该语言环境。</p>
<p>要实现这一点， <code>Illuminate\Notifications\Notification</code> 类提供了一个 <code>locale</code> 方法来设置所需的语言。在格式化通知时，应用程序将更改为此语言设置，然后在格式化完成后还原为以前的语言设置：</p>
<pre><code>$user-&gt;notify((new InvoicePaid($invoice))-&gt;locale('es'));</code></pre>
<p>多个可通知实体的本地化也可通过 <code>Notification</code>  Facade 实现：</p>
<pre><code>Notification::locale('es')-&gt;send($users, new InvoicePaid($invoice));</code></pre>
<h3>用户首选语言区域设置</h3>
<p>有些情况下，应用程序存储每个用户的首选语言区域设置。通过在可通知模型上实现 <code>HasLocalePreference</code> 契约，可以指示 Laravel 在发送通知时使用用户保存的首选语言设置：</p>
<pre><code>use Illuminate\Contracts\Translation\HasLocalePreference;

class User extends Model implements HasLocalePreference
{
    /**
     * 获取用户的首选语言区域设置
     *
     * @return string
     */
    public function preferredLocale()
    {
        return $this-&gt;locale;
    }
}</code></pre>
<p>实现接口后，Laravel 将在向模型发送通知和邮件时自动使用首选区域设置。因此，使用此接口时不需要调用 <code>locale</code> 方法：</p>
<pre><code>$user-&gt;notify(new InvoicePaid($invoice));</code></pre>
<p><a name="notification-events"></a></p>
<h2>通知事件</h2>
<p>当通知被发送后，通知系统会触发 <code>Illuminate\Notifications\Events\NotificationSent</code> 事件，该事件实例包含被通知的实体（如用户）和通知实例本身。你可以在 <code>EventServiceProvider</code> 中为该事件注册监听器：</p>
<pre><code>/**
 * 应用程序的事件监听器映射。
 *
 * @var array
 */
protected $listen = [
    'Illuminate\Notifications\Events\NotificationSent' =&gt; [
        'App\Listeners\LogNotification',
    ],
];</code></pre>
<blockquote>
<p>{提示}  在 <code>EventServiceProvider</code> 中注册监听器之后，使用 Artisan 命令 <code>event:generate</code> 可以快速生成监听器类。</p>
</blockquote>
<p>在事件监听器中，可以访问事件的 <code>notifiable</code>、  <code>notification</code> 和  <code>channel</code> 属性以了解通知接收者和通知本身的更多信息：</p>
<pre><code>/**
 * 处理事件。
 *
 * @param  NotificationSent  $event
 * @return void
 */
public function handle(NotificationSent $event)
{
    // $event-&gt;channel
    // $event-&gt;notifiable
    // $event-&gt;notification
    // $event-&gt;response
}</code></pre>
<p><a name="custom-channels"></a></p>
<h2>自定义通道</h2>
<p>Laravel 为我们提供了许多通知频道，但是您亦可编写自己驱动以通过其他频道来发送通知，这并不难。首先，请定义一个包含了 <code>send</code> 方法的类。该方法应该接收两个参数： <code>$notifiable</code> 和 <code>$notification</code>：</p>
<pre><code>&lt;?php

namespace App\Channels;

use Illuminate\Notifications\Notification;

class VoiceChannel
{
    /**
     * 发送指定的通知。
     *
     * @param  mixed  $notifiable
     * @param  \Illuminate\Notifications\Notification  $notification
     * @return void
     */
    public function send($notifiable, Notification $notification)
    {
        $message = $notification-&gt;toVoice($notifiable);

        // 发送通知到 $notifiable 实例中……
    }
}</code></pre>
<p>一旦您的通知频道定义完成后，您便可以在应用中通过 <code>via</code> 方法来返回类名：</p>
<pre><code>&lt;?php

namespace App\Notifications;

use App\Channels\Messages\VoiceMessage;
use App\Channels\VoiceChannel;
use Illuminate\Bus\Queueable;
use Illuminate\Contracts\Queue\ShouldQueue;
use Illuminate\Notifications\Notification;

class InvoicePaid extends Notification
{
    use Queueable;

    /**
     * 获取通知频道。
     *
     * @param  mixed  $notifiable
     * @return array|string
     */
    public function via($notifiable)
    {
        return [VoiceChannel::class];
    }

    /**
     * 获取语音形式的通知。
     *
     * @param  mixed  $notifiable
     * @return VoiceMessage
     */
    public function toVoice($notifiable)
    {
        // ...
    }
}</code></pre>
            </div>
        </div>
    </div>
    <div class="col-md-3 col-xl-2" id="toc-list">
        <ul></ul>
    </div>
</div>    </div>
</div>
<span id="back-top">
<svg width="20" height="20" fill="currentColor">
    <use xlink:href="/css/bootstrap-icons.svg#chevron-up"/>
</svg>
</span>
 
<script>
    // 浏览量统计
    $(function () {
        let formdata = new FormData();
        formdata.append('_token', '');
        formdata.append('id', 352);
        $.ajax({
            url: $(".sticky-top .navbar-brand").attr('href') + "/api/doc/clicks",
            type: 'POST',
            data: formdata,
            processData: false,
            contentType: false
        });
    });
    // aside-hidden
    $(function () {
        $('#aside-hidden').on('click', function () {
            $('.aside').toggle(0, function () {
                if ($(this).is(':visible')) {
                    $('.aside-middle').removeClass('col-md-12 col-lg-12').addClass('col-md-9 col-lg-10');
                } else {
                    $('.aside-middle').removeClass('col-md-9 col-lg-10').addClass('col-md-12 col-lg-12');
                }
            });
        });
    });
</script>
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?1522d01c436f59ddc8389f25bfa9d53e";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
</body>
</html>